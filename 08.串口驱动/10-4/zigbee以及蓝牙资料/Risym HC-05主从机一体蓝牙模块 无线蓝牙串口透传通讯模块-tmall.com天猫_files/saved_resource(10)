KISSY.add("malldetail/other/a11y",function(e,t,a,i,n){var o=e.all;var r=i.instance();var l=function(){};l.prototype={constructor:l,init:function(){a.attr("#J_DetailMeta","role","form");a.attr("#mainwrap","role","main");a.attr("#footer,#page-footer","role","contentinfo");a.attr("#J_DcShopArchive","role","complementary")}};var s=function(){};s.prototype={constructor:s,init:function(){var e=a.query("#J_UlThumb img");a.attr(e,"alt","\u5546\u54c1\u9884\u89c8\u56fe")}};var c=function(){};c.prototype={constructor:c,init:function(){var e=a.query("textarea.ks-datalazyload");a.attr(e,"tabindex","-1")}};var d=function(){};d.prototype={constructor:d,select:function(e,t){if(t){var i=a.text(e)||null;if(i){a.attr(e,"aria-label",i+"\uff0c\u5df2\u9009\u62e9")}}else{a.removeAttr(e,"aria-label")}},init:function(){var t=this;var i=a.query(".tb-sku","#detail");var n=a.query("ul.J_TSaleProp li,ul.tm-relate-list li,ul.serviceList li,ul li.j_CateTab,ul.j_Area li,ul li[data-planid]",i);var o=a.query("a,span[title]",n);a.attr(o,"role","button");a.attr(o,"tabindex","0");r.onChange(["selectedSkuProp","skuPropSelectivity","thirdPartyInventory"],function(i){e.each(o,function(e){var n=a.parent(e,function(e){return true}),o=n?n.getAttribute("data-value")?n.getAttribute("data-value"):"":"",l=o.split(":");if(!l[1]){if(a.hasClass(n,"tm-relate-current")||a.hasClass(n,"tb-selected")){t.select(e,true)}else{t.select(e,false)}}else{if(i[l[0]]==l[1]){t.select(e,true)}else{t.select(e,false)}r.canSelectSkuProp(o,"",function(t){if(t<=0){a.attr(e,"aria-disabled",true)}else{a.removeAttr(e,"aria-disabled")}})}if(a.hasClass(e,"wt-area-name")){a.attr(e,"aria-haspopup",true)}})})}};var m=function(){};m.prototype={init:function(){var t=a.query(".tb-sku","#detail");var i=a.query("ul.serviceList",t);var n=a.query("li",i);var o=a.query("a",n);var l=function(t){e.each(o,function(e){var i=a.parent(e,function(e){return!!e.getAttribute("data-value")}),n=i?i.getAttribute("data-value"):"";if(t&&t[n]&&t[n].checked||a.hasClass(i,"tb-selected")){var o=a.text(e)||null;if(o){a.attr(e,"aria-label",o+"\uff0c\u5df2\u9009\u62e9")}}else{a.removeAttr(e,"aria-label")}})};l();r.onChange(["cacheSelectedService","currentService"],function(e){if(!e)return;l(e)})}};var u=function(){};u.prototype={constructor:u,init:function(){o(".tb-action a").attr("role","button")}};var p=function(t){var a=0,i={objs:[]};this.config=e.mix(i,t);this.keyCount=function(){a++;return a}};p.prototype={init:function(){this.initEvent();this.load(this.config)},load:function(e){if(e&&e.objs){var t=e.objs;for(var a=0;a<t.length;a++){try{t[a].init()}catch(i){}}}},initEvent:function(){var e=this;t.delegate(document,"keydown","[role=button],[role=tab]",function(e){if(e.keyCode==32||e.keyCode==13){e.preventDefault();e.target.click()}})}};var f=new d,v=new u,h=new m,g=new c,b=new s,_=new l;return new p({objs:[f,v,h,g,b,_]})},{requires:["event","dom","detail-model/product","ua"]});