/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 9 22:41
*/
KISSY.add("io/form-serializer",["dom"],function(d,f){function i(a){return a.replace(h,"\r\n")}var k=f("dom"),g=/^(?:select|textarea)/i,h=/\r?\n/g,a,c=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i;return a={serialize:function(c,e){return d.param(a.getFormData(c),void 0,void 0,e||!1)},getFormData:function(a){var e=[],n={};d.each(k.query(a),function(m){m=m.elements?d.makeArray(m.elements):[m];e.push.apply(e,m)});e=d.filter(e,function(m){return m.name&&
!m.disabled&&(m.checked||g.test(m.nodeName)||c.test(m.type))});d.each(e,function(m){var a=k.val(m),b;null!==a&&(a=d.isArray(a)?d.map(a,i):i(a),(b=n[m.name])?(b&&!d.isArray(b)&&(b=n[m.name]=[b]),b.push.apply(b,d.makeArray(a))):n[m.name]=a)});return n}}});
KISSY.add("io/base",["event/custom","promise"],function(d,f){function i(b){var a=b.context;delete b.context;b=d.mix(d.clone(j),b,{deep:!0});b.context=a||b;var m,l=b.type,h=b.dataType,a=b.uri=n.resolve(b.url);b.uri.setQuery("");"crossDomain"in b||(b.crossDomain=!b.uri.isSameOriginAs(n));l=b.type=l.toUpperCase();b.hasContent=!e.test(l);if(b.processData&&(m=b.data)&&"string"!==typeof m)b.data=d.param(m,void 0,void 0,b.serializeArray);h=b.dataType=d.trim(h||"*").split(c);!("cache"in b)&&d.inArray(h[0],
["script","jsonp"])&&(b.cache=!1);b.hasContent||(b.data&&a.query.add(d.unparam(b.data)),!1===b.cache&&a.query.set("_ksTS",d.now()+"_"+d.guid()));return b}function k(b){var a=this;if(!(a instanceof k))return new k(b);h.call(a);b=i(b);d.mix(a,{responseData:null,config:b||{},timeoutTimer:null,responseText:null,responseXML:null,responseHeadersString:"",responseHeaders:null,requestHeaders:{},readyState:0,state:0,statusText:null,status:0,transport:null});h.Defer(a);var c;k.fire("start",{ajaxConfig:b,io:a});
c=new (m[b.dataType[0]]||m["*"])(a);a.transport=c;b.contentType&&a.setRequestHeader("Content-Type",b.contentType);var j=b.dataType[0],e,l=b.timeout,n=b.context,g=b.headers,f=b.accepts;a.setRequestHeader("Accept",j&&f[j]?f[j]+("*"===j?"":", */*; q=0.01"):f["*"]);for(e in g)a.setRequestHeader(e,g[e]);if(b.beforeSend&&!1===b.beforeSend.call(n,a,b))return a;a.readyState=1;k.fire("send",{ajaxConfig:b,io:a});b.async&&0<l&&(a.timeoutTimer=setTimeout(function(){a.abort("timeout")},1E3*l));try{a.state=1,c.send()}catch(p){2>
a.state?(p.stack||p,"error",setTimeout(function(){throw p;},0),a._ioReady(-1,p.message)):p}return a}var g=f("event/custom"),h=f("promise"),a=/^(?:about|app|app\-storage|.+\-extension|file|widget)$/,c=/\s+/,l=function(b){return b},e=/^(?:GET|HEAD)$/,n=new d.Uri((d.Env.host.location||{}).href),a=n&&a.test(n.getScheme()),m={},j={type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",async:!0,serializeArray:!0,processData:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",
text:"text/plain",json:"application/json, text/javascript","*":"*/*"},converters:{text:{json:d.parseJson,html:l,text:l,xml:d.parseXML}},headers:{"X-Requested-With":"XMLHttpRequest"},contents:{xml:/xml/,html:/html/,json:/json/}};j.converters.html=j.converters.text;d.mix(k,g.Target);d.mix(k,{isLocal:a,setupConfig:function(b){d.mix(j,b,{deep:!0})},setupTransport:function(b,a){m[b]=a},getTransport:function(b){return m[b]},getConfig:function(){return j}});return k});
KISSY.add("io/xhr-transport-base",["./base"],function(d,f){function i(a,j){try{return new (j||h).XMLHttpRequest}catch(b){}}function k(a){var j;a.ifModified&&(j=a.uri,!1===a.cache&&(j=j.clone(),j.query.remove("_ksTS")),j=j.toString());return j}var g=f("./base"),h=d.Env.host,a=7<d.UA.ieMode&&h.XDomainRequest,c={proto:{}},l={},e={};g.__lastModifiedCached=l;g.__eTagCached=e;c.nativeXhr=h.ActiveXObject?function(m,j){var b;if(!n&&m&&a)b=new a;else if(!(b=!g.isLocal&&i(m,j)))a:{try{b=new (j||h).ActiveXObject("Microsoft.XMLHTTP");
break a}catch(c){}b=void 0}return b}:i;c.XDomainRequest_=a;var n=c.supportCORS="withCredentials"in c.nativeXhr();d.mix(c.proto,{sendInternal:function(){var m=this,c=m.io,b=c.config,o=m.nativeXhr,h=b.files,g=h?"post":b.type,f=b.async,i,t=c.mimeType,q=c.requestHeaders||{},c=c._getUrlForSend(),u=k(b),p,v;if(u){if(p=l[u])q["If-Modified-Since"]=p;if(p=e[u])q["If-None-Match"]=p}(i=b.username)?o.open(g,c,f,i,b.password):o.open(g,c,f);g=b.xhrFields||{};"withCredentials"in g&&(n||delete g.withCredentials);
for(v in g)try{o[v]=g[v]}catch(x){x}t&&o.overrideMimeType&&o.overrideMimeType(t);!1===q["X-Requested-With"]&&delete q["X-Requested-With"];if("undefined"!==typeof o.setRequestHeader)for(v in q)o.setRequestHeader(v,q[v]);var w=b.hasContent&&b.data||null;h&&(t=w,q={},t&&(q=d.unparam(t)),q=d.mix(q,h),w=new FormData,d.each(q,function(a,m){d.isArray(a)?d.each(a,function(a){w.append(m+(b.serializeArray?"[]":""),a)}):w.append(m,a)}));o.send(w);!f||4===o.readyState?m._callback():a&&o instanceof a?(o.onload=
function(){o.readyState=4;o.status=200;m._callback()},o.onerror=function(){o.readyState=4;o.status=500;m._callback()}):o.onreadystatechange=function(){m._callback()}},abort:function(){this._callback(0,1)},_callback:function(m,c){var b=this.nativeXhr,o=this.io,h,n,f,i,t,q=o.config;try{if(c||4===b.readyState)if(a&&b instanceof a?(b.onerror=d.noop,b.onload=d.noop):b.onreadystatechange=d.noop,c)4!==b.readyState&&b.abort();else{h=k(q);var u=b.status;a&&b instanceof a||(o.responseHeadersString=b.getAllResponseHeaders());
h&&(n=b.getResponseHeader("Last-Modified"),f=b.getResponseHeader("ETag"),n&&(l[h]=n),f&&(e[f]=f));if((t=b.responseXML)&&t.documentElement)o.responseXML=t;var p=o.responseText=b.responseText;if(q.files&&p){var v,x;if(-1!==(v=p.indexOf("<body>")))x=p.lastIndexOf("</body>"),-1===x&&(x=p.length),p=p.slice(v+6,x);o.responseText=d.unEscapeHtml(p)}try{i=b.statusText}catch(w){"xhr statusText error: ",w,i=""}!u&&g.isLocal&&!q.crossDomain?u=o.responseText?200:404:1223===u&&(u=204);o._ioReady(u,i)}}catch(y){y.stack||
y,"error",setTimeout(function(){throw y;},0),b.onreadystatechange=d.noop,c||o._ioReady(-1,y)}}});return c});
KISSY.add("io/xdr-flash-transport",["./base","dom"],function(d,f){function i(a,d,b){n||(n=!0,a='<object id="'+c+'" type="application/x-shockwave-flash" data="'+a+'" width="0" height="0"><param name="movie" value="'+a+'" /><param name="FlashVars" value="yid='+d+"&uid="+b+'&host=KISSY.IO" /><param name="allowScriptAccess" value="always" /></object>',d=e.createElement("div"),h.prepend(d,e.body||e.documentElement),d.innerHTML=a)}function k(a){"use XdrFlashTransport for: "+a.config.url;this.io=a}var g=
f("./base"),h=f("dom"),a={},c="io_swf",l,e=d.Env.host.document,n=!1;d.augment(k,{send:function(){var c=this,e=c.io,b=e.config;i((b.xdr||{}).src||d.Config.base+"io/assets/io.swf",1,1);l?(c._uid=d.guid(),a[c._uid]=c,l.send(e._getUrlForSend(),{id:c._uid,uid:c._uid,method:b.type,data:b.hasContent&&b.data||{}})):setTimeout(function(){c.send()},200)},abort:function(){l.abort(this._uid)},_xdrResponse:function(c,d){var b,e=d.id,l,h=d.c,g=this.io;if(h&&(l=h.responseText))g.responseText=decodeURI(l);switch(c){case "success":b=
{status:200,statusText:"success"};delete a[e];break;case "abort":delete a[e];break;case "timeout":case "transport error":case "failure":delete a[e],b={status:"status"in h?h.status:500,statusText:h.statusText||c}}b&&g._ioReady(b.status,b.statusText)}});g.applyTo=function(a,c,b){var a=c.split(".").slice(1),e=g;d.each(a,function(a){e=e[a]});e.apply(null,b)};g.xdrReady=function(){l=e.getElementById(c)};g.xdrResponse=function(c,e){var b=a[e.uid];b&&b._xdrResponse(c,e)};return k});
KISSY.add("io/sub-domain-transport",["event/dom","dom","./xhr-transport-base"],function(d,f){function i(a){var c=a.config;this.io=a;c.crossDomain=!1;"use SubDomainTransport for: "+c.url}function k(){var a=this.io.config.uri.getHostname(),a=l[a];a.ready=1;g.detach(a.iframe,"load",k,this);this.send()}var g=f("event/dom"),h=f("dom"),a=f("./xhr-transport-base"),c=d.Env.host.document,l={};d.augment(i,a.proto,{send:function(){var e=this.io.config,n=e.uri,m=n.getHostname(),j;j=l[m];var b="/sub_domain_proxy.html";
e.xdr&&e.xdr.subDomain&&e.xdr.subDomain.proxy&&(b=e.xdr.subDomain.proxy);j&&j.ready?(this.nativeXhr=a.nativeXhr(0,j.iframe.contentWindow))?this.sendInternal():"document.domain not set correctly!":(j?e=j.iframe:(j=l[m]={},e=j.iframe=c.createElement("iframe"),h.css(e,{position:"absolute",left:"-9999px",top:"-9999px"}),h.prepend(e,c.body||c.documentElement),j=new d.Uri,j.setScheme(n.getScheme()),j.setPort(n.getPort()),j.setHostname(m),j.setPath(b),e.src=j.toString()),g.on(e,"load",k,this))}});return i});
KISSY.add("io/xhr-transport",["./base","./xhr-transport-base","./xdr-flash-transport","./sub-domain-transport"],function(d,f){function i(e){var n=e.config,m=n.crossDomain,j=n.xdr||{},b=j.subDomain=j.subDomain||{};this.io=e;if(m&&!g.supportCORS){var o=n.uri.getHostname();if(c.domain&&d.endsWith(o,c.domain)&&!1!==b.proxy)return new a(e);if("flash"===""+j.use||!l)return new h(e)}e=this.nativeXhr=g.nativeXhr(m);"crossDomain: "+m+", use "+(l&&e instanceof l?"XDomainRequest":"XhrTransport")+" for: "+n.url;
return this}var k=f("./base"),g=f("./xhr-transport-base"),h=f("./xdr-flash-transport"),a=f("./sub-domain-transport"),c=d.Env.host.document,l=g.XDomainRequest_;d.augment(i,g.proto,{send:function(){this.sendInternal()}});k.setupTransport("*",i);return k});
KISSY.add("io/script-transport",["./base"],function(d,f){function i(d){var h=d.config;if(!h.crossDomain)return new (k.getTransport("*"))(d);this.io=d;"use ScriptTransport for: "+h.url;return this}var k=f("./base");k.setupConfig({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{text:{script:function(g){d.globalEval(g);return g}}}});d.augment(i,{send:function(){var g=this,h=g.io,a=h.config;
g.script=d.getScript(h._getUrlForSend(),{charset:a.scriptCharset,success:function(){g._callback("success")},error:function(){g._callback("error")}})},_callback:function(d,h){var a=this.io;this.script&&(this.script=void 0,h||("error"!==d?a._ioReady(200,"success"):"error"===d&&a._ioReady(500,"script error")))},abort:function(){this._callback(0,1)}});k.setupTransport("script",i);return k});
KISSY.add("io/jsonp",["./base"],function(d,f){var i=f("./base"),k=d.Env.host;i.setupConfig({jsonp:"callback",jsonpCallback:function(){return d.guid("jsonp")}});i.on("start",function(g){var h=g.io,a=h.config,g=a.dataType;if("jsonp"===g[0]){delete a.contentType;var c,l=a.jsonpCallback,e="function"===typeof l?l():l,n=k[e];a.uri.query.set(a.jsonp,e);k[e]=function(a){1<arguments.length&&(a=d.makeArray(arguments));c=[a]};h.fin(function(){k[e]=n;if(void 0===n)try{delete k[e]}catch(a){}else c&&n(c[0])});
h=a.converters;h.script=h.script||{};h.script.json=function(){c||" not call jsonpCallback: "+e;return c[0]};g.length=2;g[0]="script";g[1]="json"}});return i});
KISSY.add("io/form",["./base","dom","./form-serializer"],function(d,f){var i=f("./base"),k=f("dom"),g=f("./form-serializer"),h=Array.prototype.slice,a=d.Env.host.FormData;i.on("start",function(c){var l,e,c=c.io.config;if(e=c.form){l=k.get(e);e=c.data;for(var n=!1,m={},j=k.query("input",l),b=0,o=j.length;b<o;b++){var f=j[b];if("file"===f.type.toLowerCase()){n=!0;if(!a)break;var i=h.call(f.files,0);m[k.attr(f,"name")]=1<i.length?i:i[0]||null}}n&&a&&(c.files=c.files||{},d.mix(c.files,m),delete c.contentType);
!n||a?(l=g.getFormData(l),c.hasContent?(l=d.param(l,void 0,void 0,c.serializeArray),c.data=e?c.data+("&"+l):l):c.uri.query.add(l)):(e=c.dataType,c=e[0],"*"===c&&(c="text"),e.length=2,e[0]="iframe",e[1]=c)}});return i});
KISSY.add("io/iframe-transport",["dom","./base","event/dom"],function(d,f){function i(a){var c=d.guid("io-iframe"),e=h.getEmptyIframeSrc(),a=a.iframe=h.create("<iframe "+(e?' src="'+e+'" ':"")+' id="'+c+'" name="'+c+'" style="position:absolute;left:-9999px;top:-9999px;"/>');h.prepend(a,l.body||l.documentElement);return a}function k(a,c,e){var b=[],g,f,i,k;d.each(a,function(a,n){g=d.isArray(a);f=d.makeArray(a);for(i=0;i<f.length;i++)k=l.createElement("input"),k.type="hidden",k.name=n+(g&&e?"[]":""),
k.value=f[i],h.append(k,c),b.push(k)});return b}function g(a){this.io=a;"use IframeTransport for: "+a.config.url}var h=f("dom"),a=f("./base"),c=f("event/dom"),l=d.Env.host.document,e=d.clone(a.getConfig().converters.text);e.json=function(a){return d.parseJson(d.unEscapeHtml(a))};a.setupConfig({converters:{iframe:e,text:{iframe:function(a){return a}},xml:{iframe:function(a){return a}}}});d.augment(g,{send:function(){function a(){c.on(f,"load error",e._callback,e);s.submit()}var e=this,l=e.io,b=l.config,
g,f,r,A=b.data,s=h.get(b.form);e.attrs={target:h.attr(s,"target")||"",action:h.attr(s,"action")||"",encoding:h.attr(s,"encoding"),enctype:h.attr(s,"enctype"),method:h.attr(s,"method")};e.form=s;f=i(l);h.attr(s,{target:f.id,action:l._getUrlForSend(),method:"post",enctype:"multipart/form-data",encoding:"multipart/form-data"});A&&(r=d.unparam(A));r&&(g=k(r,s,b.serializeArray));e.fields=g;6===d.UA.ie?setTimeout(a,0):a()},_callback:function(a){var e=this,l=e.form,b=e.io,a=a.type,g,f=b.iframe;if(f)if("abort"===
a&&6===d.UA.ie?setTimeout(function(){h.attr(l,e.attrs)},0):h.attr(l,e.attrs),h.remove(this.fields),c.detach(f),setTimeout(function(){h.remove(f)},30),b.iframe=null,"load"===a)try{if((g=f.contentWindow.document)&&g.body)b.responseText=h.html(g.body),d.startsWith(b.responseText,"<?xml")&&(b.responseText=void 0);b.responseXML=g&&g.XMLDocument?g.XMLDocument:g;g?b._ioReady(200,"success"):b._ioReady(500,"parser error")}catch(i){b._ioReady(500,"parser error")}else"error"===a&&b._ioReady(500,"error")},abort:function(){this._callback({type:"abort"})}});
a.setupTransport("iframe",g);return a});
KISSY.add("io/methods",["promise","./base"],function(d,f){function i(a){var c=a.responseText,g=a.responseXML,e=a.config,h=e.converters,f,j,b=e.contents,i=e.dataType;if(c||g){for(e=a.mimeType||a.getResponseHeader("Content-Type");"*"===i[0];)i.shift();if(!i.length)for(f in b)if(b[f].test(e)){i[0]!==f&&i.unshift(f);break}i[0]=i[0]||"text";for(f=0;f<i.length;f++)if("text"===i[f]&&void 0!==c){j=c;break}else if("xml"===i[f]&&void 0!==g){j=g;break}if(!j){var k={text:c,xml:g};d.each(["text","xml"],function(a){var b=
i[0];if(h[a]&&h[a][b]&&k[a])return i.unshift(a),j="text"===a?c:g,!1})}}b=i[0];for(e=1;e<i.length;e++){f=i[e];var r=h[b]&&h[b][f];if(!r)throw"no covert for "+b+" => "+f;j=r(j);b=f}a.responseData=j}var k=f("promise"),g=f("./base"),h=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg;d.extend(g,k,{setRequestHeader:function(a,c){this.requestHeaders[a]=c;return this},getAllResponseHeaders:function(){return 2===this.state?this.responseHeadersString:null},getResponseHeader:function(a){var c,d,a=a.toLowerCase();if(2===this.state){if(!(d=
this.responseHeaders))for(d=this.responseHeaders={};c=h.exec(this.responseHeadersString);)d[c[1].toLowerCase()]=c[2];c=d[a]}return void 0===c?null:c},overrideMimeType:function(a){this.state||(this.mimeType=a);return this},abort:function(a){a=a||"abort";this.transport&&this.transport.abort(a);this._ioReady(0,a);return this},getNativeXhr:function(){var a=this.transport;return a?a.nativeXhr:null},_ioReady:function(a,c){if(2!==this.state){this.state=2;this.readyState=4;var d;if(200<=a&&300>a||304===a)if(304===
a)c="not modified",d=!0;else try{i(this),c="success",d=!0}catch(e){e.stack||e,"error",setTimeout(function(){throw e;},0),c="parser error"}else 0>a&&(a=0);this.status=a;this.statusText=c;var f=this.defer,h=this.config,j;if(j=this.timeoutTimer)clearTimeout(j),this.timeoutTimer=0;j=d?"success":"error";var b,k=[this.responseData,c,this],z=h.context,r={ajaxConfig:h,io:this};(b=h[j])&&b.apply(z,k);(b=h.complete)&&b.apply(z,k);g.fire(j,r);g.fire("complete",r);f[d?"resolve":"reject"](k)}},_getUrlForSend:function(){var a=
this.config,c=a.uri,h=d.Uri.getComponents(a.url).query||"";return c.toString.call(c,a.serializeArray)+(h?(c.query.has()?"&":"?")+h:h)}})});
KISSY.add("io","io/form-serializer,io/base,io/xhr-transport,io/script-transport,io/jsonp,io/form,io/iframe-transport,io/methods".split(","),function(d,f){function i(d,a,c,f,e){if(typeof a==="function"){f=c;c=a;a=void 0}return g({type:e||"get",url:d,data:a,success:c,dataType:f})}var k=f("io/form-serializer"),g=f("io/base");f("io/xhr-transport");f("io/script-transport");f("io/jsonp");f("io/form");f("io/iframe-transport");f("io/methods");d.mix(g,{serialize:k.serialize,get:i,post:function(d,a,c,f){if(typeof a===
"function"){f=c;c=a;a=void 0}return i(d,a,c,f,"post")},jsonp:function(d,a,c){if(typeof a==="function"){c=a;a=void 0}return i(d,a,c,"jsonp")},getScript:d.getScript,getJSON:function(d,a,c){if(typeof a==="function"){c=a;a=void 0}return i(d,a,c,"json")},upload:function(d,a,c,f,e){if(typeof c==="function"){e=f;f=c;c=void 0}return g({url:d,type:"post",dataType:e,form:a,data:c,success:f})}});d.mix(d,{Ajax:g,IO:g,ajax:g,io:g,jsonp:g.jsonp});return g});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:17
*/
KISSY.add("promise",[],function(k){function t(a){"undefined"!==typeof console&&console.error&&console.error(a)}function o(a,b,d){if(a instanceof g)p(function(){d.call(a,a[e])});else{var l=a[e],c=a[i];c?c.push([b,d]):m(l)?o(l,b,d):b&&p(function(){b.call(a,l)})}}function f(a){if(!(this instanceof f))return new f(a);this.promise=a||new c;this.promise.defer=this}function m(a){return a&&a instanceof c}function c(a){this[e]=a;void 0===a&&(this[i]=[],this[n]=[])}function g(a){if(a instanceof g)return a;
c.apply(this,arguments);this[e]instanceof c&&"assert.not(this.__promise_value instanceof promise) in Reject constructor";return this}function j(a,b,d){function l(a){try{return b?b.call(this,a):a}catch(d){return t(d.stack||d),new g(d)}}function e(a){try{return d?d.call(this,a):new g(a)}catch(b){return t(b.stack||b),new g(b)}}function u(a){h?"already done at fulfilled":a instanceof c?"assert.not(value instanceof Promise) in when":(h=1,q.resolve(l.call(this,a)))}var q=new f,h=0;a instanceof c?o(a,u,
function(a){h?"already done at rejected":(h=1,q.resolve(e.call(this,a)))}):u(a);return q.promise}function r(a){return!s(a)&&m(a)&&void 0===a[i]&&(!m(a[e])||r(a[e]))}function s(a){return m(a)&&void 0===a[i]&&a[e]instanceof g}var e="__promise_value",p=k.setImmediate,n="__promise_progress_listeners",i="__promise_pendings";f.prototype={constructor:f,resolve:function(a){var b=this.promise,d;if(!(d=b[i]))return null;b[e]=a;d=[].concat(d);b[i]=void 0;b[n]=void 0;k.each(d,function(a){o(b,a[0],a[1])});return a},
reject:function(a){return this.resolve(new g(a))},notify:function(a){k.each(this.promise[n],function(b){p(function(){b(a)})})}};c.prototype={constructor:c,then:function(a,b,d){d&&this.progress(d);return j(this,a,b)},progress:function(a){this[n]&&this[n].push(a);return this},fail:function(a){return j(this,0,a)},fin:function(a){return j(this,function(b){return a(b,!0)},function(b){return a(b,!1)})},done:function(a,b){(a||b?this.then(a,b):this).fail(function(a){a.stack||a;"error";setTimeout(function(){throw a;
},0)})},isResolved:function(){return r(this)},isRejected:function(){return s(this)}};k.extend(g,c);KISSY.Defer=f;KISSY.Promise=c;c.Defer=f;k.mix(c,{when:j,isPromise:m,isResolved:r,isRejected:s,all:function(a){var b=a.length;if(!b)return null;for(var d=new f,c=0;c<a.length;c++)(function(c,e){j(c,function(c){a[e]=c;0===--b&&d.resolve(a)},function(a){d.reject(a)})})(a[c],c);return d.promise},async:function(a){return function(){function b(a,b){var h;try{h=f[a](b)}catch(i){return new g(i)}return h.done?
h.value:j(h.value,c,e)}function c(a){return b("next",a)}function e(a){return b("throw",a)}var f=a.apply(this,arguments);return c()}}});return c});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 6 15:30
*/
KISSY.add("base",["attribute"],function(e,q){function h(b,a){return function(d){return function(){a?d.apply(this,arguments):this.callSuper.apply(this,arguments);var c=arguments.callee.__owner__.__extensions__||[];a&&c.reverse();var f=arguments,e;if(e=c&&c.length)for(var g=0;g<e;g++){var m=c[g]&&(!b?c[g]:c[g].prototype[b]);m&&m.apply(this,f||[])}a?this.callSuper.apply(this,arguments):d.apply(this,arguments)}}}function n(b){var a=this.__hooks__,d=this.prototype;if(this.__extensions__.length&&a)for(var c in a)if(!d.hasOwnProperty(c)||
b.hasOwnProperty(c))b[c]=b[c]||o;return r.call(this,b)}function s(b){var a;b.target===this&&(a=this[i+b.type.slice(5).slice(0,-6)],a.call(this,b.newVal,b))}function t(b){var a=b.get("plugins"),d;e.each(a,function(b,f){"function"===typeof b&&(d=b,a[f]=new d)})}function j(b){var a,d=this.get("plugins");if(a=d.length)for(var c=0;c<a;c++)if(d[c][b])d[c][b](this)}var p=q("attribute"),k=e.ucfirst,i="_onSet",o=e.noop,l=p.extend({constructor:function(){this.callSuper.apply(this,arguments);var b=this.get("listeners"),
a;for(a in b)this.on(a,b[a]);this.initializer();t(this);j.call(this,"pluginInitializer");this.bindInternal();this.syncInternal()},initializer:o,__getHook:h,__callPluginsMethod:j,bindInternal:function(){var b=this.getAttrs(),a,d;for(a in b)if(d=i+k(a),this[d])this.on("after"+k(a)+"Change",s)},syncInternal:function(){var b=[],a;a=this.constructor;for(var d=this.getAttrs();a;)b.push(a),a=a.superclass&&a.superclass.constructor;b.reverse();for(a=0;a<b.length;a++){var c=b[a].ATTRS||{},f;for(f in c)if(f in
d){var e,g;(g=this[i+k(f)])&&0!==d[f].sync&&void 0!==(e=this.get(f))&&g.call(this,e)}}},plug:function(b){"function"===typeof b&&(b=new b);b.pluginInitializer&&b.pluginInitializer(this);this.get("plugins").push(b);return this},unplug:function(b){var a=[],d=this,c="string"===typeof b;e.each(d.get("plugins"),function(f){var e=0,g;b&&(c?(g=f.get&&f.get("pluginId")||f.pluginId,g!==b&&(a.push(f),e=1)):f!==b&&(a.push(f),e=1));e||f.pluginDestructor(d)});d.setInternal("plugins",a);return d},getPlugin:function(b){var a=
null;e.each(this.get("plugins"),function(d){if((d.get&&d.get("pluginId")||d.pluginId)===b)return a=d,!1});return a},destructor:e.noop,destroy:function(){this.get("destroyed")||(j.call(this,"pluginDestructor"),this.destructor(),this.set("destroyed",!0),this.fire("destroy"),this.detach())}});e.mix(l,{__hooks__:{initializer:h(),destructor:h("__destructor",!0)},ATTRS:{plugins:{value:[]},destroyed:{value:!1},listeners:{value:[]}},extend:function a(d,c,f){e.isArray(d)||(f=c,c=d,d=[]);f=f||{};c=c||{};c=
p.extend.call(this,c,f);c.__extensions__=d;n.call(c,{});if(d.length){var h={},g={};e.each(d.concat(c),function(a){if(a){e.each(a.ATTRS,function(a,c){var d=h[c]=h[c]||{};e.mix(d,a)});var a=a.prototype,c;for(c in a)a.hasOwnProperty(c)&&(g[c]=a[c])}});c.ATTRS=h;g.constructor=c;e.augment(c,g)}c.extend=f.extend||a;c.addMembers=n;return c}});var r=l.addMembers;return e.Base=l});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:04
*/
KISSY.add("attribute",["event/custom"],function(g,p,F,C){function n(d,a){return"string"===typeof a?d[a]:a}function o(d){return d.__attrVals||(d.__attrVals={})}function q(d,a,c,b,e,f,h,i){h=h||c;return d.fire(a+g.ucfirst(c)+"Change",g.mix({attrName:h,subAttrName:f,prevVal:b,newVal:e},i))}function k(d,a,c){var b=d[a];!c&&!b&&(d[a]=b={});return b||{}}function t(d,a){for(var c=0,b=a.length;void 0!==d&&c<b;c++)d=d[a[c]];return d}function u(d){var a;-1!==d.indexOf(".")&&(a=d.split("."),d=a.shift());return{path:a,
name:d}}function v(d,a,c){var b=c;if(a){var d=b=void 0===d?{}:g.clone(d),e=a.length-1;if(0<=e){for(var f=0;f<e;f++)d=d[a[f]];void 0!==d&&(d[a[f]]=c)}}return b}function w(d,a,c,b,e){var f,h,i;f=u(a);var D=a,a=f.name;f=f.path;i=d.get(a);var l=a,m=k(d,"__defaultBeforeFns");m[l]||(m[l]=1,l="before"+g.ucfirst(l)+"Change",d.publish(l,{defaultFn:x}));f&&(h=t(i,f));if(b.force||!(!f&&i===c||f&&h===c)){c=v(i,f,c);c=g.mix({attrName:a,subAttrName:D,prevVal:i,newVal:c,_opts:b,_attrs:e,target:d},b.data);if(b.silent){if(j===
x.call(d,c))return j}else if(j===d.fire("before"+g.ucfirst(a)+"Change",c))return j;return d}}function x(d){if(d.target===this){var a=d.newVal,c=d.prevVal,b=d.attrName,e=d.subAttrName,f=d._attrs,d=d._opts,a=this.setInternal(b,a);if(a===j)return a;d.silent||(a=o(this)[b],q(this,"after",b,c,a,e,null,d.data),f?f.push({prevVal:c,newVal:a,attrName:b,subAttrName:e}):q(this,"","*",[c],[a],[e],[b],d.data))}}function r(d){var a=this.constructor;for(this.userConfig=d;a;){var c=a.ATTRS;if(c){var b=void 0;for(b in c)this.addAttr(b,
c[b],!1)}a=a.superclass?a.superclass.constructor:null}if(d)for(var e in d)this.setInternal(e,d[e])}function y(d,a){var c=a.__hooks__||{},b;for(b in c)b in d&&(d[b]=c[b](d[b]));g.each(d,function(b,c){if("function"===typeof b){var g=0;if(b.__owner__){var i=b.__owner__;delete b.__owner__;delete b.__name__;var g=b.__wrapped__=1,j=z(b);j.__owner__=i;j.__name__=c;i.prototype[c]=j}else b.__wrapped__&&(g=1);g&&(d[c]=b=z(b));b.__owner__=a;b.__name__=c}})}function E(d){y(d,this);g.mix(this.prototype,d)}function s(d,
a){var c=d.getAttrs(),b=k(c,a,1),e=b.valueFn;if(e&&(e=n(d,e)))e=e.call(d),void 0!==e&&(b.value=e),delete b.valueFn,c[a]=b;return b.value}function A(d,a,c,b){var e,f;e=u(a);a=e.name;if(e=e.path)f=d.get(a),c=v(f,e,c);if((e=k(d.getAttrs(),a).validator)&&(e=n(d,e)))if(d=e.call(d,c,a,b),void 0!==d&&!0!==d)return d}p=p("event/custom");C.exports=r;var z=g.bind,B={},j=!1;r.extend=function a(c,b){var e,b=b||{},c=c||{},f=b.__hooks__;if(e=this.__hooks__)f=b.__hooks__=b.__hooks__||{},g.mix(f,e,!1);e=c.hasOwnProperty("constructor")?
c.constructor:function(){this.callSuper.apply(this,arguments)};c.constructor=e;e.__hooks__=f;y(c,e);var h=b.inheritedStatics;if(f=this.inheritedStatics)h=b.inheritedStatics=b.inheritedStatics||{},g.mix(h,f,!1);g.extend(e,this,c,b);h&&g.mix(e,h);e.extend=b.extend||a;e.addMembers=E;return e};g.augment(r,p.Target,{INVALID:B,callSuper:function(){var a,c,b=arguments;"function"===typeof this&&this.__name__?(a=this,c=b[0],b=Array.prototype.slice.call(b,1)):(a=arguments.callee.caller,a.__wrapped__&&(a=a.caller),
c=this);var e=a.__name__;if(e)return a=a.__owner__.superclass[e],!a?void 0:a.apply(c,b||[])},getAttrs:function(){return this.__attrs||(this.__attrs={})},getAttrVals:function(){var a={},c,b=this.getAttrs();for(c in b)a[c]=this.get(c);return a},addAttr:function(a,c,b){var e=this.getAttrs(),f,c=g.clone(c);(f=e[a])?g.mix(f,c,b):e[a]=c;return this},addAttrs:function(a,c){var b=this;g.each(a,function(a,c){b.addAttr(c,a)});c&&b.set(c);return b},hasAttr:function(a){return this.getAttrs().hasOwnProperty(a)},
removeAttr:function(a){var c=o(this),b=this.getAttrs();this.hasAttr(a)&&(delete b[a],delete c[a]);return this},set:function(a,c,b){var e;if(g.isPlainObject(a)){var b=c||{},c=Object(a),f=[],h=[];for(a in c)void 0!==(e=A(this,a,c[a],c))&&h.push(e);if(h.length)return b.error&&b.error(h),j;for(a in c)w(this,a,c[a],b,f);var i=[],k=[],l=[],m=[];g.each(f,function(a){k.push(a.prevVal);l.push(a.newVal);i.push(a.attrName);m.push(a.subAttrName)});i.length&&q(this,"","*",k,l,m,i,b.data);return this}b=b||{};e=
A(this,a,c);return void 0!==e?(b.error&&b.error(e),j):w(this,a,c,b)},setInternal:function(a,c){var b,e=k(this.getAttrs(),a).setter;if(e&&(e=n(this,e)))b=e.call(this,c,a);if(b===B)return j;void 0!==b&&(c=b);o(this)[a]=c},get:function(a){var c,b=o(this),e,f;-1!==a.indexOf(".")&&(c=a.split("."),a=c.shift());e=k(this.getAttrs(),a,1).getter;f=a in b?b[a]:s(this,a);if(e&&(e=n(this,e)))f=e.call(this,f,a);!(a in b)&&void 0!==f&&(b[a]=f);c&&(f=t(f,c));return f},reset:function(a,c){if("string"===typeof a)return this.hasAttr(a)?
this.set(a,s(this,a),c):this;var c=a,b=this.getAttrs(),e={};for(a in b)e[a]=s(this,a);this.set(e,c);return this}})});
KISSY.add("mui/datalazyload/webp",function(t){function e(e){var i=window.localStorage&&window.localStorage.getItem("webpsupport");if(i!==null){e(i==="true");return}n(function(n){try{window.localStorage&&window.localStorage.setItem("webpsupport",n)}catch(i){t.log(i)}e(n)})}function n(t){var e=new Image,n;e.onload=e.onerror=function(){if(!n){n=true;t(e.width===2&&e.height===2)}};setTimeout(function(){if(!n){n=true;t(false)}},16);e.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}var i=window.WebP={};i.isSupport=function(t){if(!t)return;if(i._isSupport===undefined){e(function(e){t(i._isSupport=e)});return}t(i._isSupport)};return i},{attach:false});KISSY.add("mui/datalazyload/index",function(t,e,n,i,o){var a=t.Env.host,r=a.document,f="data-ks-lazyload",l="ks-datalazyload",c="-custom",s="default",u="none",d="scroll",g="touchmove",m="resize",h=100,v=0,_;function y(t){var n=e.scrollLeft(),i=e.scrollTop();if(t.getBoundingClientRect){var o=t.getBoundingClientRect(),a=document,r=a.body,f=a&&a.documentElement,l=window.getComputedStyle&&window.getComputedStyle(t).zoom||1;n+=o.left*l-(f.clientLeft||r.clientLeft||0);i+=o.top*l-(f.clientTop||r.clientTop||0)}return{left:n,top:i}}function p(t){var e,n,i=[],o;return function(a,r){if(r!==0&&!r){r=1}if(r&1&&!n){n=true;t(function(t){e=t;while(o=i.shift()){try{o&&o.apply(null,[e])}catch(n){setTimeout(function(){throw n},0)}}})}if(e){a&&a.apply(null,[e]);return e}if(!(r&2)){a&&i.push(a)}return e}}function b(e,n,i){var o,a=0,r=0,n=n||150;function f(){if(o){o.cancel();o=0}a=t.now();e.apply(i||this,arguments);r=t.now()}return t.mix(function(){if(!a||r>=a&&t.now()-r>n||r<a&&t.now()-a>n*8){f()}else{if(o){o.cancel()}o=t.later(f,n,0,null,arguments)}},{stop:function(){if(o){o.cancel();o=0}}})}function w(t,e,n){var i=t.length;function o(){i?t[--i].call(null,e,o):n(e)}o()}function A(t,n,i){if(!t.offsetWidth){return false}var o=y(t),a=window.getComputedStyle&&window.getComputedStyle(t).zoom||1,r=true,f,l=o.left,c=o.top,s={left:l,top:c,right:l+(t._ks_lazy_width||(t._ks_lazy_width=e.outerWidth(t)*a)),bottom:c+(t._ks_lazy_height||(t._ks_lazy_height=e.outerHeight(t)*a))};f=R(n,s);if(f&&i){r=R(i,s)}return r&&f}function k(t){if(/^(loaded|complete)$/.test(document.readyState)){return t()}if(window.addEventListener){return window.addEventListener("load",t,false)}if(window.attachEvent){return window.attachEvent("onload",t)}}function S(t){var e=["webkit",""],n=r.createElement("div"),i=e.length;for(var i=0,a=e.length;i<a;i++){if(!e[i]){t=t.toLowerCase()}if(n.style[e[i]+t]!==o){return true}}return false}function I(e,n){var i=this;if(!(i instanceof I)){return new I(e,n)}var o=e;if(!t.isPlainObject(o)){o=n||{};if(e){o.container=e}}I.superclass.constructor.call(i,o);i._diffRatio=0;i._callbacks={};i._startLis=[];i._containerIsNotDocument=i.get("container").nodeType!=9;i._fade=S("Animation")&&!(/Android (\d+\.\d+)/i.test(a.navigator.userAgent)&&parseFloat(RegExp["$1"])<4.3);if(t.isArray(o.container)){i._backCompact=1}i["_initLoadEvent"]();o.container&&i.addElements(o.container);i._loadFn();t.ready(function(){i._loadFn()});k(function(){i._diffRatio=Math.max(t.UA.ios?2:1,i._diffRatio);i._loadFn()});i.resume();i.on("afterDiffChange",function(t){if(t.newVal===t.prevVal)return;i._windowRegion=i["_getBoundingRect"]();if(!i._backCompact&&i._containerIsNotDocument){i._containerRegion=i["_getBoundingRect"](i.get("container"))}})}I.ATTRS={diff:{value:s},placeholder:{value:window.ActiveXObject&&!document.documentMode?"//g.alicdn.com/s.gif":"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="},execScript:{value:true},fade:{value:true},container:{setter:function(n){n=n||r;if(t.isWindow(n)){n=n.document}else{n=e.get(n);if(e.nodeName(n)=="body"){n=n.ownerDocument}}return n},valueFn:function(){return r}},autoDestroy:{value:true},onStart:{value:null}};function R(t,e){var n={};n.top=Math.max(t.top,e.top);n.bottom=Math.min(t.bottom,e.bottom);n.left=Math.max(t.left,e.left);n.right=Math.min(t.right,e.right);return n.bottom>=n.top&&n.right>=n.left}t.extend(I,i,{addStartListener:function(e){var n=this._startLis;if(!e||t.indexOf(e,n)>=0){return}n.push(e)},_initLoadEvent:function(){var i=this,o=i.get("autoDestroy");i.addStartListener(function(t,e){var n=i.get("onStart");if(n){var o=n.apply(this,arguments);if(o===true||o===false){t.returnValue=o}}e()});i.addStartListener(function(e,n){if(e.type!="img"){n();return}var o=i.get("webpReplacer");if(t.isFunction(o)){t.use("mui/datalazyload/webp",function(t,i){i.isSupport(function(t){if(t){e.src=o(e.src)}n()})})}else{n()}});i.imgHandle=function(){var t=this,o=i.get("imgFlag")||f,a=t.getAttribute(o);w(i._startLis,{type:"img",elem:t,src:a},function(a){if(a.returnValue===false){return}if(a.src&&t.src!=a.src){if(i.isFade){var r="img-ks-lazyload",f="img-ks-beforeload";e.addClass(t,f);n.on(t,"load",function(){n.detach(t,"load",arguments.callee);e.removeClass(t,f);e.addClass(t,r);i.refresh()})}t.src=a.src}t.removeAttribute(o)})};i.bgimgHandle=function(){var t=this,e=(i.get("imgFlag")||f)+"-bg",n=t.getAttribute(e);w(i._startLis,{type:"bgimg",elem:t,bgimgSrc:n},function(n){if(n.returnValue===false){return}if(n.bgimgSrc){var i=t&&t.filters,o,a;try{o=i&&i.item("DXImageTransform.Microsoft.AlphaImageLoader");a=i&&i.item("DXImageTransform.Microsoft.Matrix")}catch(r){}if(o){o.src=n.bgimgSrc;o.enabled=true;function f(t,e){var n=new Image;n.style.position="absolute";n.style.visibility="visible";n.onload=n.onerror=function(){e(n);document.body.removeChild(n);n=null};document.body.appendChild(n);n.src=t}if(!a||!t.offsetWidth||!t.offsetHeight){return}f(n.bgimgSrc,function(e){if(!e.offsetWidth||!e.offsetHeight){return}var n=t.currentStyle["background-size"]=="cover"?"cover":"contain";if(e.offsetHeight/e.offsetWidth>t.offsetHeight/t.offsetWidth===(n=="contain")){a.M11=t.offsetHeight*e.offsetWidth/(t.offsetWidth*e.offsetHeight);a.M22=1;a.Dx=t.offsetWidth*(1-a.M11)/2;a.Dy=0}else{a.M11=1;a.M22=t.offsetWidth*e.offsetHeight/(t.offsetHeight*e.offsetWidth);a.Dx=0;a.Dy=t.offsetHeight*(1-a.M22)/2}a.enabled=true})}else{t.style.backgroundImage="url("+n.bgimgSrc+")"}}t.removeAttribute(e)})};i.textareaHandle=function(){var t=this;t.style.display=u;t.className="";var n=e.create("<div>");t.parentNode.insertBefore(n,t);w(i._startLis,{type:"textarea",elem:t,value:t.value},function(t){if(t.returnValue===false){return}e.html(n,t.value,i.get("execScript"));i.addElements(n);i.refresh()})};i._loadFn=b(function(){if(o&&t.isEmptyObject(i._callbacks)){i.destroy()}i["_loadItems"]()},h,i);i._onScroll=function(e){i._onScroll=i._loadFn;i._diffRatio=Math.max(t.UA.ios?4:2,i._diffRatio);i._loadFn()}},refresh:function(){this._loadFn()},_loadItems:function(){var e=this,n=e.get("container");if(e._containerIsNotDocument&&!n.offsetWidth){return}e._windowRegion=e["_getBoundingRect"]();if(!e._backCompact&&e._containerIsNotDocument){e._containerRegion=e["_getBoundingRect"](e.get("container"))}t.each(e._callbacks,function(t,n){t&&e._loadItem(n,t)})},_loadItem:function(t,e){var n=this,e=e||n._callbacks[t];if(!e){return true}var i=e.el,o=false,a=e.fn;if(n.get("force")||A(i,n._windowRegion,n._containerRegion)){try{o=a.call(i)}catch(r){setTimeout(function(){throw r},0)}}if(o!==false){delete n._callbacks[t]}return o},addCallback:function(n,i){n=e.get(n);var o=this,a=o._callbacks,r={el:n||document,fn:i||t.noop},f=++v;a[f]=r;if(o._windowRegion){o._loadItem(f,r)}else{o.refresh()}return f},removeCallback:function(n,i){n=e.get(n);var o=this._callbacks;t.each(o,function(t,e){if(t.el==n&&(i?t.fn==i:1)){delete o[e]}})},getElements:function(){var e=this,n=[],i=[],o=e._callbacks;t.each(o,function(t){if(t.fn==e.imgHandle){n.push(t.el)}if(t.fn==e.textareaHandle){i.push(t.el)}});return{images:this._images,textareas:this._textareas}},addElements:function(n,i){if(typeof n=="string"){n=e.query(n)}else if(!t.isArray(n)){n=[n]}var o=this;o._addStyle();t.each(n,function(n){if(!n){return}if(!i||i==="img"){t.each(t.filter([n].concat(e.query("img",n)),function(t){return t.getAttribute&&t.getAttribute(o.get("imgFlag")||f)},o),function(t){var e=o.addCallback(t,o.imgHandle);if(!t.offsetWidth){t.onload=t.onerror=function(){setTimeout(function(){o._loadItem(e)},0)};if(!t.src){o.onPlaceHolder=o.onPlaceHolder||p(function(t){var e=o._phImg=new Image,n=o.get("placeholder");e.onload=e.onerror=function(){t(n)};e.src=n});o.onPlaceHolder(function(e){if(!t.src){t.src=e}})}}})}if(!i||i==="bgimg"){var a=(o.get("imgFlag")||f)+"-bg";t.each(t.filter([n].concat(e.query("["+a+" ]",n)),function(t){return t.getAttribute&&t.getAttribute(a)},o),function(t){o.addCallback(t,o.bgimgHandle)})}if(!i||i==="textarea"){t.each(e.query("textarea."+(o.get("areaFlag")||l),n),function(t){o.addCallback(t,o.textareaHandle)})}})},removeElements:function(n){if(typeof n=="string"){n=e.query(n)}else if(!t.isArray(n)){n=[n]}var i=this,o=i._callbacks;t.each(o,function(e,i){if(t.inArray(e.el,n)){delete o[i]}})},_getBoundingRect:function(n){var i,a,r,f;if(n!==o){i=e.outerHeight(n);a=e.outerWidth(n);var l=y(n);r=l.left;f=l.top}else{i=e.viewportHeight();a=e.viewportWidth();r=e.scrollLeft();f=e.scrollTop()}var c=this.get("diff"),u=this._diffRatio;if(c===s){c={left:0,top:0,right:a*u,bottom:i*u}}else if(!t.isObject(c)){c={left:c,top:c,right:c,bottom:c}}return{left:r-(c.left||0),top:f-(c.top||0),right:r+a+(c.right||0),bottom:f+i+(c.bottom||0)}},pause:function(){var t=this,e=t._onScroll,i=t._loadFn;if(t._destroyed){return}n.remove(a,d,e);n.remove(a,g,e);n.remove(a,m,i);i.stop();if(t._containerIsNotDocument){var o=t.get("container");n.remove(o,d,e);n.remove(o,g,e)}},resume:function(){var t=this,e=t._onScroll,i=t._loadFn;if(t._destroyed){return}n.on(a,d,e);n.on(a,g,e);n.on(a,m,i);if(t._containerIsNotDocument){var o=t.get("container");n.on(o,d,e);n.on(o,g,e)}},destroy:function(){var e=this;e.pause();e._callbacks={};t.log("datalazyload is destroyed!");e.fire("destroy");e._destroyed=1},_addStyle:function(){var t=this;if(t._fade){t.isFade=t.get("fade");if(t.isFade&&!_){_=true;e.addStyleSheet("@-webkit-keyframes ks-fadeIn{0%{opacity:0}100%{opacity:1}}"+"@keyframes ks-fadeIn{0%{opacity:0}100%{opacity:1}}"+".img-ks-lazyload{-webkit-animation:ks-fadeIn 350ms linear 0ms 1 normal both;animation:ks-fadeIn 350ms linear 0ms 1 normal both;opacity:1}"+".img-ks-beforeload{opacity:0}")}}}});function C(n,i,o,a){if(i==="img-src"){i="img"}if(!t.isArray(n)){n=[e.get(n)]}var s=new I(r,{});s.set("imgFlag",o||f+c);s.set("areaFlag",o||l+c);s.set("onStart",a);s.set("force",true);s.addElements(n,i)}I.loadCustomLazyData=C;var H;I.instance=function(){return H||(H=new I(null,{autoDestroy:false}))};t.DataLazyload=I;return I},{requires:["dom","event","base"]});/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:17
*/
KISSY.add("node/base",["dom","event/dom"],function(b,e){function c(f,m,g){if(!(this instanceof c))return new c(f,m,g);if(f)if("string"===typeof f){if(f=h.create(f,m,g),f.nodeType===k.DOCUMENT_FRAGMENT_NODE)return d.apply(this,a(f.childNodes)),this}else{if(b.isArray(f)||j(f))return d.apply(this,a(f)),this}else return this;this[0]=f;this.length=1;return this}var h=e("dom"),i=e("event/dom"),g=Array.prototype,l=g.slice,k=h.NodeType,d=g.push,a=b.makeArray,j=h.isDomNodeList;c.prototype={constructor:c,isNodeList:!0,
length:0,item:function(f){return"number"===typeof f?f>=this.length?null:new c(this[f]):new c(f)},add:function(f,a,b){"number"===typeof a&&(b=a,a=void 0);f=c.all(f,a).getDOMNodes();a=new c(this);void 0===b?d.apply(a,f):(b=[b,0],b.push.apply(b,f),g.splice.apply(a,b));return a},slice:function(){return new c(l.apply(this,arguments))},getDOMNodes:function(){return l.call(this)},each:function(a,d){var k=this;b.each(k,function(b,j){b=new c(b);return a.call(d||b,b,j,k)});return k},getDOMNode:function(){return this[0]},
end:function(){return this.__parent||this},filter:function(a){return new c(h.filter(this,a))},all:function(a){a=0<this.length?c.all(a,this):new c;a.__parent=this;return a},one:function(a){a=this.all(a);if(a=a.length?a.slice(0,1):null)a.__parent=this;return a}};b.mix(c,{all:function(a,d){return"string"===typeof a&&(a=b.trim(a))&&3<=a.length&&b.startsWith(a,"<")&&b.endsWith(a,">")?(d&&(d.getDOMNode&&(d=d[0]),d=d.ownerDocument||d),new c(a,void 0,d)):new c(h.query(a,d))},one:function(a,d){var b=c.all(a,
d);return b.length?b.slice(0,1):null}});c.NodeType=k;c.KeyCode=i.KeyCode;c.Gesture=i.Gesture;c.REPLACE_HISTORY=i.REPLACE_HISTORY;return c});
KISSY.add("node/attach",["dom","event/dom","./base"],function(b,e){function c(d,a,b){b.unshift(a);d=h[d].apply(h,b);return void 0===d?a:d}var h=e("dom"),i=e("event/dom"),g=e("./base"),l=g.prototype,k=b.makeArray;g.KeyCode=i.KeyCode;b.each("nodeName,isCustomDomain,getEmptyIframeSrc,equals,contains,index,scrollTop,scrollLeft,height,width,innerHeight,innerWidth,outerHeight,outerWidth,addStyleSheet,appendTo,prependTo,insertBefore,before,after,insertAfter,test,hasClass,addClass,removeClass,replaceClass,toggleClass,removeAttr,hasAttr,hasProp,scrollIntoView,remove,empty,removeData,hasData,unselectable,wrap,wrapAll,replaceWith,wrapInner,unwrap".split(","),function(d){l[d]=
function(){var a=k(arguments);return c(d,this,a)}});b.each("getWindow,getDocument,filter,first,last,parent,closest,next,prev,clone,siblings,contents,children".split(","),function(d){l[d]=function(){var a=k(arguments);a.unshift(this);a=h[d].apply(h,a);return a===void 0?this:a===null?null:new g(a)}});b.each({attr:1,text:0,css:1,style:1,val:0,prop:1,offset:0,html:0,outerHTML:0,outerHtml:0,data:1},function(d,a){l[a]=function(){var j;j=k(arguments);void 0===j[d]&&!b.isObject(j[0])?(j.unshift(this),j=h[a].apply(h,
j)):j=c(a,this,j);return j}});b.each(["on","detach","delegate","undelegate"],function(d){l[d]=function(){var a=k(arguments);a.unshift(this);i[d].apply(i,a);return this}});b.each(["fire","fireHandler"],function(d){l[d]=function(){var a=k(arguments);a.unshift(this);return i[d].apply(i,a)}})});
KISSY.add("node/override",["dom","./base","./attach"],function(b,e){var c=e("dom"),h=e("./base");e("./attach");var i=h.prototype;b.each(["append","prepend","before","after"],function(b){i[b]=function(e){"string"===typeof e&&(e=c.create(e));if(e)c[b](e,this);return this}});b.each(["wrap","wrapAll","replaceWith","wrapInner"],function(b){var c=i[b];i[b]=function(b){"string"===typeof b&&(b=h.all(b,this[0].ownerDocument));return c.call(this,b)}})});
KISSY.add("node/anim",["./base","dom","anim"],function(b,e){function c(b,d,a){for(var c=[],f={},a=a||0;a<d;a++)c.push.apply(c,l[a]);for(a=0;a<c.length;a++)f[c[a]]=b;return f}var h=e("./base"),i=e("dom"),g=e("anim"),l=[["height","margin-top","margin-bottom","padding-top","padding-bottom"],["width","margin-left","margin-right","padding-left","padding-right"],["opacity"]];b.augment(h,{animate:function(){var c=b.makeArray(arguments);b.each(this,function(d){var a=b.clone(c),e=a[0];e.to?(e.node=d,(new g(e)).run()):
g.apply(void 0,[d].concat(a)).run()});return this},stop:function(c,d,a){b.each(this,function(b){g.stop(b,c,d,a)});return this},pause:function(c,d){b.each(this,function(a){g.pause(a,d)});return this},resume:function(c,d){b.each(this,function(a){g.resume(a,d)});return this},isRunning:function(){for(var b=0;b<this.length;b++)if(g.isRunning(this[b]))return!0;return!1},isPaused:function(){for(var b=0;b<this.length;b++)if(g.isPaused(this[b]))return!0;return!1}});b.each({show:c("show",3),hide:c("hide",3),
toggle:c("toggle",3),fadeIn:c("show",3,2),fadeOut:c("hide",3,2),fadeToggle:c("toggle",3,2),slideDown:c("show",1),slideUp:c("hide",1),slideToggle:c("toggle",1)},function(c,d){h.prototype[d]=function(a,e,f){if(i[d]&&!a)i[d](this);else b.each(this,function(b){(new g(b,c,a,f,e)).run()});return this}})});
KISSY.add("node",["node/base","node/attach","node/override","node/anim"],function(b,e){var c=e("node/base");e("node/attach");e("node/override");e("node/anim");b.mix(b,{Node:c,NodeList:c,one:c.one,all:c.all});return c});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:04
*/
KISSY.add("anim",["anim/base","anim/timer","anim/transition?"],function(b,g){function a(a,e,d,f,c){if(a.node)c=a;else{"string"===typeof e?(e=b.unparam(""+e,";",":"),b.each(e,function(c,a){var d=b.trim(a);d&&(e[d]=b.trim(c));(!d||d!==a)&&delete e[a]})):e=b.clone(e);if(b.isPlainObject(d))c=b.clone(d);else if(c={complete:c},d&&(c.duration=d),f)c.easing=f;c.node=a;c.to=e}c=b.merge(k,c,{useTransition:b.config("anim/useTransition")});if(c.useTransition&&h)return"use transition anim",new h(c);"use js timer anim";
return new i(c)}var j=g("anim/base"),i=g("anim/timer"),h=g("anim/transition?"),f=j.Utils,k={duration:1,easing:"linear"};b.each(["pause","resume"],function(b){a[b]=function(a,d){return null===d||"string"===typeof d||!1===d?f.pauseOrResumeQueue(a,d,b):f.pauseOrResumeQueue(a,void 0,b)}});a.isRunning=f.isElRunning;a.isPaused=f.isElPaused;a.stop=f.stopEl;a.Easing=i.Easing;b.Anim=a;a.Q=j.Q;return a});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 23 18:52
*/
KISSY.add("anim/base/queue",["dom"],function(c,i){function h(a,b,c){var b=b||f,j,m=d.data(a,g);!m&&!c&&d.data(a,g,m={});m&&(j=m[b],!j&&!c&&(j=m[b]=[]));return j}var d=i("dom"),g=c.guid("ks-queue-"+c.now()+"-"),f=c.guid("ks-queue-"+c.now()+"-"),a;return a={queueCollectionKey:g,queue:function(a,c,d){a=h(a,c);a.push(d);return a},remove:function(e,b,d){var j=h(e,b,1);j&&(d=c.indexOf(d,j),-1<d&&j.splice(d,1));j&&!j.length&&a.clearQueue(e,b);return j},clearQueues:function(a){d.removeData(a,g)},clearQueue:function(a,
b){var b=b||f,l=d.data(a,g);l&&delete l[b];c.isEmptyObject(l)&&d.removeData(a,g)},dequeue:function(c,b){var d=h(c,b,1);d&&(d.shift(),d.length||a.clearQueue(c,b));return d}}});
KISSY.add("anim/base/utils",["./queue","dom"],function(c,i){var h=i("./queue"),d=i("dom"),g=c.guid("ks-anim-unqueued-"+c.now()+"-"),f=c.guid("ks-anim-paused-"+c.now()+"-");return{saveRunningAnim:function(a){var e=a.node,b=d.data(e,g);b||d.data(e,g,b={});b[c.stamp(a)]=a},removeRunningAnim:function(a){var e=a.node,b=d.data(e,g);b&&(delete b[c.stamp(a)],c.isEmptyObject(b)&&d.removeData(e,g))},isAnimPaused:function(a){var e=d.data(a.node,f);return e?!!e[c.stamp(a)]:0},removePausedAnim:function(a){var e=
a.node,b=d.data(e,f);b&&(delete b[c.stamp(a)],c.isEmptyObject(b)&&d.removeData(e,f))},savePausedAnim:function(a){var e=a.node,b=d.data(e,f);b||d.data(e,f,b={});b[c.stamp(a)]=a},isAnimRunning:function(a){var e=d.data(a.node,g);return e?!!e[c.stamp(a)]:0},isElPaused:function(a){return(a=d.data(a,f))&&!c.isEmptyObject(a)},isElRunning:function(a){return(a=d.data(a,g))&&!c.isEmptyObject(a)},pauseOrResumeQueue:function(a,e,b){a=d.data(a,"resume"===b?f:g);a=c.merge(a);c.each(a,function(a){if(void 0===e||
a.config.queue===e)a[b]()})},stopEl:function(a,e,b,f){b&&(void 0===f?h.clearQueues(a):!1!==f&&h.clearQueue(a,f));a=d.data(a,g);a=c.merge(a);c.each(a,function(a){(void 0===f||a.config.queue===f)&&a.stop(e)})}}});
KISSY.add("anim/base",["dom","./base/utils","./base/queue","promise"],function(c,i){function h(j){h.superclass.constructor.call(this);a.Defer(this);this.config=j;var b=j.node;c.isPlainObject(b)||(b=d.get(j.node));this.node=this.el=b;this._backupProps={};this._propsData={}}var d=i("dom"),g=i("./base/utils"),f=i("./base/queue"),a=i("promise"),e=d.NodeType,b=c.noop,l={toggle:1,hide:1,show:1};c.extend(h,a,{on:function(a,c){"please use promise api of anim instead";"complete"===a?this.then(c):"end"===a?
this.fin(c):"step"===a?this.progress(c):"not supported event for anim: "+a;return this},prepareFx:b,runInternal:function(){var a=this,b=a.config,f=a.node,h,i=a._backupProps,o=a._propsData,k=b.to,r=b.delay||0,p=b.duration;g.saveRunningAnim(a);c.each(k,function(a,d){c.isPlainObject(a)||(a={value:a});o[d]=c.mix({delay:r,easing:b.easing,frame:b.frame,duration:p},a)});if(f.nodeType===e.ELEMENT_NODE){if(k.width||k.height)k=f.style,c.mix(i,{overflow:k.overflow,"overflow-x":k.overflowX,"overflow-y":k.overflowY}),
k.overflow="hidden","inline"===d.css(f,"display")&&"none"===d.css(f,"float")&&(10>c.UA.ieMode?k.zoom=1:k.display="inline-block");var q,n;n="none"===d.css(f,"display");c.each(o,function(c,b){h=c.value;if(l[h]){if("hide"===h&&n||"show"===h&&!n)return a.stop(!0),q=!1;i[b]=d.style(f,b);"toggle"===h&&(h=n?"show":"hide");"hide"===h?(c.value=0,i.display="none"):(c.value=d.css(f,b),d.css(f,b,0),d.show(f))}});if(!1===q)return}a.startTime=c.now();c.isEmptyObject(o)?(a.__totalTime=1E3*p,a.__waitTimeout=setTimeout(function(){a.stop(!0)},
a.__totalTime)):(a.prepareFx(),a.doStart())},isRunning:function(){return g.isAnimRunning(this)},isPaused:function(){return g.isAnimPaused(this)},pause:function(){this.isRunning()&&(this._runTime=c.now()-this.startTime,this.__totalTime-=this._runTime,g.removeRunningAnim(this),g.savePausedAnim(this),this.__waitTimeout?clearTimeout(this.__waitTimeout):this.doStop());return this},doStop:b,doStart:b,resume:function(){var a=this;a.isPaused()&&(a.startTime=c.now()-a._runTime,g.removePausedAnim(a),g.saveRunningAnim(a),
a.__waitTimeout?a.__waitTimeout=setTimeout(function(){a.stop(!0)},a.__totalTime):(a.beforeResume(),a.doStart()));return a},beforeResume:b,run:function(){var a;a=this.config.queue;!1===a?this.runInternal():(a=f.queue(this.node,a,this),1===a.length&&this.runInternal());return this},stop:function(a){var b=this.node,e=this.config.queue;if(this.isResolved()||this.isRejected())return this;this.__waitTimeout&&(clearTimeout(this.__waitTimeout),this.__waitTimeout=0);if(!this.isRunning()&&!this.isPaused())return!1!==
e&&f.remove(b,e,this),this;this.doStop(a);g.removeRunningAnim(this);g.removePausedAnim(this);var h=this.defer;if(a){var i,a=this.config.complete;c.isEmptyObject(i=this._backupProps)||d.css(this.node,i);a&&a.call(this);h.resolve([this])}else h.reject([this]);!1!==e&&(b=f.dequeue(b,e))&&b[0]&&b[0].runInternal();return this}});h.Utils=g;h.Q=f;return h});
/*
Copyright 2013, KISSY v1.42
MIT Licensed
build time: Dec 4 22:04
*/
KISSY.add("anim/timer/easing",[],function(){function j(a){return a}function g(a,b,n,e){var d=3*a-3*n+1,c=3*n-6*a,i=3*a,l=3*b-3*e+1,f=3*e-6*b,j=3*b;return function(a){a:{for(var b=a,n,e,k=0;8>k;k++){e=((d*b+c)*b+i)*b-a;if(m(e)<o){a=b;break a}n=(3*d*b+2*c)*b+i;if(m(n)<o)break;b-=e/n}n=1;k=0;for(b=a;n>k;){e=((d*b+c)*b+i)*b-a;if(m(e)<o)break;0<e?n=b:k=b;b=(n+k)/2}a=b}return((l*a+f)*a+j)*a}}var h=Math.PI,i=Math.pow,b=Math.sin,c=parseFloat,l=/^cubic-bezier\(([^,]+),([^,]+),([^,]+),([^,]+)\)$/i,f={swing:function(a){return-Math.cos(a*
h)/2+0.5},easeNone:j,linear:j,easeIn:function(a){return a*a},ease:g(0.25,0.1,0.25,1),"ease-in":g(0.42,0,1,1),"ease-out":g(0,0,0.58,1),"ease-in-out":g(0.42,0,0.58,1),"ease-out-in":g(0,0.42,1,0.58),toFn:function(a){var b;return(b=a.match(l))?g(c(b[1]),c(b[2]),c(b[3]),c(b[4])):f[a]||j},easeOut:function(a){return(2-a)*a},easeBoth:function(a){return 1>(a*=2)?0.5*a*a:0.5*(1- --a*(a-2))},easeInStrong:function(a){return a*a*a*a},easeOutStrong:function(a){return 1- --a*a*a*a},easeBothStrong:function(a){return 1>
(a*=2)?0.5*a*a*a*a:0.5*(2-(a-=2)*a*a*a)},elasticIn:function(a){return 0===a||1===a?a:-(i(2,10*(a-=1))*b(2*(a-0.075)*h/0.3))},elasticOut:function(a){return 0===a||1===a?a:i(2,-10*a)*b(2*(a-0.075)*h/0.3)+1},elasticBoth:function(a){return 0===a||2===(a*=2)?a:1>a?-0.5*i(2,10*(a-=1))*b(2*(a-0.1125)*h/0.45):0.5*i(2,-10*(a-=1))*b(2*(a-0.1125)*h/0.45)+1},backIn:function(a){1===a&&(a-=0.001);return a*a*(2.70158*a-1.70158)},backOut:function(a){return(a-=1)*a*(2.70158*a+1.70158)+1},backBoth:function(a){var b,
n=(b=2.5949095)+1;return 1>(a*=2)?0.5*a*a*(n*a-b):0.5*((a-=2)*a*(n*a+b)+2)},bounceIn:function(a){return 1-f.bounceOut(1-a)},bounceOut:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+0.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+0.9375:7.5625*(a-=2.625/2.75)*a+0.984375},bounceBoth:function(a){return 0.5>a?0.5*f.bounceIn(2*a):0.5*f.bounceOut(2*a-1)+0.5}},o=1.0E-6,m=Math.abs;return f});
KISSY.add("anim/timer/manager",[],function(j){var g=j.stamp,h,i;h=function(b){return setTimeout(b,15)};i=function(b){clearTimeout(b)};return{runnings:{},timer:null,start:function(b){var c=g(b);this.runnings[c]||(this.runnings[c]=b,this.startTimer())},stop:function(b){this.notRun(b)},notRun:function(b){delete this.runnings[g(b)];j.isEmptyObject(this.runnings)&&this.stopTimer()},pause:function(b){this.notRun(b)},resume:function(b){this.start(b)},startTimer:function(){var b=this;b.timer||(b.timer=h(function l(){b.runFrames()?
b.stopTimer():b.timer=h(l)}))},stopTimer:function(){var b=this.timer;b&&(i(b),this.timer=0)},runFrames:function(){var b,c,i=this.runnings;for(b in i)i[b].frame();for(b in i){c=0;break}return void 0===c}}});
KISSY.add("anim/timer/fx",["dom"],function(j,g){function h(b){j.mix(this,b);this.pos=0;this.unit=this.unit||""}var i=g("dom");h.prototype={isCustomFx:0,constructor:h,load:function(b){j.mix(this,b);this.pos=0;this.unit=this.unit||""},frame:function(b){if(1!==this.pos){var c=this.anim,h=this.prop,f=c.node,g=this.from,m=this.propData,a=this.to;if(void 0===b)var k=j.now(),b=m.duration,k=k-c.startTime-m.delay,b=0>=k?0:k>=b?1:m.easing(k/b);this.pos=b;g===a||0===b||(this.val=b=this.interpolate(g,a,this.pos),
m.frame?m.frame.call(this,c,this):this.isCustomFx||(void 0===b?(this.pos=1,b=a,h+" update directly ! : "+b+" : "+g+" : "+a):b+=this.unit,this.val=b,"attr"===this.type?i.attr(f,h,b,1):i.css(f,h,b)))}},interpolate:function(b,c,i){if("number"===typeof b&&"number"===typeof c)return Math.round(1E5*(b+(c-b)*i))/1E5},cur:function(){var b=this.prop,c,h,f=this.anim.node;if(this.isCustomFx)return f[b]||0;if(!(c=this.type))c=this.type=(!f.style||null==f.style[b])&&null!=i.attr(f,b,void 0,1)?"attr":"css";b="attr"===
c?i.attr(f,b,void 0,1):i.css(f,b);return isNaN(h=parseFloat(b))?!b||"auto"===b?0:b:h}};h.Factories={};h.FxTypes={};h.getFx=function(b){var c=h,i,f;if(i=b.fxType)c=h.FxTypes[i];else if(!b.isCustomFx&&(f=h.Factories[b.prop]))c=f;return new c(b)};return h});
KISSY.add("anim/timer/short-hand",[],function(){return{background:[],border:["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth"],borderBottom:["borderBottomWidth"],borderLeft:["borderLeftWidth"],borderTop:["borderTopWidth"],borderRight:["borderRightWidth"],font:["fontSize","fontWeight"],margin:["marginBottom","marginLeft","marginRight","marginTop"],padding:["paddingBottom","paddingLeft","paddingRight","paddingTop"]}});
KISSY.add("anim/timer/color",["./fx","./short-hand"],function(j,g){function h(b){var b=b+"",e;if(e=b.match(m))return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])];if(e=b.match(a))return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3]),parseInt(e[4])];if(e=b.match(k)){for(b=1;b<e.length;b++)2>e[b].length&&(e[b]+=e[b]);return[parseInt(e[1],l),parseInt(e[2],l),parseInt(e[3],l)]}if(o[b=b.toLowerCase()])return o[b];"only allow rgb or hex color string : "+b;return[255,255,255]}function i(){i.superclass.constructor.apply(this,
arguments)}var b=g("./fx"),c=g("./short-hand"),l=16,f=Math.floor,o={black:[0,0,0],silver:[192,192,192],gray:[128,128,128],white:[255,255,255],maroon:[128,0,0],red:[255,0,0],purple:[128,0,128],fuchsia:[255,0,255],green:[0,128,0],lime:[0,255,0],olive:[128,128,0],yellow:[255,255,0],navy:[0,0,128],blue:[0,0,255],teal:[0,128,128],aqua:[0,255,255]},m=/^rgb\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\)$/i,a=/^rgba\(([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+),\s*([0-9]+)\)$/i,k=/^#?([0-9A-F]{1,2})([0-9A-F]{1,2})([0-9A-F]{1,2})$/i;
c.background.push("backgroundColor");c.borderColor=["borderBottomColor","borderLeftColor","borderRightColor","borderTopColor"];c.border.push("borderBottomColor","borderLeftColor","borderRightColor","borderTopColor");c.borderBottom.push("borderBottomColor");c.borderLeft.push("borderLeftColor");c.borderRight.push("borderRightColor");c.borderTop.push("borderTopColor");j.extend(i,b,{load:function(){i.superclass.load.apply(this,arguments);this.from&&(this.from=h(this.from));this.to&&(this.to=h(this.to))},
interpolate:function(a,b,d){var k=i.superclass.interpolate;if(3===a.length&&3===b.length)return"rgb("+[f(k(a[0],b[0],d)),f(k(a[1],b[1],d)),f(k(a[2],b[2],d))].join(", ")+")";if(4===a.length||4===b.length)return"rgba("+[f(k(a[0],b[0],d)),f(k(a[1],b[1],d)),f(k(a[2],b[2],d)),f(k(a[3]||1,b[3]||1,d))].join(", ")+")";"unknown value : "+a}});j.each("backgroundColor,borderBottomColor,borderLeftColor,borderRightColor,borderTopColor,color,outlineColor".split(","),function(a){b.Factories[a]=i});return b.FxTypes.color=
i});
KISSY.add("anim/timer/transform",["dom","./fx"],function(j,g){function h(a){a=a.split(/,/);return a=j.map(a,function(a){return b(a)})}function i(){return{translateX:0,translateY:0,rotate:0,skewX:0,skewY:0,scaleX:1,scaleY:1}}function b(a){return Math.round(1E5*parseFloat(a))/1E5}function c(a){for(var a=a.split(")"),k=j.trim,n=-1,e=a.length-1,d,c,f=i();++n<e;)switch(d=a[n].split("("),c=k(d[0]),d=d[1],c){case "translateX":case "translateY":case "scaleX":case "scaleY":f[c]=b(d);break;case "rotate":case "skewX":case "skewY":var g=b(d);
j.endsWith(d,"deg")||(g=180*g/Math.PI);f[c]=g;break;case "translate":case "translate3d":d=d.split(",");f.translateX=b(d[0]);f.translateY=b(d[1]||0);break;case "scale":d=d.split(",");f.scaleX=b(d[0]);f.scaleY=b(d[1]||d[0]);break;case "matrix":return a=d,a=h(a),e=n=k=void 0,c=a[0],f=a[1],d=a[2],g=a[3],c*g-f*d?(k=Math.sqrt(c*c+f*f),e=(c*d+f*g)/(c*g-d*f),n=(c*g-f*d)/k,c*g<f*d&&(e=-e,k=-k)):k=n=e=0,{translateX:b(a[4]),translateY:b(a[5]),rotate:b(180*Math.atan2(f,c)/Math.PI),skewX:b(180*Math.atan(e)/Math.PI),
skewY:0,scaleX:b(k),scaleY:b(n)}}return f}function l(){l.superclass.constructor.apply(this,arguments)}var f=g("dom"),o=g("./fx"),m=j.Features.isTransform3dSupported()?"translate3d({translateX}px,{translateY}px,0)":"translate({translateX}px,{translateY}px)";j.extend(l,o,{load:function(){l.superclass.load.apply(this,arguments);this.from=(this.from=f.style(this.anim.node,"transform")||this.from)&&"none"!==this.from?c(this.from):i();this.to=this.to?c(this.to):i()},interpolate:function(a,b,c){var e=l.superclass.interpolate,
d={};d.translateX=e(a.translateX,b.translateX,c);d.translateY=e(a.translateY,b.translateY,c);d.rotate=e(a.rotate,b.rotate,c);d.skewX=e(a.skewX,b.skewX,c);d.skewY=e(a.skewY,b.skewY,c);d.scaleX=e(a.scaleX,b.scaleX,c);d.scaleY=e(a.scaleY,b.scaleY,c);return j.substitute(m+" rotate({rotate}deg) skewX({skewX}deg) skewY({skewY}deg) scale({scaleX},{scaleY})",d)}});return o.Factories.transform=l});
KISSY.add("anim/timer","dom,./base,./timer/easing,./timer/manager,./timer/fx,./timer/short-hand,./timer/color,./timer/transform".split(","),function(j,g){function h(){var a;h.superclass.constructor.apply(this,arguments);j.each(a=this.to,function(b,c){var d=m(c);if(c!==d){a[d]=a[c];delete a[c]}})}var i=g("dom"),b=g("./base"),c=g("./timer/easing"),l=g("./timer/manager"),f=g("./timer/fx"),o=g("./timer/short-hand");g("./timer/color");g("./timer/transform");var m=i._camelCase,a=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i;
j.extend(h,b,{prepareFx:function(){var b=this.node,g=this._propsData;j.each(g,function(a){a.duration=a.duration*1E3;a.delay=a.delay*1E3;if(typeof a.easing==="string")a.easing=c.toFn(a.easing)});j.each(o,function(a,c){var d,e=g[c],f;if(e){f=e.value;d={};j.each(a,function(a){d[a]=i.css(b,a)});i.css(b,c,f);j.each(d,function(a,c){c in g||(g[c]=j.merge(e,{value:i.css(b,c)}));i.css(b,c,a)});delete g[c]}});var e,d,h,l,m,p,r,u=0,q;j.isPlainObject(b)&&(u=1);for(e in g){d=g[e];h=d.value;p={isCustomFx:u,prop:e,
anim:this,fxType:d.fxType,type:d.type,propData:d};r=f.getFx(p);l=h;m=r.cur();h=h+"";q="";if(h=h.match(a)){l=parseFloat(h[2]);if((q=h[3])&&q!=="px"&&m){var s=0,t=l;do{++t;i.css(b,e,t+q);s=r.cur()}while(s===0);m=t/s*m;i.css(b,e,m+q)}h[1]&&(l=(h[1]==="-="?-1:1)*l+m)}p.from=m;p.to=l;p.unit=q;r.load(p);d.fx=r}},frame:function(){var a,b=1,c,d=this._propsData;for(a in d){c=d[a];c=c.fx;c.frame();if(this.isRejected()||this.isResolved())return;b=b&c.pos===1}d=j.now();a=this.config.duration*1E3;d=Math.max(0,
this.startTime+a-d);this.defer.notify([this,1-(d/a||0),d]);b&&this.stop(b)},doStop:function(a){var b,c=this._propsData;l.stop(this);if(a)for(b in c){a=c[b];(a=a.fx)&&a.frame(1)}},doStart:function(){l.start(this)}});h.Easing=c;h.Fx=f;return h});
/*
Copyright 2014, KISSY v1.42
MIT Licensed
build time: Feb 25 18:29
*/
KISSY.add("anim/transition",["dom","event/dom","./base"],function(g,h){function p(c){var b="";g.each(c,function(c,a){b&&(b+=",");b+=a+" "+c.duration+"s "+c.easing+" "+c.delay+"s"});return b}function k(){k.superclass.constructor.apply(this,arguments)}var i=h("dom"),m=h("event/dom"),q=h("./base"),l=g.Features,n=l.getVendorCssPropPrefix("transition"),r=/([A-Z]|^ms)/g,o=n?n.toLowerCase()+"TransitionEnd":"transitionend webkitTransitionEnd",j=l.getVendorCssPropName("transition");g.extend(k,q,{doStart:function(){var c=
this,b=c.node,d=b.style,a=c._propsData,f=d[j],e,h={};if(e=a.transform)delete a.transform,a[l.getVendorCssPropName("transform").replace(r,"-$1").toLowerCase()]=e;g.each(a,function(a,d){var e=a.value,f=i.css(b,d);"number"===typeof e&&(f=parseFloat(f));f===e&&setTimeout(function(){c._onTransitionEnd({originalEvent:{propertyName:d}})},0);h[d]=e});-1!==f.indexOf("none")?f="":f&&(f+=",");d[j]=f+p(a);m.on(b,o,c._onTransitionEnd,c);i.css(b,h)},beforeResume:function(){var c=this._propsData,b=g.merge(c),d=
this._runTime/1E3;g.each(b,function(a,b){var e=d;a.delay>=e?a.delay-=e:(e-=a.delay,a.delay=0,a.duration>=e?a.duration-=e:delete c[b])})},_onTransitionEnd:function(c){var c=c.originalEvent,b=1,d=this._propsData;d[c.propertyName]&&1!==d[c.propertyName].pos&&(d[c.propertyName].pos=1,g.each(d,function(a){if(1!==a.pos)return b=0,!1}),b&&this.stop(!0))},doStop:function(c){var b=this.node,d=b.style,a=this._propsData,f=[],e={};m.detach(b,o,this._onTransitionEnd,this);g.each(a,function(a,d){c||(e[d]=i.css(b,
d));f.push(d)});a=g.trim(d[j].replace(RegExp("(^|,)\\s*(?:"+f.join("|")+")\\s+[^,]+","gi"),"$1")).replace(/^,|,,|,$/g,"")||"none";d[j]=a;i.css(b,e)}});return k});
KISSY.add("kg/xtemplate/3.3.3/runtime",[],function(n,t,r,e){var i,a,o,s,f;i=function(n){function t(){var n="";for(var t in e)n+=t+"|";return n=n.slice(0,-1),a=new RegExp(n,"g")}var r,e={"&":"&amp;",">":"&gt;","<":"&lt;","`":"&#x60;","/":"&#x2F;",'"':"&quot;","'":"&#x27;"},i=/[&<>"'`]/,a=t(),o=/\\?\{([^{}]+)\}/g,s="undefined"!=typeof global?global:window,f=Object.prototype.toString;return n=r={isArray:Array.isArray||function(n){return"[object Array]"===f.call(n)},keys:Object.keys||function(n){var t,r=[];for(t in n)n.hasOwnProperty(t)&&r.push(t);return r},each:function(n,t,e){if(n){var i,a,o,s=0,f=n&&n.length,u=void 0===f||"[object Function]"===Object.prototype.toString.call(n);if(e=e||null,u)for(o=r.keys(n);s<o.length&&(i=o[s],t.call(e,n[i],i,n)!==!1);s++);else for(a=n[0];f>s&&t.call(e,a,s,n)!==!1;a=n[++s]);}return n},mix:function(n,t){for(var r in t)n[r]=t[r];return n},globalEval:function(n){s.execScript?s.execScript(n):!function(n){s.eval.call(s,n)}(n)},substitute:function(n,t,r){return"string"==typeof n&&t?n.replace(r||o,function(n,r){return"\\"===n.charAt(0)?n.slice(1):void 0===t[r]?"":t[r]}):n},escapeHtml:function(n){return n=""+n,i.test(n)?(n+"").replace(a,function(n){return e[n]}):n},merge:function(){for(var n=0,t=arguments.length,e={};t>n;n++){var i=arguments[n];i&&r.mix(e,i)}return e}}}(),a=function(n){function t(n,t,r){this.data=void 0!==n?n:{},r?(this.parent=r,this.root=r.root):(this.parent=void 0,this.root=this),this.affix=t||{},this.ready=!1}return t.prototype={isScope:1,constructor:t,setParent:function(n){this.parent=n,this.root=n.root},set:function(n,t){this.affix[n]=t},setData:function(n){this.data=n},getData:function(){return this.data},mix:function(n){var t=this.affix;for(var r in n)t[r]=n[r]},get:function(n){var t,r=this.data,e=this.affix;return null!=r&&(t=r[n]),void 0!==t?t:e[n]},resolveInternalOuter:function(n){var t,r=n[0],e=this,i=e;if("this"===r)t=e.data;else if("root"===r)i=i.root,t=i.data;else{if(!r)return[i.data];do t=i.get(r);while(void 0===t&&(i=i.parent))}return[void 0,t]},resolveInternal:function(n){var t=this.resolveInternalOuter(n);if(1===t.length)return t[0];var r,e=n.length,i=t[1];for(r=1;e>r;r++)i=i[n[r]];return i},resolveLooseInternal:function(n){var t=this.resolveInternalOuter(n);if(1===t.length)return t[0];var r,e=n.length,i=t[1];for(r=1;null!=i&&e>r;r++)i=i[n[r]];return i},resolveUp:function(n){return this.parent&&this.parent.resolveInternal(n)},resolveLooseUp:function(n){return this.parent&&this.parent.resolveLooseInternal(n)},resolveOuter:function(n,t){var r,e=this,i=e;if(!t&&1===n.length){if(r=e.get(n[0]),void 0!==r)return[r];t=1}if(t)for(;i&&t--;)i=i.parent;return i?[void 0,i]:[void 0]},resolveLoose:function(n,t){var r=this.resolveOuter(n,t);return 1===r.length?r[0]:r[1].resolveLooseInternal(n)},resolve:function(n,t){var r=this.resolveOuter(n,t);return 1===r.length?r[0]:r[1].resolveInternal(n)}},n=t}(),o=function(n){function t(n,t,r){this.list=n,this.init(),this.next=t,this.ready=!1,this.tpl=r}function r(n,r){var e=this;e.config=r,e.head=new t(e,void 0),e.callback=n,this.init()}var e=i;return t.prototype={constructor:t,isBuffer:1,init:function(){this.data=""},append:function(n){return this.data+=n,this},write:function(n){if(null!=n){if(n.isBuffer)return n;this.data+=n}return this},writeEscaped:function(n){if(null!=n){if(n.isBuffer)return n;this.data+=e.escapeHtml(n)}return this},insert:function(){var n=this,r=n.list,e=n.tpl,i=new t(r,n.next,e),a=new t(r,i,e);return n.next=a,n.ready=!0,a},async:function(n){var t=this.insert(),r=t.next;return n(t),r},error:function(n){var t=this.list.callback;if(t){var r=this.tpl;if(r){n instanceof Error||(n=new Error(n));var e=r.name,i=r.pos.line,a="At "+e+":"+i+": ";n.stack=a+n.stack,n.message=a+n.message,n.xtpl={pos:{line:i},name:e}}this.list.callback=null,t(n,void 0)}},end:function(){var n=this;return n.list.callback&&(n.ready=!0,n.list.flush()),n}},r.prototype={constructor:r,init:function(){this.data=""},append:function(n){this.data+=n},end:function(){this.callback(null,this.data),this.callback=null},flush:function(){for(var n=this,t=n.head;t;){if(!t.ready)return n.head=t,void 0;this.data+=t.data,t=t.next}n.end()}},r.Buffer=t,n=r}(),s=function(n){var t=a,r=i,e={range:function(n,t){var r=t.params,e=r[0],i=r[1],a=r[2];a?(e>i&&a>0||i>e&&0>a)&&(a=-a):a=e>i?-1:1;for(var o=[],s=e;i>e?i>s:s>i;s+=a)o.push(s);return o},foreach:function(n,r,e){var i,a,o,s,f=r.params,u=f[0],c=f[2]||"xindex",l=f[1];if(u)for(i=u.length,s=0;i>s;s++)a=new t(u[s],{xcount:i,xindex:s},n),o=a.affix,"xindex"!==c&&(o[c]=s,o.xindex=void 0),l&&(o[l]=u[s]),e=r.fn(a,e);return e},forin:function(n,r,e){var i,a,o,s=r.params,f=s[0],u=s[2]||"xindex",c=s[1];if(f)for(o in f)i=new t(f[o],{xindex:o},n),a=i.affix,"xindex"!==u&&(a[u]=o,a.xindex=void 0),c&&(a[c]=f[o]),e=r.fn(i,e);return e},each:function(n,t,i){var a=t.params,o=a[0];return o?r.isArray(o)?e.foreach(n,t,i):e.forin(n,t,i):i},"with":function(n,r,e){var i=r.params,a=i[0];if(a){var o=new t(a,void 0,n);e=r.fn(o,e)}return e},"if":function(n,t,r){var e=t.params,i=e[0];if(i){var a=t.fn;a&&(r=a(n,r))}else{var o=!1,s=t.elseIfs,f=t.inverse;if(s)for(var u=0,c=s.length;c>u;u++){var l=s[u];if(o=l.test(n)){r=l.fn(n,r);break}}!o&&f&&(r=f(n,r))}return r},set:function(n,t,r){return n.mix(t.hash),r},include:1,parse:1,extend:1,block:function(n,t,r){var e,i=this,a=i.runtime,o=t.params,s=o[0];2===o.length&&(e=o[0],s=o[1]);var f,u=a.blocks=a.blocks||{},c=u[s],l={fn:t.fn,type:e};if(c){if(c.type)if("append"===c.type)l.next=c,u[s]=l;else if("prepend"===c.type){var h;for(f=c;f&&"prepend"===f.type;)h=f,f=f.next;l.next=f,h.next=l}}else u[s]=l;if(!a.extendTplName)for(f=u[s];f;)f.fn&&(r=f.fn.call(i,n,r)),f=f.next;return r},macro:function(n,r,e){var i=r.hash,a=r.params,o=a[0],s=a.slice(1),f=this,u=f.runtime,c=u.macros=u.macros||{};if(r.fn)c[o]={paramNames:s,hash:i,fn:r.fn};else{var l,h=c[o],v=h.hash||{};if(h&&(l=h.paramNames)){for(var d=0,p=l.length;p>d;d++){var m=l[d];v[m]=s[d]}if(i)for(var g in i)v[g]=i[g];var x=new t(v);e=h.fn.call(f,x,e)}else{var y="can not find macro: "+name;e.error(y)}}return e}};return e["debugger"]=function(){},n=e}(),f=function(n){function t(n,t,r,e,i,a,o){this.name=n,this.originalName=a||n,this.runtime=t,this.root=r,this.pos={line:1},this.scope=e,this.buffer=i,this.fn=o}function r(n,t,r){var e=r[0],i=n&&n[e]||t&&t[e]||g[e];if(1===r.length)return i;if(i)for(var a=r.length,o=1;a>o;o++)if(i=i[r[o]],!i)return!1;return i}function e(n,t){var r=n.split("/"),e=t.split("/");r.pop();for(var i=0,a=e.length;a>i;i++){var o=e[i];"."===o||(".."===o?r.pop():r.push(o))}return r.join("/")}function f(n,t,e,i,a,o){var s,f,u;return o||(u=r(n.runtime.commands,n.root.config.commands,a)),u?u.call(n,t,e,i):u!==!1&&(s=t.resolve(a.slice(0,-1),o),f=s[a[a.length-1]])?f.apply(s,e.params):(i.error("Command Not Found: "+a.join(".")),i)}function u(n,t){var r=this;r.fn=n,r.config=p.merge(u.globalConfig,t),this.subNameResolveCache={}}function c(n,t,r){if("."!==t.charAt(0))return t;var i=r+"_ks_"+t,a=n.subNameResolveCache,o=a[i];return o?o:t=a[i]=e(r,t)}function l(n,t,r,e,i,a){var o=c(n,a,i.name),s=e.insert(),f=s.next;return v(n,o,i.runtime,t,s,a,r),f}function h(n,r,e,i,a){var o=e.insert(),s=o.next,f=new t(a.TPL_NAME,i.runtime,n,r,o,void 0,a);return o.tpl=f,d(f),s}function v(n,r,e,i,a,o,s){var f=new t(r,e,n,i,a,o);a.tpl=f,n.config.loader.load(f,function(n,t){"function"==typeof t?(f.fn=t,d(f)):n?a.error(n):t&&(s?a.writeEscaped(t):a.data+=t,a.end())})}function d(n){var t=n.fn();if(t){var r=n.runtime,e=r.extendTplName,i=r.extendTplFn;return i?(r.extendTplName=null,r.extendTplFn=null,t=h(n.root,n.scope,t,n,i)):e&&(r.extendTplName=null,t=l(n.root,n.scope,0,t,n,e)),t.end()}}var p=i,m=s,g={},x=a,y=o,b={callFn:f,callCommand:function(n,t,r,e,i){return f(n,t,r,e,i)}};return p.mix(u,{config:function(n,t){var r=this.globalConfig=this.globalConfig||{};return arguments.length?(void 0!==t?r[n]=t:p.mix(r,n),void 0):r},version:"3.3.3",nativeCommands:m,utils:b,util:p,addCommand:function(n,t){g[n]=t},removeCommand:function(n){delete g[n]}}),u.prototype={constructor:u,Scope:x,nativeCommands:m,utils:b,removeCommand:function(n){var t=this.config;t.commands&&delete t.commands[n]},addCommand:function(n,t){var r=this.config;r.commands=r.commands||{},r.commands[n]=t},include:function(n,t,r,e){var i,a=t.params;i=n;var o=t.hash,s=t&&t.escape;return o&&(i=new x(o,void 0,n)),r=l(this,i,s,r,e,a[0])},includeModule:function(n,t,r,e){var i,a=t.params;i=n;var o=t.hash;return o&&(i=new x(o,void 0,n)),r=h(this,i,r,e,a[0])},render:function(n,r,e){var i="",a=this,o=a.fn,s=a.config;"function"==typeof r&&(e=r,r=null),r=r||{},e=e||function(n,t){if(n)throw n instanceof Error||(n=new Error(n)),n;i=t};var f=a.config.name;!f&&o&&o.TPL_NAME&&(f=o.TPL_NAME);var c=new x(n),l=new u.LinkedBuffer(e,s).head,h=new t(f,{commands:r.commands},a,c,l,f,o);return l.tpl=h,o?(d(h),i):(s.loader.load(h,function(n,t){t?(h.fn=a.fn=t,d(h)):n&&l.error(n)}),i)}},u.Scope=x,u.LinkedBuffer=y,n=u}(),e.exports=f});KISSY.add("detail-model/product",function(e,t,n){var i,a=window,r=document,o=g_config["assetsHost"]=g_config["assetsHost"]||"//a.tbcdn.cn",u=o.indexOf(".daily.")!=-1;function c(e,t){var n=e.promText?2:e.limitTime&&e.start===false?1:0;var i=t.promText?2:t.limitTime&&t.start===false?1:0;if(n!=i){return n-i}return e.price-t.price}function l(e){var t,n,i=[],a;return function(r,o){if(o!==0&&!o){o=1}if(o&1&&!n){n=true;e(function(e){t=e;while(a=i.shift()){a&&a.apply(null,[t])}})}if(t!==undefined){r&&r.apply(null,[t]);return t}if(!(o&2)){r&&i.push(r)}return t}}function s(){s.superclass.constructor.apply(this,arguments);var t=this;_CTK6da3(7,"model.product.init","app.init");t.addAttr("deviceType",{value:"pc"});t.addAttr("noSkipMode",{value:false});t.addAttr("3rdExtraInfo",{value:null});t.addAttr("thirdPartyInventory",{value:null});t.addAttr("etParams",{value:null});t.addAttr("fasePushConfig",{load:function(e){try{e(_DATA_FAST_PUSH_ESI)}catch(t){e(null)}}});t.addAttr("token",{load:function(e){t.onLoad("config",function(n){if(n&&n.token){e(n.token);return}t.onToken(e)})}});t.addAttr("bucketId",{load:function(e){var n=t.getState("bucket_id");if(n){e(parseInt(n,10));return}t.onLoad("config",function(t){e(parseInt(t.bucketId||0,10))})}});t.addAttr("qrcodeUrl",{load:function(e){t.onLoad(["itemDO"],function(t){if(!t){e(null);return}e("//"+(u?"10.125.199.21":"gqrcode.alicdn.com")+"/img?v=1&type=bi&item_id="+t.itemId)})}});t.addAttr("amount",{validator:function(e){return!isNaN(e=parseInt(e,10))&&e>0},setter:function(e){return parseInt(e,10)},load:function(e){e(1);t.onLoad("config",function(t){e(t&&t.detail&&t.detail.quantityList&&t.detail.quantityList[0])})}});t.addAttr("amountMultiple",{load:function(e){e(1);t.onLoad(["config","itemDO"],function(t,n){if(t&&t.timesBuy>1){e(t.timesBuy)}else if(n&&n.timesBuy>1){e(n.timesBuy)}})}});t.addAttr("originalPrice",{load:function(e){t.onChange(["currentPriceInfoList","selectedSkuList","config"],function(t,n,i){var a={},r=true,o;if(t){for(var u in t){if((o=t[u]&&t[u].price)!==undefined){a.min=Number(o)>Number(a.min)?a.min:o;a.max=Number(o)<Number(a.max)?a.max:o;r=false}}}if(r&&n){for(var u in n){if((o=n[u]&&n[u].price)!==undefined){a.min=Number(o)>Number(a.min)?a.min:o;a.max=Number(o)<Number(a.max)?a.max:o;r=false}}}if(r&&i){if((o=i.itemDO.reservePrice||i.detail.defaultItemPrice)!==undefined){a.min=a.max=o;r=false}}if(r){a=null}else{a.str=a.min;if(a.min!=a.max){a.str+="-"+a.max}}e(a)})}});t.addAttr("buyPrice",{load:function(e){var n,i;t.onChange(["currentPriceInfoList","originalPrice","currentCycle","3rdExtraInfo","currentWrtInfo","model","deviceType"],function(n,i,a,r,o,u,c){var l=r&&r.price;if(l){return e({max:l,min:l,str:l})}var s=0,d=false,f={},m=true,p;if(a){var p=(a.bPrice/100).toFixed(2);e({max:p,min:p,str:p});return}if(o){var v=o.priceRange;if(v){var g=(v.minTotal/100).toFixed(2);var y=(v.maxTotal/100).toFixed(2);e({min:g,max:y,str:g+"-"+y})}else{e({min:o.preSellPrice,max:o.preSellPrice,str:o.preSellPrice})}return}var h=u?u.jhsDO:{};if(c=="phone"&&h&&h.activityPrice){var b=h.activityPrice;e({min:b,max:b,str:b});return}var C=function(){if(s>0||!d){return}if(m){f=i}else{f.str=f.min;if(f.min!=f.max){f.str+="-"+f.max}}e(f)};for(var I in n){s++;t.onPriceInfo(n[I],function(e){t.onPromotionList(e,function(t){var n=t&&t[0];if(n&&!n.promText&&(!n.limitTime||n.start!==false)&&(p=n.price)!==undefined){f.min=Number(p)>Number(f.min)?f.min:p;f.max=Number(p)<Number(f.max)?f.max:p;m=false}else if((p=e.price)!==undefined){f.min=Number(p)>Number(f.min)?f.min:p;f.max=Number(p)<Number(f.max)?f.max:p}s--;C()})})}d=true;C()})}});t.addAttr("promoPrice",{load:function(e){var n,i;t.onChange(["currentPriceInfoList","originalPrice"],function(n,i){var a=0,r=false,o={},u=true,c;var l=function(){if(a>0||!r){return}if(u){o=i}else{o.str=o.min;if(o.min!=o.max){o.str+="-"+o.max}}e(o)};for(var s in n){a++;t.onPriceInfo(n[s],function(e){t.onPromotionList(e,function(t){var n=t&&t[0];if(n&&!n.promText&&(c=n.price)!==undefined){o.min=Number(c)>Number(o.min)?o.min:c;o.max=Number(c)<Number(o.max)?o.max:c;u=false}else if((c=e.price)!==undefined){o.min=Number(c)>Number(o.min)?o.min:c;o.max=Number(c)<Number(o.max)?o.max:c}a--;l()})})}r=true;l()})}});t.addAttr("tagPrice",{load:function(e){t.onChange(["currentPriceInfoList","selectedSkuList"],function(t,n){var i={},a=true,r;if(t){for(var o in t){if((r=t[o]&&t[o].tagPrice)!==undefined&&r!==null){i.min=Number(r)>Number(i.min)?i.min:r;i.max=Number(r)<Number(i.max)?i.max:r;a=false}}}if(a&&n){for(var o=0,u=n.length;o<u;o++){if((r=n[o]&&n[o].tagPrice)!==undefined&&r!==null){i.min=Number(r)>Number(i.min)?i.min:r;i.max=Number(r)<Number(i.max)?i.max:r;a=false}}}if(a){i=null}else{i.str=i.min;if(i.min!=i.max){i.str+="-"+i.max}}e(i)})}});t.addAttr("interTagPrice",{load:function(e){t.onChange(["currentPriceInfoList"],function(t){var n={},i=true,a;if(t){for(var r in t){if((a=t[r]&&t[r].interTagPrice)!==undefined&&a!==null){n.min=Number(a)>Number(n.min)?n.min:a;n.max=Number(a)<Number(n.max)?n.max:a;i=false}}}if(i){n=null}else{n.str=n.min;if(n.min!=n.max){n.str+="-"+n.max}}e(n)})}});t.addAttr("interOrignPrice",{load:function(e){t.onChange(["currentPriceInfoList"],function(t){var n={},i=true,a;if(t){for(var r in t){if((a=t[r]&&t[r].interOrignPrice&&t[r].interOrignPrice.value)!==undefined&&a!==null){n.min=Number(a)>Number(n.min)?n.min:a;n.max=Number(a)<Number(n.max)?n.max:a;i=false}}}if(i){n=null}else{n.str=n.min;if(n.min!=n.max){n.str+="-"+n.max}}e(n)})}});t.addAttr("interPrice",{load:function(e){t.onLoad("priceInfo",function(t){var n={min:0,max:0,str:"0"},i={min:0,max:0,str:"0"},a={min:0,max:0,str:"0"};var r=0;for(prop in t){if(t.hasOwnProperty(prop)){var o=t[prop];if(o){if(!r){n=o.interOrignPrice;i={min:o.interTagPrice,max:o.interTagPrice};a={min:o.price,max:o.price}}var u=parseFloat(t[prop]["interTagPrice"]);if(i.min>u){i.min=t[prop]["interTagPrice"]}if(i.max<u){i.max=t[prop]["interTagPrice"]}var c=parseFloat(t[prop]["price"]);if(a.min>c){a.min=t[prop]["price"]}if(a.max<c){a.max=t[prop]["price"]}r++}}}i.str=i.min==i.max?i.min:i.min+"-"+i.max;a.str=a.min==a.max?a.min:a.min+"-"+a.max;e({interOrignPrice:n,interTagPrice:i,interPrice:a})})}});t.addAttr("servicePrice",{load:function(n){t.onChange(["selectedService","currentService","service","3rdExtraInfo"],function(t,i,a,r){var o=r&&r.servicePrice;if(o){return n({max:o,min:o,str:o})}a=i||a;var u=0;if(t&&a){e.each(a.list,function(n){var i=t[n.id];if(!i){return}if(n.uniqueServices&&n.uniqueServices.length){e.each(n.uniqueServices,function(e){if(e.uniqueId!=i){return}u+=e.price*1})}else{if(i===n.uniqueId){u+=parseFloat(n.price)}}})}n({min:u.toFixed(2),max:u.toFixed(2)})})}});t.addAttr("totalPrice",{load:function(e){t.onChange(["buyPrice","servicePrice","amount"],function(t,n,i){e({min:(t.min*1+n.min*1)*i,max:(t.max*1+n.max*1)*i})})}});t.addAttr("progressiveInfo",{load:function(n){_CTK6da3(7,"mod.progressive.load","model.product.init");t.onLoad(["model","userInfo"],function(t,i){var a=t.progressiveInfoDO;if(!a){_CTK6da3(7,"mod.progressive.null","mod.progressive.load");n(null);return}var r={extInfos:{bizType:i&&i.userId?a.tipType:0,installFee:{}},show:a.showProgressivePlan,enable:a.progressiveEnable,tryBeforeBuy:a.tryBeforeBuy,double11Privilege:a.double11Privilege,newPCInstallment:a.newPCInstallment,text:a.text};if(!r.tryBeforeBuy){e.each(a.rateMap,function(e,t){r.extInfos.installFee[t+"p"]={rate:e}})}_CTK6da3(7,"mod.progressive.success","mod.progressive.load");n(r)})}});function i(t){var n=t.FEstepCur;var i=t.wrtLevelFinalPrices.length;var a=i-n-1;var r=0;if(i>3){if(t.status==2){if(a>0){if(n===0){r=0}else{r=n-1}t.FEstepCur=n-r}else{r=i-3;t.FEstepCur=2}}else{r=0}t.wrtLevelFinalPrices=t.wrtLevelFinalPrices.slice(r,r+3);t.wrtLevelNeedCounts=t.wrtLevelNeedCounts.slice(r,r+3)}var o=t.wrtLevelNeedCounts;t.FEstepCur=0;for(var u=i-1;u>=0;u--){if(o[u]<=t.groupUC){t.FEstepCur=u;break}}if(t.status!=2)t.FEstepCur=-1;var c=[];var l=0;var s=parseInt(t.groupUC||0);var d=t.wrtLevelFinalPrices;var f=t.wrtLevelNeedCounts;e.each(d,function(e,t){var n=f[t];c[t]=[(e/100).toFixed(2),n];if(s>=n){if(t<=d.length-1){l=t}}});var m=t.giftsList;var p=[];if(m&&m.length){m.forEach(function(e){var t=e.split(",");p.push({from:t[0],to:t[1],contents:t[2]})})}t.level=l;t.priceCountArr=c;t.giftList=p;var v=t.price;var g=t.wrtLevelFinalPrices.length?t.wrtLevelFinalPrices[t.level]-v:t.finalPayment;var y=0;if(t.type===2){y=t.finalPayment}else{y=g+v}t.prePayFee=(v/100).toFixed(2);t.preSellPrice=(y/100).toFixed(2);return t}t.addAttr("currentWrtInfo",{load:function(n){t.onChange(["selectedSku","currentPriceInfo","priceInfo","itemPrice"],function(t,a,r,o){if(a){a=e.clone(a)}else{return n(null)}if(t){if(a&&a.wrtInfo){a.wrtInfo.priceRange=null;var u=a.wrtInfo;var c=u.FEstepCur<0?0:u.FEstepCur;u.FEstepCur=c;u=i(u);return n(u)}else{return n(null)}}else{var u=a.wrtInfo;if(!u){if(!o)return n(null);u=o.wanrentuanInfo}if(u){var c=u.FEstepCur<0?0:u.FEstepCur;u.FEstepCur=c;u=i(u);u.depositExpandTextBySku=null;var l={minPre:null,maxPre:null,minTotal:null,maxTotal:null,minTail:null,maxTail:null};for(var s in r){var d=r[s];var f=d.wrtInfo;if(f){f=i(f);var c=f.FEstepCur<0?0:f.FEstepCur;d.FEstepCur=c;var m=f.price;var p=f.wrtLevelFinalPrices.length?f.wrtLevelFinalPrices[c]-m:f.finalPayment;var v;if(f.type===2){v=f.finalPayment}else{v=p+m}if(!l.minTotal||v<l.minTotal){l.minTotal=v}if(!l.minPre||m<l.minPre){l.minPre=m}if(!l.minTail||p<l.minTail){l.minTail=p}if(!l.maxTotal||v>l.maxTotal){l.maxTotal=v}if(!l.maxPre||m>l.maxPre){l.maxPre=m}if(!l.maxTail||p>l.maxTail){l.maxTail=p}}}if(l.minTotal!=l.maxTotal||l.minPre!=l.maxPre){u.priceRange=l}else{u.priceRange=null}if(u.priceRange){if(l.minTotal!=l.maxTotal){u.preSellPrice=(l.minTotal/100).toFixed(2)+"-"+(l.maxTotal/100).toFixed(2)}if(l.minPre!=l.maxPre){u.prePayFee=(l.minPre/100).toFixed(2)+"-"+(l.maxPre/100).toFixed(2)}}n(u)}else{n(null)}}})}});t.addAttr("progressiveType",{load:function(e){e(t.getState("fenqi")==1?"3p":"")}});t.addAttr("currentProgressive",{load:function(e){t.onChange(["progressiveInfo","itemDO","totalPrice","progressiveType"],function(n,i,a,r){t.onProgressive(r,function(t){e(t&&t.enabled?t:null)})})}});t.addAttr("xshmPay",{load:function(e){e(0)}});t.addAttr("isOfflineShop",{load:function(e){e(window.g_config&&window.g_config.offlineShop==1)}});t.addAttr("tradeResult",{load:function(e){e(null)}});t.addAttr("config",{});t.addAttr("mdskip",{});t.addAttr("model",{load:function(n){var i;t.onLoad(["config","deviceType"],function(a,r){t.onChange("mdskip",function(o){o=o||{};var u;if(o.isSuccess){u=o["defaultModel"];if(u.tradeResult){if(e.isUndefined(u.tradeResult.tradeType)||u.tradeResult.tradeType==null){u.tradeResult.tradeType=a.tradeType}}e.log("TMLOG::detailMode:"+(i=i=="skipError"?"skipOkAfterError":"skipOk"),"info")}else{u={itemPriceResultDO:{priceInfo:{},areaId:330100,promType:t.getState("key")?1:0},userInfoDO:{},miscDO:{city:"\u676d\u5dde",cityId:"330100",region:"\u4e0a\u57ce\u533a",regionId:"330102"},gatewayDO:{},deliveryDO:{deliverySkuMap:{}}};if(r==="phone"){e.mix(u,o.defaultModel,true)}else{var c=a.renderTime||+new Date;if(!c||c<14471712e5){e.mix(u,{tradeResult:a.noSkipMode.tradeResult},true)}else{e.mix(u,a.noSkipMode,true)}}t.set("noSkipMode",true);e.log("TMLOG::detailMode:"+(i="skipError"),"info")}var l=u.tradeResult;if(l){a.tradeType=l["tradeType"]}n(u)})})}});t.addAttr("tmallCarFinantialEnable",{load:function(e){t.onChange(["mdskip"],function(t){var n=t.defaultModel;if(n){n.tradeResult=n.tradeResult||{};e&&e(n.tradeResult.tmallCarFinantialEnable)}else{e(null)}})}});t.addAttr("priceInfo",{load:function(e){t.onChange(["itemPrice"],function(t){e&&e(t?t.priceInfo||null:null)})}});t.addAttr("buyerLoc",{load:function(e){t.onLoad("model",function(t){e(t&&(t.serviceInfoDO&&t.serviceInfoDO.divisionId||t.itemPriceResultDO&&t.itemPriceResultDO.areaId||t.miscDO&&t.miscDO.cityId)||"330100")})}});t.addAttr("locModel",{load:function(n){t.onChange(["buyerLoc","deviceType"],function(i,a){if(a==="phone"){}t.onLoad(["config","gateway","model"],function(a,r,o){if(o.serviceInfoDO&&o.serviceInfoDO.divisionId==i||o.itemPriceResultDO&&o.itemPriceResultDO.areaId==i||o.miscDO&&o.miscDO.cityId==i){n({});return}t.canSoldArea(i,function(o){if(!o){return}var u=t.getState(["campaignId","abt","key"]);e.mix(u,r&&r.changeLocationGateway);if(a.changeLocationApi.indexOf("tmallBuySupport")==-1){u.tmallBuySupport=a.tradeType==2||a.tradeType==7?"true":"false"}u.ref=encodeURIComponent(document.referrer);u.areaId=i;e.use("ajax",function(e,t){_CTK6da3(7,"data.locationUrl.start","model.product.init");t.jsonp(a.changeLocationApi,u,function(e){if(e&&e.isSuccess){_CTK6da3(7,"data.locationUrl.success","data.locationUrl.start");n&&n(e&&e.defaultModel)}else{_CTK6da3(7,"data.locationUrl.error","data.locationUrl.start")}})})})})})}});t.addAttr("soldArea",{load:function(e){t.onChange("model",function(t){var n=t?t.soldAreaDataDO:null;e(n&&n.success!==false?n:null)})}});t.addAttr("amountRestrict",{load:function(e){t.onChange(["model","config"],function(t,n){e(t&&t.buyerRestrictInfoDO&&t.buyerRestrictInfoDO.amountRestrictInfoMap||null)})}});t.addAttr("sellCount",{load:function(n){e.use("dom",function(e,i){var a,r=i.get(".tm-count",".tm-ind-sellCount"),o=true;if(r&&(a=r.innerHTML)&&!/^[0\s]*$/.test(a)){n({sellCount:parseInt(a,10)});o=false}t.onChange("model",function(e){var t=e&&e.sellCountDO;t=t&&t.success!==false?t:null;if(t||o){n(t);o=false}})})}});t.addAttr("trade",{load:function(e){t.onChange(["model","config","cycle","misc"],function(t,n,i,a){var r=t&&t.tradeResult||n&&n.noSkipMode&&n.noSkipMode.tradeResult;if(r&&t&&t.miscDO&&t.miscDO.sellCountDown){if(!r.sellCountDown){r.sellCountDown=t.miscDO.sellCountDown}delete t.miscDO.sellCountDown}if(i&&r&&!r.sellCountDown&&parseInt(i.startTime,10)>parseInt(a.systemTime,10)){r.sellCountDown=Math.floor((i.startTime-a.systemTime)/1e3)}e(r&&r.success!==false?r:null)})}});t.addAttr("userInfo",{load:function(e){t.onChange("model",function(t){var n=t&&t.userInfoDO;e(n&&n.success!==false?n:null)})}});t.addAttr("isLogin",{load:function(e){t.onChange("userInfo",function(t){e(t?t.userId>0:false)})}});t.addAttr("campaignInfo",{load:function(e){t.onChange("model",function(t){var n=t&&t.campaignInfo;e(n&&n.success!==false?n:null)})}});t.addAttr("jz",{load:function(e){t.onChange("model",function(t){var n=t&&t.jzDO;if(n){n.style=t.style}e(n&&n.success!==false?n:null)})}});t.addAttr("firstSell",{load:function(e){t.onChange("model",function(t){e(t.vmarket&&t.vmarket.firstSellDO?t.vmarket&&t.vmarket.firstSellDO:null)})}});t.addAttr("secKill",{load:function(e){t.onChange("model",function(t){var n=t&&t.secKillDO;e(n&&n.success!==false?n:null)})}});t.addAttr("misc",{load:function(e){t.onLoad("cycle",function(n){t.onChange(["model"],function(t){var n=t&&t.miscDO;e(n&&n.success!==false?n:null)})})}});t.addAttr("relatedAuctions",{load:function(e){t.onChange("model",function(t){var n=t&&t.relatedAuctionsDO;e(n&&n.success!==false?n:null)})}});t.addAttr("detailPageTips",{load:function(e){t.onChange(["model","config"],function(t,n){var i=t&&t.detailPageTipsDO||n&&n.detailPageTipsDO;e(i&&i.success!==false?i:null)})}});t.addAttr("gateway",{load:function(e){t.onChange(["model","deviceType"],function(t,n){if(n==="phone"){return e({trade:{addToBuyNow:{},addToCart:{}},changeLocationGateway:t&&t.gatewayDO&&t.gatewayDO.changeLocationGateway})}var i=t&&t.gatewayDO;e(i&&i.success!==false?i:null)})}});t.addAttr("itemPrice",{load:function(e){t.onChange(["locModel","model","config"],function(t,n,i){var a=t&&t.itemPriceResultDO!==undefined&&t.itemPriceResultDO||n&&n.itemPriceResultDO||i&&i.itemPriceResultDO;e(a&&a.success!==false?a:null)})}});t.addAttr("delivery",{load:function(e){t.onChange(["locModel","model","deviceType"],function(t,n,i){var a=t&&t.deliveryDO!==undefined&&t.deliveryDO||n&&(n.deliverDO||n.deliveryDO);e(a&&a.success!==false?a:null)})}});t.addAttr("inventory",{load:function(e){t.onChange(["locModel","model"],function(t,n){var i=t&&t.inventoryDO!==undefined&&t.inventoryDO||n&&n.inventoryDO;e(i&&i.success!==false?i:null)})}});t.addAttr("servicePromise",{load:function(e){t.onChange(["locModel","model"],function(t,n){var i=t&&t.servicePromise!==undefined&&t.servicePromise||n&&n.servicePromise;e(i&&i.success!==false?i:null)})}});t.addAttr("serviceInfo",{load:function(n){t.onChange(["locModel","model"],function(i,a){if(!i&&!a)return n(null);if(!i||e.isEmptyObject(i)){i=a}var r=i.serviceInfoDO;if(r){var o=r.servicePriceMap;var u=r.serviceItemMap;if(o){e.each(o,function(t,n){e.each(t,function(n,i){var a=String(n.id);var r=u[a];if(r){var o=[];if(n.uniqueServices&&n.uniqueServices.length){e.each(n.uniqueServices,function(t,n){o.push(e.merge(t,r.uniqueServices[n]))})}n=e.merge(n,r);n.uniqueServices=o}t[i]=n});o.skuId=t})}}if(r&&r.success){t.set("cacheSelectedService",null);n(r)}else{n(null)}})}});t.addAttr("skuServiceMap",{load:function(e){t.onChange(["serviceInfo"],function(t){var n=t?t.servicePriceMap||t.skuServiceMap||null:null;e(n)})}});t.addAttr("boundsSKU",{load:function(e){var n={minPrice:null,minSkuId:null,max:null,maxSkuId:null};t.onChange(["priceInfo"],function(t){for(var i in t){var a=t[i];var r=a.promotionList;var o;if(r){r=r.sort(c);o=r[0]}var u=(o?o.price:a.price)*100;if(!n.minPrice||u<n.minPrice){n.minPrice=u;n.minSkuId=i}if(!n.maxPrice||u>n.maxPrice){n.maxPrice=u;n.maxSkuId=i}}e(n)})}});t.addAttr("currentService",{load:function(n){t.onChange(["serviceInfo","skuServiceMap","selectedSku","boundsSKU"],function(t,i,a,r){if(t){var o=e.clone(t);if(!i)return n(null);if(a){var u=a.skuId}else{var u=r.minSkuId}var c=i[u];if(c&&c.length){e.each(c,function(e){if(!e.uniqueServices||!e.uniqueServices.length){e.uniqueId="0"}});o.stype=o.serviceType;o.list=c;n(o)}else{n(null)}}else{n(null)}})}});t.addAttr("service",{load:function(n){t.onChange(["locModel","model","selectedSku"],function(t,i,a){var r=t&&t.serviceDO!==undefined?t.serviceDO:i&&i.serviceDO;var o,u={stype:null,list:[]};var c=a&&a.skuId||0;if(r&&r.success){u.stype=r["serviceType"];o=r.servicePriceMap[c];if(o){for(var l=0,s=o.length;l<s;l++){var d=e.mix({},o[l],undefined,undefined,true);var f=e.mix({},r.serviceItemMap[d.id],undefined,undefined,true);if(!f)continue;if(f.uniqueServices&&f.uniqueServices.length){for(var m=0;m<f.uniqueServices.length;m++){if(f.uniqueServices[m]["uniqueId"]in d.uniqueServices){e.mix(f.uniqueServices[m],d.uniqueServices[f.uniqueServices[m]["uniqueId"]],true)}else{f.uniqueServices.splice(m,1);m--}}if(!f.uniqueServices.length)f.uniqueServices=null}else{d.uniqueId="0"}if(d.uniqueServices)delete d.uniqueServices;e.mix(d,f,undefined,undefined,true);if(u.stype=="3c"&&d.free||u.stype=="house"&&d.autoSelect){d["selected"]=true}u.list.push(d)}}}if(u.stype=="house"&&u.list&&u.list.length==1){u.list[0].selected=u.list[0].autoSelect=true}n(u)})}});t.addAttr("memberRight",{load:function(e){t.onChange(["locModel","model"],function(t,n){var i=t&&t.memberRightDO!==undefined&&t.memberRightDO||n&&n.memberRightDO;e(i&&i.isSuccess!==false?i:null)})}});t.addAttr("memberMultiPoint",{load:function(e){t.onChange(["memberRight","boundsSKU"],function(t,n){var i=t&&t.pricePointExt;var a=n.minPrice;if(i){return e(Math.floor(a*i.pointRate/100/10))}e(null)})}});t.addAttr("breadCrumb",{load:function(e){t.onChange("Extension",function(t){var n=t&&t.breadCrumbDO;e(n&&n.success!==false?n:null)})}});t.addAttr("spuMaintainer",{load:function(e){t.onChange("Extension",function(t){var n=t&&t.spuMaintainerDO;e(n&&n.success!==false?n:null)})}});t.addAttr("tmallShopProm",{load:function(n){t.onLoad("itemPrice",function(t){var i=t&&t.tmallShopProm?t.tmallShopProm:null;var a=function(e){if(e&&e.promPlan&&e.promPlan.length){for(var t=0;t<e.promPlan.length;t++){if(e.promPlan[t].msg){e.msg=e.promPlan[t].msg}if(e.promPlan[t].detailMsg){e.promPlan=e.promPlan[t];break}}return e}};var r=function(e){if(!e||!e.promPlan||!e.promPlan.detailMsg){return false}else{return true}};if(e.isArray(i)){var o=new Array(0);for(var u=0;u<i.length;u++){o.push(a(i[u]))}n(o)}else if(e.isPlainObject(i)){var c=a(i);n(r(c)?[c]:null)}else{n(null);return}})}});t.addAttr("hasGift",{load:function(n){t.onLoad("tmallShopProm",function(t){if(!t){n(false);return}var i=[];if(e.isArray(t)){for(var a=0;a<t.length;a++){i.push(t[a].promPlan.detailMsg)}}else{i=t.promPlan.detailMsg}var r;for(var o=i.length;o--;){r=i[o];if(r.method&&r.method.giftPool&&r.method.giftPool.giftList&&r.method.giftPool.giftList.length>0){n(true);return}}n(false)})}});t.addAttr("meal",{load:function(e){t.onChange("Extension",function(t){var n=t&&t.mealResult;e(n&&n.success!==false?n:null)})}});t.addAttr("dsr",{load:function(e){t.onLoad(["shopDynamicRating","itemDO"],function(t,n){if(!t){return e(null)}var i="SM_368_dsr-"+n.userId;var a=t[i];if(a){var r=[{rate:(Math.floor(a.m*10)/10).toFixed(1),rate_title:a.m,rate_UFB:a.m_UFB,rate_g:a.m_g},{rate:(Math.floor(a.s*10)/10).toFixed(1),rate_title:a.s,rate_UFB:a.s_UFB,rate_g:a.s_g},{rate:(Math.floor(a.c*10)/10).toFixed(1),rate_title:a.c,rate_UFB:a.c_UFB,rate_g:a.c_g}];e(r)}else{e(null)}})}});t.addAttr("isDownShelf",{load:function(e){var i,a;function r(){var t=i||a;if(t!==undefined){e(t)}}t.onChange(["config"],function(e){i=e.detail.isDownShelf||!!n.get("#J_Sold-out-recommend")||n.get("#s-actionbar .buy")&&n.text("#s-actionbar .buy")=="\u5df2\u4e0b\u67b6";r()});t.onChange(["model"],function(e){a=!!(e.inventoryDO&&e.inventoryDO.totalQuantity===0);r()})}});t.addAttr("Extension",{load:function(n){t.onLoad("config",function(i){var a=i&&i.initExtensionApi;if(!a){n({});return}e.use("ajax",function(e,i){_CTK6da3(7,"data.extension.start","model.product.init");i({url:a,data:t.getState(["q","cat_id"]),dataType:"jsonp",jsonpCallback:"jsonpInitExtension",cache:true,success:function(e){if(e&&e.success){_CTK6da3(7,"data.extension.success","data.extension.start");n(e)}else{_CTK6da3(7,"data.extension.error","data.extension.start");n({})}},error:function(){_CTK6da3(7,"data.extension.error","data.extension.start")}})})})}});t.addAttr("reviewCount",{load:function(n){t.onLoad(["config","itemDO"],function(t,i){if(t&&t.detail&&t.detail.allowRate===false){n({grade:null,rateTotal:null,gradeAvg:null});return}function a(t,n){e.use("ajax",function(e,a){a({url:t,data:{itemId:i.itemId,spuId:i.spuId,sellerId:i.userId},dataType:"jsonp",success:function(e){var t=e&&e.dsr;if(t&&t.rateTotal===0&&t.gradeAvg==5){t=null}n(t)},error:function(){n(null)}})})}function r(e){if(e){_CTK6da3(7,"data.reviewCount.success","data.reviewCount.start")}else{_CTK6da3(7,"data.reviewCount.error","data.reviewCount.start")}n(e?{grade:e.gradeAvg,gradeAvg:(e.gradeAvg+"").length>2?(e.gradeAvg+"").substr(0,3):e.gradeAvg+"",rateTotal:e.rateTotal}:{grade:null,gradeAvg:null,rateTotal:null})}_CTK6da3(7,"data.reviewCount.start","model.product.init");if(t.rateConfig.rateScoreCacheDisable!==true){a("//dsr-rate."+(u?"daily.tmall.net":"tmall.com")+"/list_dsr_info.htm",function(e){if(e||t.rateConfig.rateScoreDisable===false){r(e);return}_CTK6da3(7,"data.reviewCount.again","data.reviewCount.start");a("//rate."+(u?"daily.tmall.net":"tmall.com")+"/list_dsr_info.htm",function(e){r(e)})})}})}});t.addAttr("dealChartData",{load:function(n){t.onLoad("config",function(t){if(t&&t.api.recordExtUrl){_CTK6da3(7,"mod.dealRecord.chart.start","model.product.init");e.IO({url:t.api.recordExtUrl,dataType:"jsonp",jsonpCallback:"jsonpCallback",success:function(e){_CTK6da3(7,"mod.dealRecord.chart.success","mod.dealRecord.chart.success");n(e)},error:function(){_CTK6da3(7,"mod.dealRecord.chart.failure","mod.dealRecord.chart.start");e.log("DealRecord Load Error!")}})}})}});t.addAttr("customResource",{load:function(e){t.onLoad("model",function(t){var n=t.customResourceDO;if(n&&n.customResources){return e(n.customResources)}e(null)})}});t.addAttr("activityDO",{load:function(e){t.onLoad("mdskip",function(t){e(t&&t.defaultModel&&t.defaultModel.activityDO?t.defaultModel.activityDO:null)})}});t.addAttr("cycle",{load:function(e){t.onChange("config",function(t){if(!t){e(null);return}var n=t.cyclePurchaseDO;var i=t.itemDO.reservePrice;i=i.replace(/\./,"");if(n&&n.purchaseSelected.length){n.selectedIndex=0;for(var a=0,r=n.purchaseSelected.length;a<r;a++){var o=n.purchaseSelected[a];o["totalPrice"]=o["deliveryTimes"]*parseInt(o["price"],10);o["oTotalPrice"]=i*o["deliveryTimes"];o["offPrice"]=o["oTotalPrice"]-o["totalPrice"];o["bPrice"]=n.payType==1?o["cyclePriceStep"][0]:o["totalPrice"]}}else{n=null}e(n)})}});t.addAttr("currentCycle",{load:function(e){t.onChange(["amount","cycle"],function(t,n){if(n){var i=n.selectedIndex;var a=n.purchaseSelected[i];e({payType:n.payType,selectedIndex:i,amount:t,price:a["totalPrice"]*t,bPrice:a["bPrice"]*t,itemAmount:a["deliveryTimes"]*t,buy_cycle:a["cycleId"],deliveryUnit:a["deliveryUnit"],priceStep:a["cyclePriceStep"],delivery_amount:a["deliveryId"]})}else{e(null)}})}});t.addAttr("skuMap",{load:function(n){t.onChange(["config","inventory","thirdPartyInventory"],function(i,a,r){var o=i&&i.valItemInfo&&i.valItemInfo.skuMap||null,u;if(!o||!a||(u=e.keys(o).length)===0){n(o);return}var c={},l=0;e.each(o,function(e,i){t.onInventory(e.skuId,function(t){if(!(t&&!t.quantity&&t.totalQuantity===0)){c[i]=e;l++}if(--u===0){n(c)}})})})}});t.addAttr("skuNames",{load:function(e){t.onLoad("config",function(t){return e(t&&t.valItemInfo&&t.valItemInfo.skuName||null)})}});t.addAttr("selectedSku",{load:function(n){t.onChange(["selectedSkuProp","selectedSkuList"],function(t,i){if(!i){n(null);return}var a=e.keys(i);if(a.length!=1){n(null);return}var r=a[0].split(";"),o=true;e.each(r,function(e){if(e){var n=e.split(":");if(t[n[0]]!=n[1]){o=false}}});n(o?i[a[0]]:null)})}});t.addAttr("selectedCspu",{load:function(n){t.onChange(["selectedSkuList"],function(t){var i;if(t){e.each(t,function(e){i=i||e.cspuId;if(e.cspuId&&i&&i!=e.cspuId){i=null;return false}})}n(i?{cspuId:i}:null)})}});t.addAttr("selectedSkuList",{load:function(e){t.onChange("selectedSkuProp",function(n){t.onSkuList(n,e)})}});t.addAttr("currentAmountRestrict",{load:function(n){t.onLoad(["amountRestrict","config"],function(i,a){if(!a){n(null);return}var r;if(a.cyclePurchaseDO&&(a.cyclePurchaseDO.amountLimitUp||a.cyclePurchaseDO.amountLimitDown)){r={amountLimitUp:a.cyclePurchaseDO.amountLimitUp,amountLimitDown:a.cyclePurchaseDO.amountLimitDown}}t.onChange("selectedSku",function(t){var a=t&&t.skuId||"def";var o=i&&i[a]||null;if(r){o=o&&e.mix(o,r)||r}n(o)})})}});t.addAttr("currentPriceInfoList",{load:function(n){t.onChange(["priceInfo","selectedSkuList"],function(t,i){var a=[];if(i&&t){e.each(i,function(e){if(t[e.skuId]){a.push(t[e.skuId])}})}else{e.each(t,function(e){if(e){a.push(e)}})}a=a.sort(function(e,t){var n=e.promotionList&&e.promotionList.length?0:1,i=t.promotionList&&t.promotionList.length?0:1;if(n!=i){return n-i}if(!n){var a=e.promotionList.sort(c),r=t.promotionList.sort(c),o=c(a[0],r[0]);if(o!==0){return o}return r.length-a.length}return 0});n(a)})}});t.addAttr("currentPriceInfo",{load:function(e){t.onChange("currentPriceInfoList",function(t){e(t&&t[0]||null)})}});t.addAttr("currentInventory",{load:function(e){t.onLoad("config",function(n){var i=n.detail;var a=i.isCarService;if(a){t.onChange(["3rdExtraInfo","selectedSku","inventory"],function(i,a,r){var o=i&&i.amount;if(o){e({type:r&&r.type||n&&n.valItemInfo&&n.valItemInfo["type"]||0,quantity:parseInt(o,10),totalQuantity:parseInt(o,10)})}else{t.onInventory(a&&a.skuId,e)}})}else{t.onChange(["selectedSku","inventory"],function(n){t.onInventory(n&&n.skuId,e)})}})}});t.addAttr("currentPromotion",{load:function(e){t.onChange("currentPromotionList",function(t){e(t&&t[0]||null)})}});t.addAttr("currentPromotionList",{load:function(e){t.onChange("currentPriceInfo",function(n){t.onPromotionList(n,e)})}});t.addAttr("currentSuggestivePromotionList",{load:function(e){t.onChange(["currentPriceInfo"],function(t){if(!t){e(null);return}var n=t.suggestivePromotionList;if(n){e(n.sort(c))}else{e(null)}})}});t.addAttr("suggestivePromotionPrice",{load:function(e){t.onChange(["currentPriceInfoList"],function(t){var n={},i=true,a;if(t){for(var r in t){if((a=t[r]&&t[r].suggestivePromotionList&&t[r].suggestivePromotionList[0].price)!==undefined&&a!==null){n.min=Number(a)>Number(n.min)?n.min:a;n.max=Number(a)<Number(n.max)?n.max:a;i=false}}}if(i){n=null}else{n.str=n.min;if(n.min!=n.max){n.str+="-"+n.max}}e(n)})}});t.addAttr("currentSuggestivePromotion",{load:function(e){t.onChange("currentSuggestivePromotionList",function(t){e(t&&t[0]||null)})}});t.addAttr("currentDelivery",{load:function(n){t.onChange(["delivery","service","isAreaRestricted","selectedSku"],function(t,i,a,r){var o=t&&t.deliverySkuMap;var r=r||{};var u=r.skuId?r.skuId:"default";var c={feeUnit:null,money:null,name:null,postage:"",serviceLinkText:null,serviceLinkUrl:null,signText:null,tagImage:null,type:0},l=o&&o[u]||o&&o["default"]||[c];if(a){l=[e.mix({postage:"\u6240\u9009\u533a\u57df\u6682\u4e0d\u9500\u552e\uff0c\u8bf7\u67e5\u770b\u5176\u4ed6\u533a\u57df",warning:true},c,false)]}else if(i&&i.list.length&&i["stype"]=="house"){l=[e.mix({postage:""},c,false)]}n(l)})}});t.addAttr("skuProp",{load:function(i){t.onChange(["config","skuMap"],function(t,a){var r={};if(!a){i(r);return}for(var o in a){if(!a.hasOwnProperty(o)){continue}var u=o.split(";");for(var c=0;c<u.length;c++){if(!u[c]){continue}var l=u[c].split(":");if(!l[0]||!l[1]){continue}if(!r[l[0]]){r[l[0]]={}}r[l[0]][l[1]]={label:"",text:"",info:""}}}var s=t.valItemInfo&&t.valItemInfo.salesProp||null;var d=n.query(".J_TSaleProp","#detail");e.each(d,function(t){var i=n.children(t),a=n.attr(t,"data-property");e.each(i,function(e){var t=e.getAttribute("data-value");if(!t){return}var i=t.split(":");var o=r[i[0]]&&r[i[0]][i[1]];if(!o){return}o.label=a;o.text=n.text(n.get("span",e));o.info=o.label+":"+o.text;if(s&&s[i[0]]&&s[i[0]][i[1]]){o.tip=s[i[0]][i[1]]}})});i&&i(r)})}});t.addAttr("selectedSkuProp",{load:function(n){var i=e.unparam(location.href.split("?")[1]),a;function r(e){t.onLoad("skuProp",function(t){for(var i in e){if(e.hasOwnProperty(i)){if(!t[i]||!t[i][e[i]]){delete e[i]}}}n(e)})}function o(t){if(!t){return null}var n={},i=false,a;e.each(t.split?t.split(";"):t,function(e){if(e&&(a=e.split(":"))&&a.length==2&&a[0]&&a[1]){n[a[0]]=a[1];i=true}});return i?n:null}function u(){var u=o(i["sku"]);if((a=i["sku_properties"])&&(a=o(a))){r(u?e.mix(u,a):a);return}t.onLoad("config",function(t){if((a=t&&t.valItemInfo&&t.valItemInfo["defSelected"])&&(a=o(a))){r(u?e.mix(u,a):a);return}u?r(u):n({})})}t.onChange("isDownShelf",function(e){if(e){n({})}});if(a=i["skuId"]){t.onLoad("skuMap",function(e){if(e){for(var t in e){if(e[t]["skuId"]==a){r(o(t));return}}}u()})}else{u()}}});t.addAttr("internationalComponent",{load:function(e){t.onLoad("model",function(t){e(t.internationalComponent?t.internationalComponent:null)})}});t.addAttr("selectedCarProp",{load:function(e){t.onLoad("config",function(n){if(n){if(!n.carCascade||!n.detail.isCarCascade){return e(null)}e(t.get("selectedCarProp")||null)}else{e(null)}})}});t.addAttr("skuPropSelectivity",{load:function(n){t.onChange(["locModel"],function(t){n(e.now())})}});t.addAttr("selectedSkuInfo",{load:function(n){t.onChange(["skuProp","selectedSku","selectedSkuProp"],function(i,a,r){if(a){var o=a.skuId;t.onLoad("skuMap",function(t){var n=false;for(var i in t){if(t[i]&&t[i].skuId==o){var a={};e.each(i.split(";"),function(e){if(e&&e.indexOf(":")>=0){var t=e.split(":");a[t[0]]=t[1];u(a)}});n=true;break}}if(!n){u(r)}})}else{u(r)}function u(t){var a={};e.each(t,function(e,t){var n=i[t]&&i[t][e]&&i[t][e].info;n&&(a[t+":"+e]=n)});n(a)}})}});t.addAttr("cacheSelectedService");t.set("cacheSelectedService",null);t.addAttr("selectedService",{load:function(e){t.onChange(["service","currentService","cacheSelectedService"],function(t,n,i){t=n||t;if(!t||!t.list||!t.list.length){e(null);return}var a={};var r=t.list;for(var o=0;o<r.length;o++){var u=r[o];u.id=u.id||u.serviceId;if(u.uniqueServices&&u.uniqueServices.length==1){var c=u.uniqueServices[0];if(c.autoSelect||c.free||c.isFree){if(i){var l=i[u.id];if(l&&l.checked!==false){
if(l.value==c.uniqueId){a[u.id]=c.uniqueId}}}else{a[u.id]=c.uniqueId}}else{if(i){var l=i[u.id];if(l&&l.checked===true){if(l.value==c.uniqueId){a[u.id]=c.uniqueId}}}}}else if(u.uniqueServices&&u.uniqueServices.length>1){for(var o=0,s=u.uniqueServices.length;o<s;o++){var c=u.uniqueServices[o];if(c.autoSelect||c.free||c.isFree){if(i){var l=i[u.id];if(l&&l.checked!==false){if(l.value==c.uniqueId){a[u.id]=c.uniqueId}}}else{a[u.id]=c.uniqueId}}else{if(i){var l=i[u.id];if(l&&l.checked===true){if(l.value==c.uniqueId){a[u.id]=c.uniqueId}}}}}}else{if(u.autoSelect||(u.isFree||u.free)||o===0&&t.stype=="house"){if(i){var l=i[u.id];if(l&&l.checked!==false){if(l.value==u.uniqueId){a[u.id]=u.uniqueId||"0"}}if(!l){a[u.id]=u.uniqueId||"0"}}else{a[u.id]=u.uniqueId||"0"}}else{if(i){var l=i[u.id];if(l&&l.checked===true){if(l.value==u.uniqueId){a[u.id]=u.uniqueId||"0"}}}}}}e(a)})}});t.addAttr("desc",{load:function(n){t.onLoad("config",function(t){if(t.tag.isAsynDesc!==true||!t.api||!t.api.descUrl){n("");return}var i=TShop.isHttps()?t.api.httpsDescUrl:t.api.descUrl;if(t.isTwView||t.isWorldView){i+="&_thwlang=zh_CN:TB-GBK"}e.getScript(i,{success:function(){n(window.desc||"")}})})}});t.addAttr("shopDynamicRating",{load:function(n){t.onLoad("config",function(t){if(!t||!t.apiBeans){n(null);return}e.use("ajax",function(e,i){_CTK6da3(7,"data.apiBeans.start","model.product.init");i({url:t.apiBeans,dataType:"jsonp",success:function(e){_CTK6da3(7,"data.apiBeans.success","data.apiBeans.start");n&&n(e)},error:function(){_CTK6da3(7,"data.apiBeans.error","data.apiBeans.start")}})})})}});t.addAttr("skuExtra",{load:function(e){t.onLoad("config",function(t){e(t.valItemInfo.skuExtra)})}});t.addAttr("pickupPoints",{load:function(e){t.onLoad(["config","deviceType"],function(n,i){if(i==="phone"){t.onLoad("skuExtra",function(t){var n=t.pickupPoints;if(n&&n.values&&n.values.length){e(n.values)}else{e(null)}})}else{e(n&&n.elecVoucherPickupPoint||null)}})}});t.addAttr("etm",{value:null});t.addAttr("pickupPoint",{value:""});t.addAttr("isAreaRestricted",{load:function(e){t.onChange(["currentPriceInfoList","buyerLoc","deviceType"],function(n,i,a){function r(){t.canSoldArea(i,function(n){t.onLoad("buyerLoc",function(t){if(i==t){e(!n)}})})}if(!n||!n[0]){r();return}for(var o=n.length-1;o>=0;o--){if(n[o].areaSold!==false){r();return}}e(true)})}});t.addAttr("itemDO",{load:function(e){t.onLoad("config",function(t){e(t&&t.itemDO||null)})}});t.addAttr("wtBuyParam",{value:""});t.addAttr("canBuyStatus",{load:function(e){t.onChange(["trade","selectedSku","misc","currentInventory","itemPrice","isAreaRestricted","amount","amountMultiple","selectedCarProp","selectedService","pickupPoint"],function(){var e=t.get("canBuyStatus");if(e){t.set("canBuyStatus",++e)}else{t.set("canBuyStatus",1)}})}});t.addAttr("canAddToCartStatus",{load:function(e){t.onChange(["trade","misc","currentInventory","itemPrice","isAreaRestricted","amount","pickupPoint"],function(){var e=t.get("canAddToCartStatus");if(e){t.set("canAddToCartStatus",++e)}else{t.set("canAddToCartStatus",1)}})}});t.addAttr("timeminus",{load:function(){}});t.addAttr("mainImg",{load:function(e){var t=n.get("#J_ImgBooth");e(t.src||null)}});t.addAttr("itemtitle",{load:function(e){var t=document.getElementsByTagName("title")[0];e(t.innerHTML.split("-tmall.")[0])}});t.addAttr("buyFlowFrom",{load:function(e){function t(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i");var n=window.location.search.substr(1).match(t);if(n!=null)return unescape(n[2]);return""}function n(){var e=encodeURIComponent(document.referrer);return e?e:""}var i=t("root_refer");var a=n();var r=t("u_channel");e({root_refer:i,item_url_refer:a,u_channel:r})}});t.addAttr("hotItemPhaseStep",{value:""});t.addAttr("hotItemStatus",{load:function(e){t.onChange(["itemDO","serverStartTime","hotItemPhaseStep"],function(t,n,i){if(!t.isHotItem){return e(null)}function a(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i");var n=window.location.search.substr(1).match(t);if(n!=null)return unescape(n[2]);return""}var r=2147483647;var o=a("hotItemStatus");if(o){e(o-0)}else{var u=t.preHotBeginDate;var c=t.freshBaoBeginDate;var l=t.questionBeginDate;var s=t.questionEndDate;if(u<=n&&n<c){e(0);var d=Math.abs(c-n);if(d<r){setTimeout(function(){e(1)},d)}}else if(c<=n&&n<l){e(1);var f=Math.abs(l-n)}else if(l<=n&&n<s){e(2);var m=Math.abs(s-n);if(m<r){setTimeout(function(){e(3)},m)}}else{e(3)}}})}});t.addAttr("colorSp",{load:function(t){e.ready(function(){var i=e.filter(n.query(".J_TSaleProp"),function(e){return n.hasClass(e,".tb-img")});i=i[0];var a=n.query("li",i);if(a&&a.length){var r={};a.each(function(e){r[n.attr(e,"data-value")]=n.attr(e,"title")});t(r)}else{t(null)}})}});t.addAttr("currentColorSp",{load:function(i){e.ready(function(){t.onChange(["selectedSkuProp","colorSp"],function(t,a){var r=e.filter(n.query(".J_TSaleProp"),function(e){return n.hasClass(e,".tb-img")});r=r[0];var o=n.get(".tb-selected",r);if(o){var u=n.attr(o,"data-value");i({value:u,title:a[u]})}else{i(null)}})})}});var a=window.g_config.startTime||e.now();t.addAttr("clientStartTime",{load:function(e){e(a)}});t.addAttr("serverStartTime",{load:function(e){t.onLoad("config",function(n){if(n&&n.renderTime&&parseInt(n.renderTime,10)<9999999999){return e(n.renderTime*1e3)}t.onChange(["misc"],function(n){if(n&&n.systemTime){return e(n.systemTime)}t.onLoad("clientStartTime",e)})})}});t.addAttr("minicart",{load:function(n){t.onLoad("config",function(t){if(t&&t.detail&&t.detail.isPurchaseMallVipBuyer){e.use("mui/caigou-base/minicart/index",function(e,t){n(t)})}else if(t&&t.isAliTripComDomain){e.use("travel-detail/widgets/cart/",function(e,t){n(t)})}else if(t&&t.isTripUser){e.use("mui/minicart/trip/cart",function(e,t){n(t)})}else{e.use("mui/minicart",function(e,t){n(t)})}})}});t.addAttr("comboLoc",{load:function(e){t.onLoad("buyerLoc",function(t){if(t.toString().length>6){t=t.toString().substring(0,6)}e(t)})}});t.onComboData=function(n,i,a,r){if(!n){a(null);return}function o(){e.use("malldetail/common/util",function(e,o){var u=n+"_"+i+"_"+(r?"1":"0");t._cdlm=t._cdlm||{};t._cdlm[u]=t._cdlm[u]||(t._cdlm[u]=o.createLoader(function(a){e.use("ajax",function(e,o){t.onLoad("config",function(e){o({url:e.apiTmallComboInfo,data:{areaId:n,comboId:i,noCache:r?"true":"false"},dataType:"jsonp",success:function(e){if(r&&(!e||!e.success)){return t.onComboData(n,i,a,false)}a(e&&e.success?e:null)},error:function(){if(r){return t.onComboData(n,i,a,false)}a(null)}})})})}));t._cdlm[u](a)})}i=i||"";if(!i){t["_cda"+n]=true}else{if(t["_cda"+n]){t.onComboData(n,"",function(e){if(e&&e.currentCombo&&e.currentCombo.id==i){return a(e)}o()},r);return}}o()};t.onCombo=function(n,i,a){if(!n||!i){a(null);return}e.use("malldetail/common/util",function(e,r){var o=i;t._clm=t._clm||{};t._clm[o]=t._clm[o]||(t._clm[o]=r.createLoader(function(a){e.use("detail-model/combo",function(e,r){var o=new r;o.onLogin=t.onLogin;o.set("noCache",false);o.addAttr("comboData",{load:function(e){o.onChange(["buyerLoc","noCache"],function(n,a){t.onComboData(n,i,function(t){e(t&&t.currentCombo||null)},a)})}});o.addAttr("shopId",{load:function(e){t.onChange("config",function(t){e(t&&t.rstShopId||"")})}});o.addAttr("buyerLoc",{load:function(e){e(n)}});o.addAttr("misc",{load:function(e){t.onChange("misc",e)}});o.addAttr("state",{load:function(e){t.onChange("state",e)}});o.addAttr("token",{load:function(e){t.onChange("token",e)}});o.addAttr("minicart",{load:function(e){t.onChange("minicart",e)}});o.addAttr("urlMap",{load:function(e){t.onChange("config",function(t){var n=t&&t.url;if(t.apiTmallComboItem&&n){n.apiTmallComboItem=t.apiTmallComboItem}e(n)})}});o.onTrackID=function(){return t.onTrackID.apply(t,arguments)};a(o)})}));t._clm[o](function(e){e.onLoad("buyerLoc",function(){e.set("buyerLoc",n);a(e)})})})};t.addAttr("comboData",{load:function(e){t.onLoad("config",function(n){if(!n.isTmallComboSupport||!n.apiTmallComboInfo){e(null);return}t.onChange("comboLoc",function(n){t.onComboData(n,"",e)})})}});t.addAttr("comboList",{load:function(e){t.onChange("comboData",function(t){e(t&&t.combos||null)})}});t.addAttr("currentComboId",{});t.onChange("currentComboId",function(){t.reset("currentCombo",{silent:true})});t.addAttr("currentCombo",{load:function(e){t.onChange(["comboList","currentComboId","comboLoc"],function(n,i,a){t.onCombo(a,i,e)})}});t.addAttr("recommendSku",{load:function(n){t.onLoad(["itemDO"],function(i){e.use("ajax",function(e,a){_CTK6da3(7,"data.recommendSku.start","trade.sku.init");a({url:"//fs.tmall.com/sizetools/recommandUserSize.jsonp",data:{cateId:i.categoryId,itemId:i.itemId},dataType:"jsonp",jsonpCallback:"jsonpRecommendSku",success:function(i){if(i&&i.success){if(!i.model||!i.model.recommandSize){n(null)}i.model.recommendSize=i.model.recommandSize;t.onLoad("skuProp",function(t){e.each(t,function(t,a){e.each(t,function(e,t){if(e["text"]==i.model.recommendSize){i.model.pid=a;i.model.vid=t;n(i)}})})})}else{n(null)}_CTK6da3(7,"data.recommendSku.end","data.recommendSku.start")},error:function(){_CTK6da3(7,"data.recommendSku.error","data.recommendSku.start");n(null)}})})})}});t.onChange("buyerLoc",function(e){t.reset("locModel",{silent:true})},0);t.addBuyValidator(function(e,n){t.onLoad(["trade","deviceType","model"],function(t,i,a){if(!t){return n(null)}if(i==="phone"&&a.jhsDO&&e.type===1){var r=a.jhsDO;if(r.itemStatus!==1){return n({level:8,name:"jhs",itemStatus:r.itemStatus})}return n()}if(e.type==1){return n(t.tradeEnable?null:{level:8,name:"init"})}if(e.type==2){return n(t.cartEnable?null:{level:8,name:"init"})}return n(null)})},8);t.addBuyValidator(function(e,n){t.onLoad(["config"],function(e){if(e&&e.isTwView){n(e.tradeEnable?null:{level:8,name:"isTwView"})}else{n(null)}})},8);t.addBuyValidator(function(e,n){t.onLoad(["trade"],function(e){n(e&&e.sellCountDown>0?{level:8,name:"sellCountDown"}:null)})},8);t.addBuyValidator(function(e,n){t.onLoad(["currentInventory","isAreaRestricted"],function(e,t){if(!e||t){return n()}var i=["","\u6b64\u5546\u54c1\u6682\u65f6\u7f3a\u8d27","\u6240\u9009\u533a\u57df\u6682\u65f6\u7f3a\u8d27\uff0c\u8bf7\u67e5\u770b\u5176\u4ed6\u533a\u57df","\u6709\u4eba\u8fd8\u672a\u4ed8\u6b3e\uff0c\u82e515\u5206\u949f\u540e\u4ecd\u672a\u4ed8\u6b3e\uff0c\u60a8\u5c06\u6709\u8d2d\u4e70\u673a\u4f1a"];if(e.type==3){n({level:8,name:"stock",message:i[e.type],stockType:e.type})}else if(e.quantity===0){n({level:5,name:"stock",message:i[e.type],stockType:e.type})}else{n()}})},8);t.addBuyValidator(function(e,n){if(e.type!=2){n();return}t.onLoad(["deviceType","model"],function(e,i){if(e==="phone"){n(i.jhsDO?{level:8,name:"juKey"}:null)}else{n(t.getState("key")?{level:8,name:"juKey"}:null)}})},8);t.addBuyValidator(function(e,n){if(e.type===2){t.onLoad("currentWrtInfo",function(e){if(e){return n({level:5,name:"wanrentuan"})}return n(null)})}else{if(e.type!=1){n();return}t.onLoad("currentWrtInfo",function(e){var t=e;if(t&&t.type!=2&&(t.status===0||t.status==1||t.status==3||t.status==2&&t.maxAmount!=-1&&t.maxAmount-t.purchasedAmount<=0||t.remainTime===0&&t.status==2)){n({level:5,name:"wanrentuan",wrtStatus:t.status})}else{n()}})}},5);t.addBuyValidator(function(e,n){t.onLoad(["cycle","serverStartTime"],function(e,t){if(e&&t>e.endTime){n({level:5,name:"cycle"})}else{n()}})},5);t.addBuyValidator(function(e,n){t.onLoad(["currentAmountRestrict","amount","amountMultiple","config","currentInventory","selectedSku","buyPrice"],function(e,t,i,a,r,o,u){if(!a){n();return}var c=r.quantity;var l=o?o["type"]:a.valItemInfo&&a.valItemInfo.type;if(e&&e.restrictAmount&&(e.amountCanBuy===0||t>e.amountCanBuy)){var s={1:"\u805a\u5212\u7b97\u7279\u4ef7\u5546\u54c1,\u6bcf\u4eba\u9650\u8d2d"+e.restrictAmount+"\u4ef6",2:"\u805a\u5212\u7b97\u7279\u4ef7\u5546\u54c1,\u6bcf\u4eba\u9650\u8d2d"+e.restrictAmount+"\u4ef6",3:"\u6b64\u5546\u54c1\u9650\u8d2d"+e.restrictAmount+"\u4ef6",4:"\u6bcf\u4eba\u9650\u8d2d"+e.restrictAmount+"\u4ef6\uff0c\u5df2\u8d85\u8fc7\u9650\u8d2d\u6570",5:"\u60a8\u6240\u586b\u5199\u7684\u5546\u54c1\u6570\u91cf\u8d85\u8fc7\u9650\u8d2d\u6570\u91cf\uff01"};n({level:5,name:"limitedCheck",message:s[e.restrictType]||""})}else if(e&&e.amountLimitDown&&t<e.amountLimitDown){n({level:5,name:"limitedCheck",message:"\u6b64\u5546\u54c1\u5355\u6b21\u8d2d\u4e70\u6570\u91cf\u81f3\u5c11\u4e3a"+e.amountLimitDown+"\u4ef6"})}else if(e&&e.amountLimitUp&&t>e.amountLimitUp){n({level:5,name:"limitedCheck",message:"\u6b64\u5546\u54c1\u5355\u6b21\u8d2d\u4e70\u81f3\u591a\u4e3a"+e.amountLimitUp+"\u4ef6"})}else if(typeof c=="number"&&c<t*i&&l!=3){n({level:5,name:"limitedCheck",message:"\u60a8\u6240\u586b\u5199\u7684\u5546\u54c1\u6570\u91cf\u8d85\u8fc7\u5e93\u5b58\uff01"})}else if(e&&!e.restrictAmount&&e.moneyCanBuy&&1*e.moneyCanBuy<t*i*u.max){n({level:5,name:"limitedCheck",message:"\u60a8\u6240\u586b\u5199\u7684\u5546\u54c1\u603b\u4ef7\u8d85\u8fc7\u9650\u989d\uff01"})}else{n(null)}})},5);t.addBuyValidator(function(e,n){t.onLoad(["isAreaRestricted"],function(e){n(e?{level:5,name:"areaSold",message:"\u6b64\u5546\u54c1\u4e0d\u652f\u6301\u5728\u5f53\u524d\u533a\u57df\u9500\u552e"}:undefined)})},5);t.addBuyValidator(function(n,i){t.onLoad(["skuMap","selectedSku","skuNames","selectedSkuProp"],function(t,a,r,o){if(t&&!a){var u={level:2,name:"sku",tmallCarFinantialEnable:n.tmallCarFinantialEnable};if(r){var c=[];e.each(r,function(t){var n=false;e.each(o,function(e,i){i=Number(i);if(t.id===i){n=true;return false}});if(!n){c.push(t.text)}});if(c.length){u.message="\u8bf7\u9009\u62e9"+c.join("\u3001")}}return i(u)}i()})},2);t.addBuyValidator(function(n,i){t.onLoad(["currentService","selectedService"],function(t,n){if(t){if(t.mustSelectService&&(!n||e.isEmptyObject(n))){return i({level:2,name:"sku",message:"\u8bf7\u9009\u62e9\u670d\u52a1"})}}i()})},2);t.addBuyValidator(function(e,n){t.onLoad(["etParams","config","deviceType"],function(e,t,i){if(i==="phone"){var a=t&&t.api&&t.api.appointUrl;if(a){if(!e){n({level:2,name:"sku",message:"\u6b63\u5728\u67e5\u8be2\u670d\u52a1\u95e8\u5e97\uff0c\u8bf7\u7a0d\u540e"})}else{n()}}else{n()}}else{n()}})},2);t.addBuyValidator(function(e,n){t.onLoad(["pickupPoints","pickupPoint"],function(e,t){if(e&&e.length){if(!t){return n({level:2,name:"sku",message:"\u8bf7\u9009\u62e9\u63d0\u8d27\u5730\u70b9"})}}return n()})},2);t.addBuyValidator(function(e,n){t.onLoad(["config","selectedSku","amount","currentPromotion","currentInventory","amountMultiple"],function(e,t,i,a,r,o){if(!i){n();return}i=i*o;if(i&&a&&a.limitTime){if(e.statu=="-1"){n({level:2,name:"limitPromo",message:"\u6d3b\u52a8\u5df2\u7ecf\u7ed3\u675f\uff0c\u4f60\u53ea\u80fd\u7528\u539f\u4ef7\u8d2d\u4e70\u4e86"});return}}if(e&&e.orderLimitQuantity&&i>e.orderLimitQuantity){n({level:2,name:"limitedCheck",message:"\u5f88\u62b1\u6b49\uff0c\u5f53\u524d\u53ea\u53ef\u4ee5\u8d2d\u4e70"+e.orderLimitQuantity+"\u4ef6\u5546\u54c1"});return}if(typeof r.quantity=="number"&&r.quantity<i&&r.quantity>=0&&r.type!=3){n({level:2,name:"limitedCheck",message:"\u60a8\u6240\u586b\u5199\u7684\u5546\u54c1\u6570\u91cf\u8d85\u8fc7\u5e93\u5b58\uff01"});return}n()})},2);t.addBuyValidator(function(e,t){var i=n.get("#J_Select_region");if(i&&(i.value==null||i.value=="")){t({level:2,name:"twoDimensionRegion",message:"\u8bf7\u9009\u62e9\u5546\u54c1\u5151\u6362\u5730!"})}else{t()}},2);t.addBuyValidator(function(e,n){if(e.type!=1){n();return}t.onLoad("xshmPay",function(e){if(!e){return n()}t.onChange(["progressiveInfo"],function(e){if(e){n()}else{n({level:2,name:"xshmPay",message:"\u60a8\u7684\u6388\u4fe1\u989d\u5ea6\u4e0d\u8db3"})}})})},1);if(e.Config.debug){t.on("*Change",function(t){e.log(["ModelChange:",t.attrName.join(",")])})}}e.extend(s,t);e.augment(s,{onServerTime:function(t){this.onLoad(["clientStartTime","serverStartTime"],function(n,i){t(e.now()-n+i)})},onToken:function(e){var t=this;t.onLoad("deviceType",function(t){if(t==="phone"){e()}else{var n=document,i=n.body,a="";var r="//www."+(u?"daily.":"")+window.g_config.domain+"/go/rgn/tmall/t.php?t=20121104";if(window.g_config.domain.indexOf("95095.")!=-1||window.g_config.domain.indexOf("alitrip.")!=-1){TB&&TB.Global&&TB.Global.loginStatusReady(function(t){e(t.tbToken||"")})}else{var n=document,o=n.getElementsByTagName("head")[0]||n.documentElement,c=n.createElement("script");c.src="https://www.taobao.com/go/app/tmall/login-api.php";c.async=true;function l(){var t=c.readyState;if(!t||t=="loaded"||t=="complete"){c.onreadystatechange=c.onload=null;_CTK6da3(7,"data.token.success","data.token.start");e(window.userCookie&&window.userCookie._tb_token_||"");e=null}}if("onload"in c){c.onload=l}else{c.onreadystatechange=l}setTimeout(function(){if(!e){return}_CTK6da3(7,"data.token.timeout","data.token.start");e(a);e=null},4e3);o.insertBefore(c,o.firstChild)}}})},onSkuList:function(e,t){this.onLoad(["skuMap"],function(n){var i={};if(!e||!n){t(null);return}for(var a in n){var r=true;for(var o in e){if(!e.hasOwnProperty(o)){continue}var u=new RegExp(";"+o+":"+e[o]+";");if(!u.test(a)){r=false;break}}if(r){i[a]=n[a]}}t(i)})},onPriceInfo:function(e,t){this.onLoad("priceInfo",function(n){if(typeof e=="object"){t(e);return}t(n[e||"def"])},13)},onInventory:function(e,t){var n=this;n.onLoad(["inventory","config","thirdPartyInventory"],function(n,i,a){if(i&&i.detail&&i.detail.isPurchaseMallVipBuyer){return t({type:1,quantity:1e7,totalQuantity:1e7})}var r=null;if(a&&a[e]){r=e&&a&&a[e];r.type=r.type||1}else{r=e&&n&&n.skuQuantity[e]}t({type:r?r.type:n&&n.type||i&&i.valItemInfo&&i.valItemInfo["type"]||0,quantity:r?r["quantity"]:n?n["icTotalQuantity"]:null,totalQuantity:r?r["totalQuantity"]:null})},13)},onPromotionList:function(e,t){if(!e){t(null);return}var n=e.promotionList;if(n){n=n.sort(c)}var i=e.suggestivePromotionList||null;if(i&&(i[0].promType=="jhs"||i[0].promType=="tCodeProm")){n=[i[0]].concat(n||[])}t(n||null)},clearSkuProp:function(){var e=this;e.onLoad("selectedSkuProp",function(t){e.set("selectedSkuProp",{})})},refreshCanBuyStatus:function(){var e=this;e.onLoad("canBuyStatus",function(t){e.set("canBuyStatus",++t)})},selectSkuProp:function(t,n,i){if(t.indexOf(":")>=0){var a=t.split(":",2);t=a[0];n=a[1]}var r=this;r.canSelectSkuProp(t,n,function(a){if(a<=0){if(i){r.onLoad("selectedSkuProp",function(a){var o=e.keys(a).sort();if(o[0]){r.deselectSkuProp(o[0],"",function(){r.selectSkuProp(t,n,i)})}})}return}r.onLoad("selectedSkuProp",function(i){if(i[t]==n){return}var a={};e.mix(a,i);a[t]=n;r.set("selectedSkuProp",a)})})},deselectSkuProp:function(t,n,i){if(t.indexOf(":")>=0){var a=t.split(":",2);t=a[0];n=a[1]}var r=this;r.onLoad("selectedSkuProp",function(a){if(!a[t]||n&&a[t]!=n){i&&i();return}var o={};e.each(a,function(e,n){if(n!=t){o[n]=e}});r.set("selectedSkuProp",o);i&&i()})},canSelectSkuProp:function(t,n,i,a){a=a||{};if(t.indexOf(":")>=0){var r=t.split(":",2);t=r[0];n=r[1]}if(!n){i(0);return}var o=this;function u(e){if(a.ignoreSelection){e({});return}o.onLoad("selectedSkuProp",e)}u(function(a){if(a[t]==n){i(1);return}var r=e.mix({},a);r[t]=n;o.onSkuList(r,function(t){if(!t)return;var n=e.keys(t).length;if(!n){i(-1);return}e.each(t,function(e){if(n<0){return}o.onInventory(e.skuId,function(e){if(n<0){return}if(e.type==3||e.quantity>0||e.quantity===null){i(1);n=-1;return}if(--n===0){i(0)}})})})})},selectService:function(t,n){if(!t){return}if(t.indexOf("-")>=0){var i=t.split("-",2);t=i[0];n=i[1]}n=n||"0";var a=this;a.onLoad(["cacheSelectedService","currentService"],function(i,r){i=i||{};if(i[t]&&i[t].value==n&&i[t].checked){return}var o={};e.each(i,function(e,n){if(n!=t){o[n]=e}});o[t]={key:t,value:n,checked:true};a.set("cacheSelectedService",o)})},deselectService:function(t,n,i){if(!t){return}if(t.indexOf("-")>=0){var a=t.split("-",2);t=a[0];n=a[1]}n=n||"0";var r=this;r.onLoad(["cacheSelectedService","currentService"],function(a){a=a||{};var o={};e.each(a,function(e,n){if(n!=t){o[n]=e}});o[t]={key:t,value:n,checked:false};r.set("cacheSelectedService",o);i&&i()})},canSoldArea:function(t,n,i){var a=this;var t=String(t);a.onLoad(["soldArea","config"],function(i,r){var o=i&&i.cityData;if(!o||o.allAreaSold){return n(true)}var u=o.soldAreas||[];if(e.inArray(parseInt(t,10),u)){return n(true)}var c=i&&i.regionData;var s=c.soldAreas||[];if(e.inArray(parseInt(t,10),s)){return n(true)}if(/^\d\d0000$/.test(t)){return n(!!e.filter(u,function(e){return String(e).substr(0,2)==t.substr(0,2)})[0])}if(e.inArray(parseInt(t,10),[110100,120100,310100,500100,13e4,14e4,15e4,21e4,22e4,23e4,32e4,33e4,34e4,35e4,36e4,37e4,41e4,42e4,43e4,44e4,45e4,46e4,51e4,52e4,53e4,54e4,61e4,62e4,63e4,64e4,65e4,71e4,81e4,82e4,990100])){return n(false)}if(t.length<=6){a.onAreaInfo(t,function(i){if(!i){return n(true)}if(i.level<=2){return n(false)}var o=i["parent"];a.canSoldArea(o,function(i){if(i===false){return n(i)}var u=a._cityLoadMap||(a._cityLoadMap={});u[o]=u[o]||l(function(t){var n=r.selectCityApi||"//mdskip.taobao.com/core/selectCity.htm?isAreaSell=true&itemId="+r.itemDO.itemId;if(r&&r.isAreaSell&&n){_CTK6da3(7,"data.selectCity.start","model.product.init");e.use("ajax",function(e,i){i({url:n,data:{city:o},dataType:"jsonp",jsonpCallback:"jsonpSelectCity"+o,cache:true,success:function(e){if(e.isSuccess){_CTK6da3(7,"data.selectCity.success","data.selectCity.start");t(e.selectCityDO.regionSoldArea?e.selectCityDO.regionSoldArea:null)}else{_CTK6da3(7,"data.selectCity.error","data.selectCity.start");t(null)}},timeout:10,error:function(){_CTK6da3(7,"data.selectCity.error","data.selectCity.start");t(null)}})})}else{t(null)}});u[o](function(i){if(!i||!i.soldAreas){return n(true)}return n(e.inArray(parseInt(t,10),i.soldAreas))})})});return}a.onAreaInfo(t,function(i){if(!i){return n(true)}var o=i["parent"];var u=a._areaLoadMap||(a._areaLoadMap={});u[o]=u[o]||l(function(t){var n=r.selectRegionApi;if(r.isAreaSell&&n){e.use("ajax",function(e,i){i({url:n,data:{regionId:o,areaSold:o},dataType:"jsonp",jsonpCallback:"jsonpRegion"+o,cache:true,success:function(e){if(e.isSuccess){t(e.selectRegionDO.soldAreas||null)}else{t(null)}},timeout:10,error:function(){t(null)}})})}else{t(true)}});u[o](function(i){if(!i||!i.soldAreas){return n(true)}return n(e.inArray(t,i.soldAreas))})})})},onAreaInfo:function(t,n,i){var a=this,r=a._areaMap||(a._areaMap={});if(!i&&r[t]!==undefined||r[t]&&r[t].children!==undefined){n(r[t]);return}var o=a._areaLoadMap||(a._areaLoadMap={});o[t]=o[t]||l(function(a){if(!i&&r[t]!==undefined||r[t]&&r[t].children!==undefined){n(r[t]);return}_CTK6da3(7,"data.addrlist.start","model.product.init");e.use("mui/address/queryAreaInfo",function(e,n){n.getAreaInfo({id:t,addProvs:r[1]&&r[1].children?false:true,success:function(n){_CTK6da3(7,"data.addrlist.success","data.addrlist.start");e.mix(r,n.list,true,null,true);a(r[t]||null)},error:function(){_CTK6da3(7,"data.addrlist.error","data.addrlist.start");a(r[t]||null)}})})});o[t](n)},_onCardIn:function(e,t){var n=s._cardManager;if(!n){n=s._cardManager=new window.JZ.CardManager({cardCookie:"xx1",loginCookie:"xx4",timeout:1e4})}if(n.isIn()){t()}else{n.begin(e);n.onCardIn(t)}},_onMfpIn:function(t){var n=window.g_config;function i(){var e=window.MFP.LoginPopup;if(e){e.oncallback(t);e.check({cardPSW:true})}}window.MFP?i():e.getScript(n.assetsHost+"/p/mall/jz/popup/popup.js",{success:function(){e.use("IFCLoginPopup",i)}})},onTrackID:function(t){var n=this;n.onLoad("config",function(n){var i=n.url;var r=i.mdskip?i.mdskip+"/extension/get_tb_ck_ps.htm":i.tbskip+"/json/get_tb_ck_ps.htm";e.use("cookie",function(e,n){e.getScript(r+"?varName=__BTrackID&t="+e.now(),{success:function(){t(a.__BTrackID&&a.__BTrackID.ct||n.get("t"))},error:function(){t(a.__BTrackID&&a.__BTrackID.ct||n.get("t"))},timeout:5})})})},monitorBuyServer:function(e,t,n){var i="//asyncwebserver.monitor.taobao.com/item?";var a=["src="+e,"type="+t,"rq="+encodeURIComponent(n),"t="+ +new Date];(new Image).src=i+a.join("&")},_buylogin:function(t,n){var i=this;n=n||{};if(g_config.domain.indexOf("95095.")!=-1){var r="//buy."+window.g_config.domain+"/login/buy.do?from=itemDetail&var=login_indicator&id="+n.itemId+"&shop_id="+n.shopId+"&cart_ids="}else{var r="//buy."+(u?"daily.":"")+window.g_config.domain+"/login/buy.do?from=itemDetail&var=login_indicator&id="+n.itemId+"&shop_id="+n.shopId+"&cart_ids="}e.use("cookie",function(e,o){o.remove("cookie2","");e.getScript(r+"&t="+e.now(),{success:function(){var r=a.login_indicator||{};if(r.success&&r["hasLoggedIn"]||!r.success){t(r)}else if(!r["hasLoggedIn"]){if(r.fastBuy&&n.fastBuy){t(r)}else{_CTK6da3(7,"trade.buy.login","trade.run.buyForm");i.onLogin(function(n){r.fastBuy=false;r.hasLoggedIn=true;r.success=true;if(n){e.mix(r,n)}t(r)},{check:false})}}},error:function(){t({hasLoggedIn:true,success:false,fastBuy:false})},timeout:10,charset:"gbk"})})},_buyIfc:function(t,n){var i=this;_CTK6da3(7,"trade.run.buyIfc","trade.buy.run");i._onCardIn("#J_LinkBuy",function(){i._onMfpIn(function(){i.onLoad(["config","selectedSku","selectedService","amount"],function(t,i,a,r){var o=[];if(a){e.each(a,function(e,t){o.push(t+"|"+(e||0))})}var u=[t.itemDO.itemId,r,i?i.skuId:0];if(o.length>0){u.push(o.join("-"))}location.href=t.tradeConfig[3]+"?buyer_from=ifc0001&buy_param="+u.join("_");n&&n({level:0})})})})},_buyState:function(e,t){var n=this;_CTK6da3(7,"trade.run.buyState","trade.buy.run");n.onLoad(["config","selectedSku","amount"],function(e,t,n){location.href=e.tradeConfig[4]+"&state=item_id_num:"+e.itemDO.itemId+",skuId:"+(t?t.skuId:0)+",quantity:"+n})},_buyForm:function(t,i){var o=this;var u={};_CTK6da3(7,"trade.run.buyForm","trade.buy.run");o.onLoad(["config","selectedSku","selectedService","selectedSkuInfo","etm","isOfflineShop","token","buyerLoc","selectedSkuInfo","itemPrice","gateway","secKill","userInfo","currentPromotion","amount","wtBuyParam","currentCycle","currentProgressive","xshmPay","hasGift","selectedCarProp","buyFlowFrom","pickupPoint","amountMultiple"],function(c,l,s,d,f,m,p,v,d,g,y,h,b,C,I,S,_,P,k,x,T,L,A,w){var D=n.get("#J_FrmBid"),O={},M=l?l.skuId:0;D.target="_self";function F(e,t,n){u[e]=t;if(D[e]){D[e].value=t}else{var i=n?' id="'+n+'" ':"";D.innerHTML+='<input type="hidden" name="'+e+'" value="'+t+'"'+i+">"}}var B=c.tradeParams||{};for(var K in B){var E=B[K];F(K,E)}if(c.detail&&c.detail.isPrescriptionDrug){F("cfy_detail","1")}var R=e.unparam(a.location.search.substring(1));if(R&&R["ybhpss"]){F("ybhpss",R["ybhpss"])}F("root_refer",L["root_refer"]);F("item_url_refer",L["item_url_refer"]);if(L["u_channel"]){F("umpkey",L["u_channel"])}var q=c.itemDO.quantity||"";if((!g||g.promType==1)&&C&&C.amountRestriction&&C.amountRestriction<q){q=C.amountRestriction}var j=[];if(s){e.each(s,function(e,t){j.push(t+"|"+(e||0))})}I=I*w;var N=[c.itemDO.itemId,I,M];if(j.length>0){N.push(j.join("-"))}var U=[];e.each(d,function(e){U.push(e)});if(h&&h.timeKillKeyName&&typeof h.timeKillKey!="undefined"){if(c.itemDO.isOnline&&(c.itemDO.isSecondKillFromPC||c.itemDO.isSecondKillFromPCAndWap||c.detail.timeKillAuction&&(b&&b.loginUserType))){F(h.timeKillKeyName,h.timeKillKey)}}if(y&&y.trade){for(var K in y.trade.addToBuyNow){F(K,y.trade.addToBuyNow[K])}}if(_){F("buy_cycle",_.buy_cycle);F("delivery_amount",_.delivery_amount)}var V={};var J=c&&c.carCascade;if(J&&T){T=T.split(";");T=e.map(T,function(e){return e.replace(":","_")});V.skuExtra=T}if(A){V.pickupPoint=A}if(!e.isEmptyObject(V)){var Q=e.JSON.stringify(V);F("extraAttribute",encodeURIComponent(Q))}if(S){F("wt_buy_param",S)}if(P){F("installmentPay",true);F("installmentNum",P.stages);F("installmentRate",P.rate);_CTK6da3(7,"trade.buy.progressive","trade.run.buyForm")}if(k){_CTK6da3(7,"trade.buy.xshmPay","trade.run.buyForm");F("xshmPay",k)}F("allow_quantity",q);F("buy_param",N.join("_"));F("quantity",I);F("_tb_token_",p,"J_TokenField");F("skuInfo",U.join(";"));F("use_cod","false");F("_input_charset","UTF-8");F("destination",v);F("skuId",M);F("bankfrom",o.getState("bankfrom"));F("from_etao",o.getState("frm")=="etao"?1:"");if(c.isTwView||c.isWorldView){F("buyer_from","mhw")}else{F("buyer_from",o.getState("buyer_from")||"ecity")}F("item_id_num",c.itemDO.itemId);F("item_id",c.itemDO.itemId);F("auction_id",c.itemDO.itemId);F("seller_rank","0");F("seller_rate_sum","0");F("is_orginal","no");F("point_price","false");F("secure_pay","true");F("pay_method","\u6b3e\u5230\u53d1\u8d27");F("from","item_detail");F("buy_now",c.itemDO.reservePrice);F("current_price",c.itemDO.reservePrice);F("auction_type",c.itemDO.auctionType);F("seller_num_id",c.itemDO.userId);D["strSkuId"]&&F("strSkuId",M);F("activity","");F("chargeTypeId","","J_ChargeTypeId");var z=o.getState("buytraceid");if(z)F("buytraceid",z);var G=o.getState("i_channel");if(G)F("i_channel",G);if(c.tradeType==1){F("item_url_refer",r.referrer||"OTHER")}if(g&&g.promType==1){F("key",o.getState("key"))}if(c.isHouseholdService){F("deliveryZoneCode",v)}if(f!==null){F("etm",f)}if(f===""){if(c.detail.isHkItem){D.action=c.tradeConfig[c.tradeType]}else{D.action=c.tradeConfig[1]}}else if(c.tradeType===7&&(P||k||x)){D.action=c.tradeConfig[2]}else{D.action=c.tradeConfig[c.tradeType]}var H="";var W=D.action;var $=W.indexOf("?")===-1?"?":"&";H+=$+"x-itemid="+c.itemDO.itemId;H+="&x-uid="+(b&&b.userId);D.action=W+H;var Y=a.g_aplus_pv_id;if(Y){var Z=D.action;D.action=Z+(Z.indexOf("?")===-1?"?":"&")+"spm=a220o.1000855.1.1."+Y}o._buylogin(function(a){a=a||{};if(a.success&&a.token&&a.token.length>0){var r=a.token;for(var l=0,s=r.length;l<s;l++){F(r[l][0],r[l][1])}}if(a.fastBuy){D.action=c["url"]["buyBase"]+"/fastbuy/fast_buy.htm";_CTK6da3(7,"trade.buy.fastBuy","trade.run.buyForm")}if(t.tmallCarFinantialEnable){var d=n.create('<form method="post" style="display:none"/>');document.body.appendChild(d);var f=typeof c.tradeConfig[6]==="string"?e.JSON.parse(c.tradeConfig[6]):c.tradeConfig[6];if(f.url){n.attr(d,"action",f.url);o.onLoad(["currentPriceInfo","currentPromotion","mainImg","itemtitle","currentColorSp"],function(t,i,a,r,o){function l(e,t,i){u[e]=t;var a=i?' id="'+i+'" ':"";var r=n.create('<input type="hidden" name="'+e+'" value="'+t+'"'+a+">");n.append(r,d)}for(var s in f.params){l(s,f.params[s])}var m;if(i){m=i.price}else{m=t.price}e.use("io",function(e,n){l("sku",n.serialize(D));l("key2",t.encryptDES);l("carIoc",a);l("carPrice",m);l("carColor",o.title);if(c.detail.isSavingEnergy){var i=c.api.savingEnery;d.action=i+H}d.submit()})})}}else{if(c.detail.isSavingEnergy){var m=c.api.savingEnery;D.action=m+H}var p={};if(c&&(p=c.detail)&&p.enableAliMedicalComponent&&(p.isPrescriptionDrug||p.isOtcDrug)){e.use("alijk/prescription-drug-cart/index , io",function(e,t,n){t.add(n.serialize(D))});return}D.submit()}i&&i({level:0})},{itemId:c.itemDO.itemId,shopId:c.rstShopId,fastBuy:!n.attr("#J_LinkBuy","data-noFastBuy")&&!m&&c.tradeType!=2})})},_cartMini:function(t,i){var r=this;_CTK6da3(7,"trade.run.cartMini","trade.cart.run");r.onLoad(["selectedService","selectedSku","config","token","buyerLoc","amount","campaignInfo","gateway","selectedCarProp","pickupPoint","currentProgressive","xshmPay","etm"],function(o,u,c,l,s,d,f,m,p,v,g,y,h){var b=c&&c.carCascade;var C={};if(b&&p){p=p.split(";");p=e.map(p,function(e){return e.replace(":","_")});C={skuExtra:p}}var I={};if(g){I.installmentPay=true;I.installmentNum=g.stages;I.installmentRate=g.rate;C.itemExtra=I;_CTK6da3(7,"trade.cart.progressive","trade.run.cartMini")}if(y){_CTK6da3(7,"trade.cart.xshmPay","trade.run.cartMini");I.xshmPay=true;C.itemExtra=I}if(v){C.pickupPoint=v}var S=function(){var p=[];if(o){e.each(o,function(e,t){p.push(t+"|"+(e||0))})}var v=n.attr("#J_ImgBooth","src")||"";var g=m&&m.trade&&m.trade.addToCart;if(h!==null){g.etm=h}var y={};r.onTrackID(function(o){r.onLoad(["minicart","itemDO","buyFlowFrom"],function(m,h,b){y={_tb_token_:l,anim:{img:v,startNode:t.button,endNode:n.get("#J_MiniCart")||n.get("#TMinaCart")||undefined},add:e.mix({deliveryCityCode:s,campaignId:f&&f.campaignId||r.getState("campaignId")||0,from_etao:r.getState("frm")=="etao"?1:"",tpId:r.get("tpId"),umpkey:b["u_channel"],items:[e.merge(g,{itemId:c.itemDO.itemId,skuId:u?u.skuId:0,iChannel:r.getState("i_channel")||"",quantity:d,serviceInfo:p.join("-"),extraAttribute:C})]},g)};y.tsid=o;y.itemId=h.itemId;y.sellerId=h.userId;y.categoryId=h.categoryId;y.root_refer=b["root_refer"];
y.item_url_refer=b["item_url_refer"];var I=e.unparam(a.location.search.substring(1));if(I&&I["ybhpss"]){y["extParam"]="{ybhpss:'"+I["ybhpss"]+"'}"}m.add(y,function(e){var e=e||{};if(c.isTwView||c.isWorldView){setTimeout(function(){TB.Global.tmUpdate()},1e3)}i({method:"mini",level:0,message:e.warn||"",response:e,request:y})},function(e){_CTK6da3(7,"trade.cart.error","trade.run.cartMini",{group:e.errorCode});i({method:"mini",level:-1,name:e.errorCode,message:e.error})})})})};_CTK6da3(7,"trade.cart.login","trade.run.cartMini");r.onLoad("config",function(e){if(e&&e.detail&&e.detail.isPurchaseMallVipBuyer){S();return}r._buylogin(function(e){if(e.success&&e["hasLoggedIn"]){S()}else{r.onLogin(S,{check:false})}})})})},_cartUrl:function(t,n){var i=this;_CTK6da3(7,"trade.run.cartUrl","trade.cart.run");var a=function(t,a,o){t+="&ct="+a;e.getScript(t,{success:function(){var u;if(TB&&TB.Detail){u=TB.Detail.CartResult;TB.Detail.CartResult=null;delete TB.Detail.CartResult}if("undefined"===typeof u){i.monitorBuyServer("gwc","invalid",t);n&&n({method:"obuy",trackId:a,level:-5,name:"fatalError",message:"\u65e0\u6cd5\u52a0\u8f7d\u8d2d\u7269\u8f66\u6570\u636e"});return}if(typeof u.error!=="undefined"){if("UserCartIsFull"===u.error||"TrackCartIsFull"===u.error){n&&n({method:"obuy",trackId:a,result:u,level:-2,name:u.error,message:u.error})}else{n&&n({method:"obuy",trackId:a,result:u,level:-5,name:"fatalError",message:u.error})}}else{if(o){e.use("cookie",function(e,t){var n,i;n=o+(-1===o.indexOf("?")?"?":"&")+"userid="+t.get("cookie17")+"&pre="+encodeURIComponent(r.URL);i=new Image(1,1);i.src=n.replace("{loc}","1")+"&cache="+ +new Date;i.onload=function(){i=null}})}n&&n({method:"obuy",trackId:a,result:u,level:0})}},error:function(){i.monitorBuyServer("gwc","timeout",t);n&&n({method:"obuy",trackId:a,level:-5,name:"fatalError",message:"\u63a5\u53e3\u8bbf\u95ee\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\u3002"})},timeout:10,charset:r.charset||r["characterSet"]||"gb2312"})};i.onLoad(["selectedSku","config","selectedService","buyerLoc","isOfflineShop","amount"],function(t,n,r,o,u,c){var l=t?2:1,s=n.valCartInfo||{},d=t?t.skuId:s.itemId,f=n.apiAddCart||"",m=s["dbNum"];var p=(-1===f.indexOf("?")?"?":"&")+"outer_id="+d+"&outer_id_type="+l+"&quantity="+c+"&x_id="+m;p+="&nekot="+e.now();var v=i.getState;var g=v("buytraceid");var y="&bankfrom="+v("bankfrom");if(!u&&g){g="&buytraceid="+g;y+=g}p+=y;var h=[];if(r){e.each(r,function(e,t){h.push(t+"|"+(e||0))})}p+="&serviceInfo="+h.join("-");p+="&devisionCode="+o;var b=f+p,C=s["statsUrl"];if(u){i._onCardIn("#J_LinkAdd",function(){i.onTrackID(function(e){a(b,e,C)})})}else{i.onTrackID(function(e){a(b,e,C)})}})},_mobilebuy:function(t,n){var i=this;_CTK6da3(7,"trade.run.mobilebuy","trade.mbuy.run");this.onLoad(["config","itemDO","selectedSku","selectedService","selectedSkuInfo","amount","mainImg"],function(t,a,r,o,u,c,l){var s={itemId:t.itemDO.itemId,itemImg:l.replace(/_\d{2,3}x\d{2,3}(q90)?.jpg/,"_80x80.jpg"),relEl:"#J_ImgBooth",num:c};var d=i.getState("key");if(d)s.tgKey=d;s.skuId=r?r.skuId:0;if(o){var f=[];e.each(o,function(e,t){f.push(t+"|"+e)});s.serv=f.join("-")}if(a&&a.isElecCouponItem){s.type=1}e.use("mui/mobilecross",function(e,t){t.crossBuy(s);n({level:0})})})},buy:function(t){var n=this;t=t||{};var i;if(t.type==2){_CTK6da3(7,"trade.cart.start","model.product.init");i=setTimeout(function(){_CTK6da3(7,"trade.cart.lose","trade.cart.start",{reject:"trade.cart.login"})},4096)}else if(t.type==3){_CTK6da3(7,"trade.mbuy.start","model.product.init");i=setTimeout(function(){_CTK6da3(7,"trade.mbuy.lose","trade.mbuy.start",{reject:"trade.mbuy.login"})},4096)}else if(t.type==4){_CTK6da3(7,"trade.buycar.start","model.product.init");i=setTimeout(function(){_CTK6da3(7,"trade.buycar.lose","trade.buycar.start",{reject:"trade.buycar.login"})},4096)}else{_CTK6da3(7,"trade.buy.start","model.product.init");i=setTimeout(function(){_CTK6da3(7,"trade.buy.lose","trade.buy.start",{reject:"trade.buy.login"})},4096)}function a(e){n.set("tradeResult",e);clearTimeout(i);if(t.type==2){if(e.level){_CTK6da3(7,"trade.cart.failure","trade.cart.run",{group:e.level})}else{_CTK6da3(7,"trade.cart.success","trade.cart.run")}}else if(t.type==3){if(e.level){_CTK6da3(7,"trade.mbuy.failure","trade.mbuy.run",{group:e.level})}else{_CTK6da3(7,"trade.mbuy.success","trade.mbuy.run")}}else if(t.type==4){if(e.level){_CTK6da3(7,"trade.buycar.failure","trade.buycar.run",{group:e.level})}else{_CTK6da3(7,"trade.buycar.success","trade.buycar.run")}}else{if(e.level){_CTK6da3(7,"trade.buy.failure","trade.buy.run",{group:e.level})}else{_CTK6da3(7,"trade.buy.success","trade.buy.run")}}t.callback&&t.callback(e)}n.canBuy(t,function(i){i.type=t.type||1;if(i.level>0){a(i);return}n.onLoad(["deviceType","config"],function(i,r){if(i==="phone"){if(t.type==1){n._buyInPhone(t,a)}else if(t.type==2){n._cartInPhone(t,a)}else if(t.type==3){n._chaoshiCartInPhone(t,a)}}else{if(t.type==2){_CTK6da3(7,"trade.cart.run","trade.cart.start");e.use("dom",function(e,i){var r=i.parent("#J_LinkAdd");if(r&&!i.hasClass(r,"tb-hidden")){n._cartUrl(t,a)}else{n._cartMini(t,a)}})}else if(t.type==3){_CTK6da3(7,"trade.mbuy.run","trade.mbuy.start");n._mobilebuy(t,a)}else{_CTK6da3(7,"trade.buy.run","trade.buy.start");n.onLoad(["isOfflineShop","config"],function(e,i){if(e){n._buyIfc(t,a);return}if(i.tradeType==4){n._buyState(t,a);return}n._buyForm(t,a)})}}})})},canBuy:function(e,t){e=e||{};var n=this,i=n._bvList,a={level:0,checkType:e.type};if(!i||!i.maxLevel){t&&t(a)}var r=e.level||0;function o(n){var u,c,l=false;if(n<r||a.level>=n){t&&t(a)}else if(!(u=i[n])||!(c=u.length)){o(n-1)}else{for(var s=c-1;s>=0;s--){u[s](e,function(e){if(!e){e={level:0}}if(l){return}c--;if(e.level){if(e.level>=n){t&&t(a=e);l=true;return}else if(e.level>a.level){a=e}}if(c===0){o(n-1)}})}}}o(i.maxLevel)},addBuyValidator:function(e,t){t=t||0;var n=this,i=n._bvList||(n._bvList={}),a=i[t]||(i[t]=[]);if(i.maxLevel===undefined||t>i.maxLevel){i.maxLevel=t}a.push(e)},_decisionVList:[],needDecision:function(e){var t=this;var n=t._decisionVList;var i=n.length;var a=false;function r(){for(var t=0,r=n.length;t<r;t++){n[t](function(t){if(a){return}i--;if(t){a=true;return e(true)}if(i===0){e(false)}})}}r()},needDecisionValidator:function(e){var t=this;var n=t._decisionVList;n.push(e)},canSaveSkuValidator:function(e){var t=this;t.onLoad(["skuMap","selectedSku","skuNames","selectedSkuProp","config"],function(t,n,i,a,r){if(t&&!n){return e(false)}else{e(true)}})},setBuyParam:function(e,t,n){_CTK6da3(7,"tmshop.setBuyParam","app.init");if(!e){return}n=n||0;var i=this;function a(n){i.onLoad("gateway",function(i){var a=i&&i.trade&&i.trade[n];if(t===null||t===undefined){if(a){delete a[e]}}else{if(!i.trade){i.trade={}}a=a||(i.trade[n]={});a[e]=t}})}if(n===1||n===0){a("addToBuyNow")}if(n===2||n===0){a("addToCart")}},onProgressive:function(e,t){var n={};function i(e){return(Math.floor(e*100)/100).toFixed(2)*1}function a(e){if(!n[e]){n[e]=new RegExp("^"+e+"_")}return n[e]}function r(e,t,n){return(i(e/t)+i(e*n/t)).toFixed(2)}this.onLoad(["progressiveInfo","itemDO","totalPrice"],function(n,i,a){var o,u;if(n&&(o=n.extInfos)&&o.installFee&&e&&(u=o.installFee[e])){var c=parseInt(e,10),l;l=u.rate;t({type:e,stages:c,minPrice:r(a.min,c,l),maxPrice:r(a.max,c,l),rate:l,enabled:n.enable})}else{t(null)}})},onWrtProgressive:function(e,t,n,i){var a=this;function r(e){return(Math.floor(e*100)/100).toFixed(2)*1}function o(e,t,n){return(r(e/t)+r(e*n/t)).toFixed(2)}function u(e,t,n){return(e*1+t.min*1)*n}a.onLoad(["itemPrice","servicePrice","amount"],function(a,r,c){if(a&&e&&e.status!=0){var l=e.FEstepCur==-1?0:e.FEstepCur;var s={};if(e.priceRange){var d=e.priceRange;if(d.minTail==d.maxTail){e.FEwk=(d.minTail/100).toFixed(2);s.min=s.max=u(e.FEwk,r,c)}else{s.min=u((d.minTail/100).toFixed(2),r,c);s.max=u((d.maxTail/100).toFixed(2),r,c)}}else{e.FEwk=e.wrtLevelFinalPrices.length?e.wrtLevelFinalPrices[l]-e.FEdj:e.finalPayment;if(e.depositExpandBySku){e.FEwk=e.FEwk-(e.depositExpandBySku-e.price)}s.min=s.max=u((e.FEwk/100).toFixed(2),r,c)}e.FEwk=(e.FEwk/100).toFixed(2);i({stages:t,minPrice:o(s.min,t,n),maxPrice:o(s.max,t,n),rate:n})}else{i(null)}})},getState:function(t){if(e.isArray(t)){return e.mix({},this.get("state"),undefined,t)}return(this.get("state")||{})[t]||""},safeGet:function(e){var t;var n=this;e=e.split(".");for(var i=0,a=e.length;i<a;i++){if(i===0){t=n.get(e[i])}else{t=t[e[i]]}if(typeof t==="undefined"||t===null){break}}return t}});e.mix(s,{instance:function(){return i||(i=new s)},onPriceInfo:function(){var e=s.instance();return e.onPriceInfo.apply(e,arguments)},onPromotionList:function(){var e=s.instance();return e.onPromotionList.apply(e,arguments)},clearSkuProp:function(){var e=s.instance();return e.clearSkuProp.apply(e,arguments)},refreshCanBuyStatus:function(){var e=s.instance();return e.refreshCanBuyStatus.apply(e,arguments)},selectSkuProp:function(){var e=s.instance();return e.selectSkuProp.apply(e,arguments)},deselectSkuProp:function(){var e=s.instance();return e.deselectSkuProp.apply(e,arguments)},canSelectSkuProp:function(){var e=s.instance();return e.canSelectSkuProp.apply(e,arguments)},selectService:function(){var e=s.instance();return e.selectService.apply(e,arguments)},deselectService:function(){var e=s.instance();return e.deselectService.apply(e,arguments)},onChange:function(){var e=s.instance();return e.onChange.apply(e,arguments)},onLoad:function(){var e=s.instance();return e.onLoad.apply(e,arguments)},buy:function(){var e=s.instance();return e.buy.apply(e,arguments)},canBuy:function(){var e=s.instance();return e.canBuy.apply(e,arguments)},set:function(){var e=s.instance();return e.set.apply(e,arguments)},get:function(e){var t=s.instance();t.onLoad(e);return t.get.apply(t,arguments)}});return s},{requires:["detail-model/model","dom"]});KISSY.add("detail-model/model",function(e,t,n){window._CTK6da3=window._CTK6da3||function(){var e={},t="";return function(n,o,a,i){i=i||{};if(i.reject){if(typeof i.reject!="object"){i.reject=[i.reject]}for(var r=i.reject.length-1;r>=0;r--){if(e[i.reject[r]]){return}}}if(!t){t=o}var c=(new Date).valueOf();e[o]=c;var u;if(o==t){var f=window.g_config&&g_config.startTime;u=f?c-f:0}else{u=c-(e[a||t]||e[t])}switch(i.autoGroup){case"time":i.group=i.autoGroup+"_"+(u<=0?0:Math.floor(Math.log(u)/Math.log(2)));break}if(i.group){o=o+"|"+i.group}if(typeof n=="object"){n=n[i.group||"_"]||0}var d=[],s=d&&d[Math.floor((c+288e5)/(864e5/144))%144]||1,m=Math.round(Math.max(Math.pow(2,n)*s/(undefined||8192),1/(undefined||1/16)));if(Math.floor(Math.random()*m)>0){return}var l="http://detail.tmall.com/track-2/",p=["[u"+l+"]","[t"+u+"]","[c"+function x(){return window.trackVersionDetailModel}()+"|"+o+"]","[r"+m+"]"].join("");var b="",v;try{v=/_nk_=([^;]+)/.exec(document.cookie);if(v){b=decodeURIComponent(v[1])}}catch(g){}var h="jsFeImage_"+c+"_"+Math.random(),y=window[h]=new Image;y.onload=y.onerror=function(){window[h]=null};y.src="//gm.mmstat.com/jstracker.2?"+["type=9","id=jstracker","v=0.01","nick="+encodeURIComponent(b),"islogin=0","msg="+encodeURIComponent(p),"file="+encodeURIComponent(i.dataUri||l),"line="+m,"scrolltop="+(document.documentElement&&document.documentElement.scrollTop||document.body&&document.body.scrollTop||0),"screen="+screen.width+"x"+screen.height,"t="+u].join("&");y=null}}();_CTK6da3(7,"app.init");function o(){o.superclass.constructor.apply(this,arguments);_CTK6da3(7,"app.init")}e.extend(o,t);e.augment(o,n.Target,{load:function(t,n){var o=this,a=o.getAttrs(),i=a&&a[t]&&a[t].load;var r=function(t,n){if(t===n){return true}if(typeof t!=typeof n)return false;if(typeof t=="object"){if(!(t&&n))return t===n;if(t.constructor!==n.constructor)return false;var o=true;if(e.isArray(t)){if(t.length!=n.length)return false;for(var a=0;a<t.length;++a){if(typeof t[a]!=typeof n[a]){o=false}else if(typeof t[a]=="object"){o=arguments.callee(t[a],n[a])}else{o=t[a]===n[a]}if(!o)return false}}else if(e.isObject(t)){var i=0,r=0;for(var c in t){if(t.hasOwnProperty(c)){if(typeof t[c]=="object"&&typeof n[c]=="object"){o=arguments.callee(t[c],n[c])}else{o=t[c]===n[c]}i++;if(!o)return false}}if(o){for(var c in n){if(n.hasOwnProperty(c)){r++}}if(i!=r)return false}}return o}return t===n};if(i){i(function(e){if(!r(o.get(t),e)){o.set(t,e)}},n);delete a[t].load}},onChange:function(t,n,o){var a=this;if(e.isArray(t)){var i=new Array(t.length),r;var c=function(e,t){i[t]=e;for(r=i.length-1;r>=0;r--){if(i[r]===undefined){break}}if(r<0){try{n&&n.apply(null,i)}catch(o){setTimeout(function(){throw o},0)}}};e.each(t,function(e,t){a.onChange(e,function(e){c(e,t)},o)});return}o=o!==undefined?o:1;o&&a.load(t,o);if(n){var u=a.get(t);if(u!==undefined){try{n&&n(u)}catch(f){setTimeout(function(){throw f},0)}if(o&8){return}}var d="after"+(t.charAt(0).toUpperCase()+t.substring(1))+"Change";var s=function(e){if(o&8){a.detach(d,s)}try{n&&n(e.newVal)}catch(t){setTimeout(function(){throw t},0)}};a.on(d,s);if(e.Config.debug){var m=a["__~ks_custom_events"][d].observers.length;e.log("Event:"+d+","+m);if(m>16){e.debug&&e.debug()}}}},onLoad:function(e,t,n){this.onChange(e,t,(n?n:1)|8)},onMap:function(t,n,o,a){var i=e.keys(t).length,r=e.isArray(t)?new Array(i):{};KISSY.each(t,function(e,t){e.onLoad(n,function(){r[t]=o.apply(e,arguments);if(--i===0){a(r)}})})}});return o},{requires:["base","event/custom"]});KISSY.add("malldetail/main/baseDetail",function(e){var t=window,a=t.g_config,i=a["assetsHost"]=a["assetsHost"]||"//assets.alicdn.com",n=t.location.hostname,o=a.isDaily=i.indexOf(".daily.")!=-1,r=e.startsWith(t.location.href,"https:");e.mix(TShop,{_onTMShop:TShop.createLoader(function(t){if(window.TMShop){return t(window.TMShop)}e.use("shop/app,shop/page/detail-mdv,shop/app.css,shop/page/detail-mdv.css",function(){t(window.TMShop)})}),onMdv:TShop.createLoader(function(e){TShop._onTMShop(function(t){t.onMdv(function(t){t.onProduct=TShop.onProduct;t.onDatalazyload=TShop.onDatalazyload;e(t)})})}),t:function(){return a.t},addDomainAgentCallback:function(e){if(!window.onDomainAgentChange){var t=[];window.onDomainAgentChange=function(e){for(var a=t.length-1;a>=0;a--){if(t[a](e)){return true}}return false};window.addDomainAgentCallback=function(e){t.push(e)}}window.addDomainAgentCallback(e)},isDaily:function(){return o},isHttps:function(){return r},sendImg:function(t,a){if(!t)return;var i={rn:TShop.getUrlParams("rn")};TShop.onProduct&&TShop.onProduct(function(t){t.onLoad(["itemDO","config"],function(t,a){e.mix(i,{catid:t.categoryId,itemId:t.itemId,pagetype:TShop.getPageType(),sellerId:t.userId});var n=a&&a.detail&&a.detail.abTestParam;if(n){i.abTestParam=n}})});TShop.sendImg=function(t,a){if(!t)return;var a=a||{};a=e.mix(a,i,false);if(t.indexOf("?")==-1){t+="?"+e.param(a)}else{t+="&"+e.param(a)}TShop.sendImage(t+"&_tm_cache="+e.now())};return TShop.sendImg(t,a)},getPageType:function(){var e=location.href;switch(true){case a.pageType=="temai":return a.pageType;case/spu_detail/.test(e):return"spu";case/meal_detail/.test(e):return"meal";default:return"item"}},sendImage:function(a){var i="jsFeImage_"+e.guid(),n=t[i]=new Image;n.onload=n.onerror=function(){t[i]=null};n.src=a;n=null},sendAtpanel:function(t,a,i){var n=i;if(e.isNumber(a)){n=a;a=undefined}n=0;if(n&&Math.floor(Math.random()*n)>0){return}var o="//gm.mmstat.com/"+t;TShop.sendImg(o,a)},sendAcAtpanel:function(e,t){var a="//ac.mmstat.com/"+e;TShop.sendImg(a,t)},sendErr:function(e,t){t=t||{};t.type=e;TShop.sendAtpanel("tmalldetail.15.2",t)},flush:t.CollectGarbage||function(){},throttle:function(t,a,i){var n,o=0,r=0,a=a||150;function l(){if(n){n.cancel();n=0}o=e.now();t.apply(i||this,arguments);r=e.now()}return e.mix(function(){if(!o||r>=o&&e.now()-r>a||r<o&&e.now()-o>a*8){l()}else{if(n){n.cancel()}n=e.later(l,a,0,null,arguments)}},{stop:function(){if(n){n.cancel();n=0}}})},getUrlParams:function(a){var i=TShop._urlParams||(TShop._urlParams=e.unparam(t.location.search.substring(1)));if(typeof a=="string"){return i[a]||""}else if(e.isArray(a)){return e.mix({},i,undefined,a)}else{return i}},onLogin:function(a,i){_CTKeccb(33,"login.init","app.init");var n=setTimeout(function(){_CTKeccb(33,"login.timeout","login.init");location.href="//login."+(TShop.isDaily()?"daily.taobao.net":"tmall.com")+"/?redirect_url="+encodeURIComponent(location.href)},4096);e.use("mui/minilogin",function(e,o){clearTimeout(n);if(!o._domainAgentInited){TShop.addDomainAgentCallback(function(t){var a=e.unparam(t.location.search.substring(1));if(a.type!="minilogin"){return false}try{window[a.callback](t.login_indicator);window[a.callback]=null;try{delete window[a.callback]}catch(i){}_CTKeccb(33,"login.callback","login.init")}catch(n){setTimeout(function(){throw n},0)}return true});o._domainAgentInited=true}var r="//"+t.location.host;var l="";if(e.startsWith(t.location.href,"http:")){l="http:"}if(e.startsWith(t.location.href,"https:")){l="https:"}TShop.onProduct&&TShop.onProduct(function(e){e.onLoad("config",function(e){if(e&&e.url&&e.url.xCrossServer){r=e.url.xCrossServer}})});if(!e.startsWith(r,"http:")&&!e.startsWith(r,"https:")){r=l+r}var s=e.mix({proxyURL:r+"/cross/x_cross_iframe.htm?type=minilogin&t="+TShop.t()},i);o.show(a,s)})},onIsWebpSupport:function(t){e.use("mui/datalazyload/webp",function(e,a){a.isSupport(t)})},onDatalazyload:TShop.createLoader(function(t){e.use("mui/datalazyload/index",function(e,a){var i=new a(document.body,{autoDestroy:false,diff:{top:0,bottom:10}});i.set("webpReplacer",function(e){if(/(?:taobaocdn.com|md.alicdn.com)\/.+\.(?:jpg)/.test(e)){if(!/_\.webp$/.test(e)){e+="_.webp"}}return e});t(i);TShop.afterWinLoad(function(){e.use("dom",function(e,t){i.set("diff",{top:-42,bottom:t.viewportHeight()})})})})}),addLazyCallback:function(t,a){TShop.onDatalazyload(function(i){e.use("dom",function(e,n){t=n.get(t);if(!t){return}i.addCallback(t,function(){if(n.css(t,"display")=="none"){return false}return a(t)})})})},refreshLazy:function(){TShop.onDatalazyload(function(e){e.refresh()})}});return{init:function(){}}});KISSY.add("malldetail/main/productDetail",function(e,t){var a=document,i=window,n=i.g_config,o=i.location.hostname,r,l,s,c;e.mix(TShop,{loadMdskip:function(t){_CTKeccb(33,"data.mdskip.load");setTimeout(function(){TShop.onProduct(function(e){if(!e.get("mdskip")){_CTKeccb(33,"data.mdskip.timeout","data.mdskip.load",{autoGroup:"time"});e.set("mdskip",{})}})},t.noSkipMode&&t.noSkipMode.timeout||15e3);var n=e.now();function o(t){i.onMdskip=null;c=c?c(t):function(e){e(t)};var a=e.now()-n;if(t){TShop.onProduct(function(e){e.set("timeminus",a)});_CTKeccb(33,"data.mdskip.success","data.mdskip.load",{autoGroup:"time"})}else{_CTKeccb(33,"data.mdskip.error","data.mdskip.load",{autoGroup:"time"})}}if(window.onMdskip){window.onMdskip(o);_CTKeccb(33,"data.mdskip.preload","data.mdskip.load");return}var r=TShop.getUrlParams(["ip","campaignId","key","abt","cat_id","q","u_channel","areaId"]);r.ref=encodeURIComponent(a.referrer);r.brandSiteId=t.itemDO.brandSiteId;var l=e.param(r);i.onMdskip=o;e.getScript(t.initApi+"&callback=onMdskip&"+l,{error:o})},aldPreprocess:function(t){function a(e){return((e^16386)/100).toFixed(2)}var i=-1;TShop.onProduct(function(e){e.onLoad(["config","serverStartTime"],function(e,t){var a=e.detail.recommendBigMarkDownStartTime||14498496e5;var n=e.detail.recommendBigMarkDownEndTime||1449936e6;if(t>n){i=1}else if(t>a){i=0}})});e.each(t,function(e){if(!e)return;if(i===1&&e.isTmall1111){delete e.isTmall1111}if(i===0&&e.esp!==undefined&&e.esp!==""){var t=a(e.esp);if(t*1>0){e.price=e.item_price=t}}});return t},initFoot:function(e){_CTKeccb(33,"data.config.load1","app.init")},getQrURL:function(t){var a=e.substitute("http://m.laiwang.com/market/laiwang/tmall/app-download.php?type=detail&iframe=1&key={itemId}&src=pcdetail&mmstat={mmstat}&biz=tmall",{itemId:t.itemId,mmstat:t.mmstat});return"//gcodex.alicdn.com/web/doTransit.do?url="+encodeURIComponent(a)}});return{init:function(d,m){t.init(d,m);d.product.onLogin=TShop.onLogin;l={pageStatus:0,focusTime:0,maxScrollTop:0,clickCount:0,validHits:0};r=d.product;r.set("state",TShop.getUrlParams());d.product.set("deviceType",TShop.detector.deviceType);if(o.indexOf(".tmall.")!=-1){n.domain=o.substr(o.indexOf(".tmall.")+1)}else if(o.indexOf(".taobao.")!=-1){n.domain=o.substr(o.indexOf(".taobao.")+1)}else if(o.indexOf("95095.")!=-1){n.domain=o.split(".").slice(1).join(".")}else{n.domain=a.domain.split(".").slice(-2).join(".")}try{if(n.domain.indexOf("yao.")!==-1){if(n.domain.indexOf("daily.")!==-1){a.domain="etao.net"}else{a.domain=n.domain.replace("yao.","")}}else{a.domain=n.domain}}catch(u){}e.use(["event","dom","io","malldetail/common/util"],function(e,t,o,d,m){var u=window.history;if(u&&u.replaceState){var p=location.href.split("?")[0]+"?";r.onChange("state",function(t){var a=e.keys(t);var i=[];e.each(a,function(a){if(t[a]){if(e.isArray(t[a])){e.each(t[a],function(e){i.push(a+"="+e)})}else{i.push(a+"="+t[a])}}});var n=p+i.join("&");u.replaceState(null,null,n)});r.onChange(["selectedSku","selectedSkuProp"],function(t,a){r.onLoad("state",function(i){var n=null;if(t){n=e.merge(i,{sku_properties:null,skuId:t.skuId})}else{var o=[];e.each(e.keys(a),function(e){o.push(e+":"+a[e])});n=e.merge(i,{skuId:null,sku_properties:o.join(";")})}r.set("state",n)})})}TShop.onProduct=function(e){e(r)};TShop.onMdv(function(e){e.addElement(".j-mdv")});e.ready(function(){TShop.onMdv(function(e){e.addElement(".j-mdv")})});function f(e){var t=e&&e.defaultModel&&e.defaultModel.pageJumpDO;if(t){_CTKeccb(33,"page.jump.init","app.init",{group:t.type});i.location.href=t.url;return}r.set("mdskip",e||null)}c=c?c(f):f;var v;s=(v=/sampling_v=(\d+)/.exec(location.search))&&v[1]||parseInt(Math.random()*1e4);r.set("visitStat",l);r.set("samplingVisit",s);if(l){t.on(i,"load",function(){l.pageStatus=l.pageStatus|8});var h=function(e){l.pageStatus=l.pageStatus|16;l.maxScrollTop=Math.max(l.maxScrollTop,o.scrollTop())};t.on(a,"scroll",h);t.on(a,"click",function(t){l.clickCount++;if(t&&t.target&&(e.inArray(t.target.nodeName,["A","BUTTON","INPUT","AREA"])||o.parent(t.target,"A")||o.css(t.target,"cursor")=="pointer")){l.validHits++}});var g=parseInt(n.startTime/1e3,10);var b=function(){var t=parseInt(e.now()/1e3,10);if(t<=g){return}l.focusTime+=Math.min(t-g,4)*1e3;g=t};t.on(a,"scroll click mousedown keydown mousemove",b);t.on(i,"unload",function(){h();var t=o.get("#J_Detail"),i=o.get("#J_DcTopRight"),r=o.get("#J_DcBottomRight");TShop.sendAtpanel("tmalldetail.49.3",{pageStatus:l.pageStatus,unloadTime:e.now()-n.startTime,focusTime:l.focusTime||0,descWidth:t?o.width(t):0,descHeight:t?o.height(t):0,descTop:t?parseInt(o.offset(t).top,10):0,dctrHeight:i?o.height(i):0,dctrTop:i?parseInt(o.offset(i).top,10):0,dcbrHeight:i?o.height(r):0,dcbrTop:r?parseInt(o.offset(r).top,10):0,maxScrollTop:l.maxScrollTop,clickCount:l.clickCount,validHits:l.validHits,pageWidth:o.width(a),pageHeight:o.height(a),refer:encodeURIComponent(document.referrer||"")},1e4)})}r.onLoad("config",function(t){if(t){t.newSkuRight=true;t.sizeHelperEnable=true;TShop.loadMdskip(t)}if(t.renderReq){(new Image).src=t.renderSystemServer+"/index.htm?keys="+encodeURIComponent(t.renderReq)}var a=[];if(t.valFlashUrl){a.push("malldetail/other/flashplayer")}if(t.isTmallComboSupport){a.push("malldetail/body/combo")}if(o.get("#promote")){a.push("malldetail/sku/promotion")}if(t.itemDO&&t.itemDO.tagPicUrl&&!t.itemDO.isNewProGroup){a.push("malldetail/tabbar/tabbarAttr")}if(t.itemDO&&t.itemDO.isNewProGroup){a.push("malldetail/tabbar/standardAttr")}e.use(a);r.onLoad(["isDownShelf","mdskip"],function(e){if(!e){setTimeout(function(){r.onLoad("reviewCount")},0)}});e.getScript("//g.alicdn.com/mm/cps/trace.js?t=20130926_"+n.t)})});e.use("malldetail/view/main",function(e,t){t.init(d)});TShop.afterWinLoad(function(){e.use("malldetail/common/destroy",function(e,t){t.init({product:r})})});m&&m()}}},{requires:["malldetail/main/baseDetail"]});KISSY.add("malldetail/common/template",function(e){var t={},a={"#":"start","/":"end"},i="KS_TEMPL_STAT_PARAM",l=new RegExp(i,"g"),o="KS_TEMPL",r="KS_DATA_",n="as",s='");',d=o+'.push("',m="KISSY.Template: Syntax Error. ",c="KISSY.Template: Render Error. ",u="var "+o+"=[],"+i+"=false;with(",p="||{}){try{"+o+'.push("',v='");}catch(e){'+o+'=["'+c+'" + e.message]}};return '+o+'.join("");',f=function(e){return e.replace(/\\"/g,'"')},g=function(e){return e.replace(/"/g,'\\"')},h=e.trim,_=function(t){var i,r;return g(h(t).replace(/[\r\t\n]/g," ").replace(/\\/g,"\\\\")).replace(/\{\{([#\/]?)(?!\}\})([^}]*)\}\}/g,function(t,n,m){i="";m=f(h(m));if(n){r=m.indexOf(" ");m=r===-1?[m,""]:[m.substring(0,r),m.substring(r)];var c=m[0],u,p=h(m[1]),v=b[c];if(v&&a[n]){u=v[a[n]];i=String(e.isFunction(u)?u.apply(this,p.split(/\s+/)):u.replace(l,p))}}else{i=o+".push("+"typeof ("+m+') ==="undefined"?"":'+m+");"}return s+i+d})},b={"if":{start:"if(typeof ("+i+') !=="undefined" && '+i+"){",end:"}"},"else":{start:"}else{"},elseif:{start:"}else if("+i+"){"},each:{start:function(e,t,a,i){var l="_ks_value",o="_ks_index";if(t===n&&a){l=a||l,o=i||o}return"KISSY.each("+e+", function("+l+", "+o+"){"},end:"});"},"!":{start:"/*"+i+"*/"}};function y(a){if(!t[a]){var i=e.guid(r),l,o,n=[u,i,p,o=_(a),v];try{l=new Function(i,n.join(""))}catch(c){n[3]=s+d+m+","+c.message+s+d;l=new Function(i,n.join(""))}t[a]={name:i,o:o,parser:n.join(""),render:l}}return t[a]}e.mix(y,{log:function(a){if(a in t){if("js_beautify"in window){}else{e.log(t[a].parser,"info")}}else{y(a);this.log(a)}},addStatement:function(t,a){if(e.isString(t)){b[t]=a}else{e.mix(b,t)}}});return e.Template=y});KISSY.add("malldetail/common/util",function(e,t,a){var i={};function l(e){return function(){for(var t=0;t<e.length;t++){e[t].status=2;var a,i=e[t].callbacks;while(a=i.shift()){a(e[t].getter?e[t].getter():undefined)}}}}return{createLoader:function(e){var t,a,i=[],l;return function(r,n){if(n!==0&&!n){n=1}if(n&1&&!a){a=true;e(function(e){t=e;while(l=i.shift()){l&&l.apply(null,[t])}})}if(t!==undefined){r&&r.apply(null,[t]);return t}if(!(n&2)){r&&i.push(r)}return t}},createAsyn:function(e,t){var a,i,l,r,n=[];e(function(e){i=e;while(r=n.shift()){r.handle.apply(null,[i])}},0);return function(r,o){if(o!==0&&!o){o=1}if(o&1&&!a){setTimeout(function(){if(i!==undefined){return}l=true;for(var e=0;e<n.length;e++){n[e].handle.apply(null,[i]);if(!(n[e].type&8)){n.splice(e,1);e--}}},t||200);e(null,o)}if(!r){return}if(i!==undefined||!(o&4)){e(r,o);return}if(l){r();if(o&8){e(r,o)}}else{n.push({handle:r,type:o})}}},loadAssets:function(t,a,r){if(e.isArray(t)){var n=this,o=t.length;function s(){o--;if(o==0){a&&a()}}e.each(t,function(e){n.loadAssets(e,s)});return}var d;if(r){if((d=r())!==undefined){a&&a(d);return}}t=t.replace(/^[\/\\]+/g,"").replace(/\?\?/g,"?");var c=t.split("?",2),m=c[0],u=c[1]||"",p=i[m]||(i[m]={path:m,status:0,callbacks:[],timestamp:[]});if(r){p.getter=r}if(p.status==2){a&&a(r?r():undefined);return}a&&p.callbacks.push(a);u&&p.timestamp.push(u);!p.status&&setTimeout(function(){var t={};for(var a in i){var r=i[a];if(r.status){continue}r.status=1;var n=/\.([^\.$]+)$/.exec(a),o=n&&n[1]||"js";var s=t[o]||(t[o]={items:[]});s.items.push(r)}for(var a in t){var s=t[a],d=s.items,c=window.g_config["assetsHost"]||"//assets.alicdn.com",m=[],u=[],p=undefined,v;c+="/";for(var f=0;f<d.length;f++){var h=d[f].path;if(p===undefined){p=h;v=p.length}else{while(p&&h.substring(0,v)!=p){var g=p.lastIndexOf("/",p.length-2);if(g<0){p="";break}p=p.substring(0,g+1);v=p.length}}m.push(d[f].path);u=u.concat(d[f].timestamp)}if(p&&m.length>1){c+=p+"??";for(var f=0;f<m.length;f++){m[f]=m[f].substring(v)}}else{c+="??"}c+=m.join(",");u.sort();for(var f=u.length-1;f>=0;f--){if(u[f]==u[f-1]){u.splice(f,1)}}if(u[0]){c+="?"+u.join("&")}e.getScript(c,{success:l(d),charset:"utf-8"})}},16)},initHover:function(){var e=arguments.callee._hover;if(e===undefined){if(e=arguments.callee._hover=!("ontouchstart"in document)){t.addClass("body","enableHover")}else{t.removeClass("body","enableHover")}}return e},fixHover:function(i,l,r){var n=this.initHover(),o=e.UA.ie==6;r=r||"hover";if(!n||o){l=o?"mouse":l||"click";e.each(t.query(i),function(e){if(!n||o&&e.nodeName!="A"){function i(a){t.addClass(e,r)}function s(a){if(l!="touch"&&l!="mouse"&&(a.target==e||t.contains(e,a.target))){return}t.removeClass(e,r)}if(l=="touch"){a.on(e,"touchstart",i);a.on(e,"touchend",s);t.style(e,{WebkitTouchCallout:"none"})}else if(l=="mouse"){a.on(e,"mouseenter",i);a.on(e,"mouseleave",s)}else{a.on(e,"mousedown touchstart",i);a.on(document,"mousedown touchstart",s)}}})}},bucketStat:function(t,a){var i;i=a&&a.match(/\[(.+)]/)[1].split(",");if(!i){return false}if(e.inArray(t.toString(),i)){return true}else if(i[0]=="no"){return false}else if(i[0]=="all"){return true}else{return false}},openNewSafeTab:function(e,i){var l=i?i:document.body;var r=t.create('<a target="_blank" style="display:none" href="'+e+'"></a>');t.append(r,l);a.fire(r,"click")}}},{requires:["dom","event"]});KISSY.add("malldetail/sku/buylink",function(e,t,a){function i(e){_CTKeccb(33,"trade.buylink.init","trade.main.init");e=e||{};var i=e.el,n=e.product;if(i){if(!t.get(".ensureText",i)){var o=t.create('<span class="ensureText">\u786e\u8ba4</span>');t.append(o,i)}}n.onChange("canBuyStatus",function(){n.canBuy({type:1,level:4},function(e){if(e.level>6){t.addClass(t.parent(i),"tb-hidden")}else{t.removeClass(t.parent(i),"tb-hidden");if(e.level>3){t.addClass(i,"noPost");if(e.name==="stock"){n.onLoad(["currentInventory","state","bucketId"],function(e,t,a){if(e&&e.quantity===0){TShop.sendAtpanel("tmalldetail.34.1")}})}if(e.name==="areaSold"||e.name==="stock"){n.onLoad(["currentInventory","state","bucketId"],function(e,t,a){t["areaId"]&&TShop.sendAtpanel("msearch.10.2",{areaid:t["areaId"],bucketId:a})})}if(e.name==="cycle"){t.html(i,"\u8ba2\u8d2d\u5df2\u7ed3\u675f\uff0c\u4e0b\u6b21\u65e9\u70b9\u6765\u54e6")}}else{t.removeClass(i,"noPost")}}})});a.on(i,"click",function(a){_CTKeccb(33,"trade.buylink.click","trade.buylink.init");a.preventDefault();if(t.hasClass(t.parent(a.target),"noPost"))return;TShop.sendAtpanel("tmalldetail.50.1");n.buy({type:1,button:i,callback:function(t){if(t.level){e.showMsg(t.message)}else{e.hideMsg()}}})})}return{init:i}},{requires:["dom","event"]});KISSY.add("malldetail/sku/cartlink",function(e,t,a){return{init:function(e){_CTKeccb(33,"trade.cartlink.init","trade.main.init");e=e||{};var i=e.el,n=e.product;if(i){if(!a.get(".ensureText",i)){var o=a.create('<span class="ensureText">\u786e\u8ba4</span>');a.append(o,i)}}n.onChange("canBuyStatus",function(){n.canBuy({type:2,level:4},function(e){if(e.level>6){a.addClass(a.parent(i),"tb-hidden")}else{a.removeClass(a.parent(i),"tb-hidden");if(e.level>3){a.addClass(i,"noPost")}else{a.removeClass(i,"noPost")}}})});function r(o){_CTKeccb(33,"trade.cartlink.click","trade.cartlink.init");try{o.preventDefault()}catch(l){}var s=o.target;if(s.tagName=="B"){s=a.parent(s)}if(a.hasClass(s,"noPost"))return;n.onLoad(["config","itemDO"],function(e,t){TShop.sendAtpanel("tmalljy.1.1",{shopid:e.rstShopId,itemid:t.itemId,pos:"detailclickadd"})});n.buy({type:2,button:i,callback:function(a){if(a.level){if(a.level<-3){a.message&&alert(a.message)}else if(a.method=="obuy"){switch(a.name){case"TrackCartIsFull":var i="//login."+(g_config.isDaily?"daily.taobao.net":"taobao.com")+"/member/login.jhtml?from=detail&style=simple&redirectURL="+encodeURIComponent(location.href);e.showMsg('\u60a8\u6dfb\u52a0\u7684\u5546\u54c1\u79cd\u7c7b\u5df2\u7ecf\u8fbe\u5230\u4e0a\u9650\u4e86\uff0c<a href="'+i+'">\u767b\u5f55</a>\u540e\u53ef\u7ee7\u7eed\u6dfb\u52a0');break;default:e.showMsg(a.message);break}}else if(a.method=="mini"){switch(a.name){case"BuyerNeedLogin":TShop.onLogin(function(){r(o)},{check:false});break;case"TrackCartIsFull":var n=a.message;n=n.replace(/<a\s+[^>]+>\u767b\u5f55<\/a>/,'<a class="Tms_Comm_Login" href="#">\u767b\u5f55</a>');e.showMsg(n);setTimeout(function(){t.on(".Tms_Comm_Login","click",function(e){TShop.onLogin(function(){r(e)},{check:false})})},1024);break;default:e.showMsg(a.message,"attention");break}return}if(a.name=="twoDimensionRegion"||a.name=="limitedCheck"||a.name=="limitPromo"||a.name=="stock"){e.showMsg(a.message)}else{e.hideMsg()}}else{if(a.message){e.showMsg(a.message,"attention")}else{e.hideMsg()}}}});TShop.sendAtpanel("tmalldetail.50.3")}t.on(i,"click",r)}}},{requires:["event","dom"]});KISSY.add("malldetail/sku/action",function(e,t,a,i,n){return{init:function(o){var r=o.product,l=o.el;_CTKeccb(33,"trade.action.init","trade.main.init");var s=t.get("#J_LinkBuy");if(s){i.init({el:s,showMsg:o.showMsg,hideMsg:o.hideMsg,product:r});o.onBuyEnable&&o.onBuyEnable()}else{_CTKeccb(33,"trade.main.noLinkBuy","trade.action.init")}var c=t.get("#J_LinkAdd"),d=t.get("#J_LinkBasket");if(!c||t.hasClass(t.parent(c),"tb-hidden")){t.addClass(t.parent(c),"tb-hidden");c=d}else{t.addClass(t.parent(d),"tb-hidden")}if(c){n.init({el:c,showMsg:o.showMsg,hideMsg:o.hideMsg,product:r})}else{_CTKeccb(33,"trade.main.noLinkAdd","trade.action.init")}r.onChange(["tradeResult","config"],function(a,i){if(a&&a.method=="obuy"&&a.result){e.use("malldetail/other/obuycart",function(e,n){var o=i&&i.valCartInfo&&i.valCartInfo.cartUrl,r=a.trackId;if(o){var l=["ct="+r];var s=TShop.getUrlParams("buytraceid");if(!g_config.offlineShop&&s){l.push("buytraceid="+s)}o=o+(o.indexOf("?")===-1?"?":"&")+l.join("&")}else{o="//buy."+(g_config.isDaily?"daily.taobao.net":"taobao.com")+"/auction/cart/my_cart.htm"}n.update({parentEl:t.parent(c,2),cartUrl:o,result:a.result})})}});r.onChange("canBuyStatus",function(e){r.canBuy(1,function(e){var a=t.get(".tb-action");if(e.name==="isTwView"&&e.level>=7){t.text(a,"\u672c\u5546\u54c1\u4e0d\u652f\u6301\u672c\u5340\u57df\u92b7\u552e");t.addClass(a,"tm-tw-cannotbuy")}})});var m;r.onChange("currentInventory",function(e){if(e.type==3){if(!m){t.append(m=t.create('<span class="tm-change-left">\u8fd8\u6709\u673a\u4f1a</span>'),l)}t.show(m)}else{m&&t.hide(m)}});r.onLoad("tmallCarFinantialEnable",function(a){if(a){e.use("malldetail/sku/buycar",function(e,a){a.init({relEl:t.parent(s,".tb-btn-sku"),showMsg:o.showMsg,hideMsg:o.hideMsg})})}});var u=false,f=false;r.onChange("tradeResult",function(a){t.removeClass(e.query("a.tb-act",l),"tb-act");t.removeClass(e.query("a.tb-btn-inbox",l),"tb-btn-inbox");if(a&&a.level>0&&a.name=="sku"){f=true;if(a.type==1&&!a.tmallCarFinantialEnable){t.addClass(s,"tb-act")}if(a.type==1&&a.tmallCarFinantialEnable){t.addClass("#J_LinkBuyCar","tb-act")}if(a.type==2){t.addClass(c,"tb-act")}if(!u){u=true;r.onChange("canBuyStatus",function(){if(f){var a=t.query("a.tb-act",l);e.each(a,function(e){r.canBuy({type:e.id==="J_LinkBuy"?1:2},function(e){if(e.level>0&&e.name=="sku"){t.removeClass(a,"tb-btn-inbox")}else{t.addClass(a,"tb-btn-inbox")}})})}});_CTKeccb(33,"trade.sku.attention","trade.action.init")}}else{f=false}});var p;r.onChange(["trade","itemPrice","itemDO"],function(i,n,o){if(i&&i.sellCountDown>0&&(!n||!n["wanrentuanInfo"])){if(!p){p=t.create(""+'<div class="tm-countdown">'+'<div class="tb-btn-wait">\u5373\u5c06\u5f00\u59cb &middot; &middot; &middot; </div>'+'<div class="tm-countdown-notice">\u8ddd\u5f00\u552e \u8fd8\u5269<div class="tm-countdown-timer"></div></div>'+"</div>"+"");var s=t.get(".tm-countdown-notice",p);if(i.tradeDisableTypeEnum==8){r.onLoad("qrcodeUrl",function(e){if(!e){return}t.css(s,{clear:"both"});t.append(t.create('\uff0c\u624b\u673a\u96f6\u70b9\u63d0\u524d\u5f00\u552e\uff0c\u626b\u7801\u62a2\u5148\u8d2d&gt;<img class="tm-countdown-qrcode" src="'+e+'&w=70&h=70"/>'),s)})}else if(location.href.indexOf("95095.")===-1){if(i.tradeDisableTypeEnum===13){t.append(t.create('\uff0c\u70b9\u51fb<a href="#" class="reserve">\u8bbe\u7f6e\u5f00\u62a2\u63d0\u9192</a>'),s);a.on(t.get(".reserve",s),"click",function(t){t.halt(true);e.use(["mui/reserve-3c/index","mui/reserve-3c/index.css"],function(e,t){TShop.onLogin(function(){r.onLoad("token",function(e){var a=new t("#J_Reserve",{reserveId:i.remindId,source:"pc",from:"detail",isMobile:false});a.getReserve(e)})})})})}else{t.append(t.create('\uff0c\u8bf7\u5148<a href="#" class="addfav">\u6536\u85cf\u5546\u54c1</a>'),s);a.on(t.get(".addfav",s),"click",function(t){t.preventDefault();e.use("malldetail/action/addfav",function(e,a){TShop.onLogin(function(){r.onLoad(["itemDO","token"],function(e,i){a.run({itemId:e.itemId,sellerId:e.userId,categoryId:e.categoryId,token:i,event:t})})})})})}}e.use("malldetail/control/timer",function(e,a){new a({leftTime:i.sellCountDown,container:t.get(".tm-countdown-timer",p),template:2,tpl:"{date}"}).onStop(function(){r.set("trade.sellCountDown",0);_CTKeccb(33,"trade.timer.stop","trade.timer.init")});_CTKeccb(33,"trade.timer.init","trade.action.init")})}t.hide(l);t.insertAfter(p,l)}else{if(p){t.remove(p)}if(!o.isHotItem){t.show(l)}}});var v;r.onLoad(["trade","misc","deviceType"],function(a,i,n){function o(e){if(!v){v=t.create('<div id="J_ButtonWaitWrap"></div>');t.insertAfter(v,l)}t.html(v,e);t.show(v);if(n=="pad"){var a=t.get("#J_AddFavorite");t.hide(a)}}function s(){v&&t.hide(v)}var c=a&&!a.tradeEnable&&a.tradeDisableTypeEnum;if(!c){s();return}e.use("malldetail/sku/tradeArgue",function(e,t){t.init({typeNum:c,trade:a,show:o,hide:s,product:r})})});r.onLoad(["deviceType"],function(a){if(a==="pc"){var i=null,n=false;r.onChange("canBuyStatus",function(){r.canBuy({type:g_config&&g_config.pageId==="chaoshi"?2:1,level:4},function(a){if(a.level===0){if(n){i&&i.show()}else{n=true;r.onLoad("memberMultiPoint",function(a){var n=TShop.getUrlParams("memberMultiPoint");if(n){a=n}if(a){var o=t.create('<div class="tm-btn-wrap"></div>');t.append(t.parent(s),o);t.append(t.parent(d),o);var l=t.get(".tb-action");t.append(o,l);t.addClass(l,"tb-action-vertical");e.use(["malldetail/sku/memberpoint","malldetail/sku/memberpoint.css","malldetail/sku/memberpoint.tpl"],function(e,t){t.init({memberMultiPoint:a,product:r,relEl:l});i=t})}})}}else{i&&i.hide()}})})}})}}},{requires:["dom","event","malldetail/sku/buylink","malldetail/sku/cartlink"]});KISSY.add("malldetail/sku/editEntry",function(e,t,a){return{init:function(i){_CTKeccb(33,"act.edit.init","view.metaLeft.init");var n=i.product;n.onLoad(["config","userInfo","itemDO"],function(i,n,o){var r=e.get("#J_EditItem");var l=[];var s=i.detail;var c=i.tag;var d=i.url;if(!r)return;if(n&&n.loginUserType=="seller"){if(s.canEditInItemDet){if(o.isBidden){if(o.isInRepository){l.push('<a href="{{url.topUploadServerBaseUrl}}/auction/publish/edit.htm?item_num_id={{itemDO.itemId}}&auto={{itemDO.isAutoConsignment}}" target="_blank">\u7f16\u8f91</a>')}else if(o.isAutoConsignment&&o.auctionType=="b"){l.push('<a href="{{url.topUploadServerBaseUrl}}/auction/goods/auto_edit.jhtml?id={{itemDO.itemId}}&auction_id={{itemDO.itemId}}" target="_blank" {{#if !detail.isAutoccUser}} onClick="alert(\'\u60a8\u7684\u81ea\u52a8\u53d1\u552e\u6743\u9650\u5df2\u88ab\u53d6\u6d88\uff0c\u4e0d\u80fd\u7f16\u8f91\u5df2\u6709\u51fa\u4ef7\u7684\u81ea\u52a8\u53d1\u552e\u5546\u54c1\'); return false;"{{/if}}>\u7f16\u8f91</a>')}else{l.push('<a href="{{url.topUploadServerBaseUrl}}/auction/publish/edit.htm?item_num_id={{itemDO.itemId}}&auto={{itemDO.isAutoConsignment}}" target="_blank">\u7f16\u8f91</a>')}}else{l.push('<a href="{{url.topUploadServerBaseUrl}}/auction/publish/edit.htm?item_num_id={{itemDO.itemId}}&auto={{itemDO.isAutoConsignment}}" target="_blank" {{#if itemDO.isAutoConsignment && itemDO.auctionType == "a" && !detail.isAutoccUser}} onClick="return confirm(\'\u60a8\u7684\u81ea\u52a8\u53d1\u552e\u6743\u9650\u5df2\u88ab\u53d6\u6d88\n\u5982\u8981\u7ee7\u7eed\u7f16\u8f91\uff0c\u5efa\u8bae\u4e8b\u5148\u5907\u4efd\u597d\u5361\u5bc6\uff0c\u5426\u5219\u5c06\u4e22\u5931\');"{{/if}}>\u7f16\u8f91</a>')}}if(s.isShowPreClosed){if(s.goNewAuctionFlow){l.push('<a href="{{url.BIDRedirectionitemDomain}}/close_auction.htm?item_id={{itemDO.itemId}}">\u63d0\u524d\u6210\u4ea4</a>')}else{l.push('<a href="{{url.tradeBaseUrl}}/close_auction.htm?auction_id={{itemDO.itemId}}">\u63d0\u524d\u6210\u4ea4</a>')}}if(e.get("#J_GoodsErrorSeller")){t.removeClass("#J_GoodsErrorSeller","tb-hidden")}_CTKeccb(33,"act.edit.seller","act.edit.init")}else if(n&&n.loginUserType=="xiaoer"){l.push('<a href="//mckinley.admin.taobao.org/mckinley/auction/commodity/listAuction.htm?auction_id={{itemDO.itemId}}" target="_blank">\u5546\u54c1\u5904\u7406</a>');if(e.get("#J_GoodsErrorOther")){t.removeClass("#J_GoodsErrorOther","tb-hidden")}_CTKeccb(33,"act.edit.xiaoer","act.edit.init")}else{if(s.isAllowReport&&!c.isMedical||g_config.bizTag&128){var u="",m="";if(i.isTripUser){m="&FromSource=trip"}l.push('<a href="//jubao.taobao.com/index.htm?itemId={{itemDO.itemId}}&spm=a1z6q.7847058'+m+'" target="_blank">'+u+"\u4e3e\u62a5</a>");_CTKeccb(33,"act.report.guest","act.edit.init")}if(e.get("#J_GoodsErrorOther")){t.removeClass("#J_GoodsErrorOther","tb-hidden");_CTKeccb(33,"act.report.error","act.edit.init")}}if(l.length){r.innerHTML=a(l.join(" | ")).render({url:d,tag:c,itemDO:o,detail:s})}})}}},{requires:["dom","malldetail/common/template"]});KISSY.add("malldetail/sku/focus",function(e,t,a){return{init:function(i){_CTKeccb(33,"trade.sku.focus","trade.main.init");var n=i.el,o=i.product;o.onLoad("config",function(i){if(i&&i.detail.is0YuanBuy){var r=t.create('<dl class="tm-0yuanbuy-panel"><dt class="tb-metatit">\u4f18\u60e0</dt><dd><div class="price"><em class="tm-yen">\xa5</em> <span class="tm-price">0.00</span><em class="tm-promo-type"><s></s>\u4f59\u989d\u5b9d0\u5143\u8d2d</em></div><div class="notice">\u8d2d\u673a\u4ef7\u683c <em class="tm-yen">\xa5</em> <span class="tm-price"></span> \u9700\u6388\u6743\u51bb\u7ed3<span class="tm-price"></span>\u5143\u4f59\u989d\u5b9d\u5bf9\u5e94\u91d1\u989d\uff0c\u534f\u8bae\u671f\u6ee1\u540e\u5982\u65e0\u8fdd\u7ea6\u5168\u989d\u89e3\u9664\u51bb\u7ed3</div></dd><dl>');o.onChange("buyPrice",function(e){t.html(t.query(".tm-price",t.get(".notice",r)),e.min)});var l=t.get(".tm-price-panel",n);var s=t.get(".tm-promo-panel",n);t.insertAfter(r,l);t.hide(l);t.hide(s);_CTKeccb(33,"trade.0yuanbuy.init","trade.sku.focus");return}if(!i.isTripUser){o.onChange(["itemDO","itemPrice","currentPromotion"],function(e,i,o){if(!i.hasTmallappProm||!o||!o.extraPromPrice){t.remove(".tm-phoneprice");return false}var r,l;var s='<div class="wraper"><span class="phoneprice">\u60f3\uffe5'+o.extraPromPrice+'\u62ff\u4e0b\uff1f</span><span class="qrtrigger">\u624b\u673a\u5929\u732b\u8d2d\u4e70\u66f4\u4fbf\u5b9c</span></div>';if(t.get(".tm-phoneprice")){t.html(t.get(".tm-phoneprice"),'<dt class="tb-metatit">&nbsp;</dt><dd>'+s+"</dd>")}else{var c=t.create('<dl class="tm-phoneprice"><dt class="tb-metatit">&nbsp;</dt><dd>'+s+"</dd></dl>");t.append(c,n);var d=t.get(".qrtrigger",c);a.on(d,"mouseover mouseout",function(a){if(r){clearTimeout(r)}r=setTimeout(function(){if(a.type=="mouseover"){if(!l){l=t.create('<img class="qrpic"/>');t.append(l,d);l.src=TShop.getQrURL({itemId:e.itemId,mmstat:"detail_pcfocus"});_CTKeccb(33,"trade.qrcode.hover","trade.sku.focus")}t.show(l)}else{t.hide(l)}},300)})}})}o.onLoad(["itemPrice"],function(e){if(!e||!e.taojinbiForHK){return}var a=t.create('<dl class="tm-otherPromo-panel"><dt class="tb-metatit">\u5176\u4ed6\u4f18\u60e0</dt><dd>'+e.taojinbiForHK+"</dd></dl>");_CTKeccb(33,"mod.taojinbi.init","trade.sku.focus");t.append(a,n)});o.onLoad(["campaignInfo"],function(a){if(!a||g_config.offlineShop||typeof a.serviceType=="undefined"||a.serviceType==2){return}var i=t.create('<dl class="tm-campaign-panel"><dt class="tb-metatit">\u8de8\u5e97\u4f18\u60e0</dt><dd></dd></dl>');t.append(i,n);e.use("malldetail/body/campaign,malldetail/body/campaign.tpl",function(e,t){t.init({campaignInfo:a,el:i})})});o.onLoad(["tmallShopProm","deviceType","detailPageTips"],function(a,i,o){var r=t.create('<dl class="tm-shopPromo-panel"></dl>');if(!a){var l="";if(o&&(l=o.freeOrderInfo)){a=[];a.push({title:l.title,campaignName:l.title,isFree:true,startTime:l.startDate,endTime:l.endDate,promPlan:{detailMsg:[]}})}else{return}}else{var l="";if(o&&(l=o.freeOrderInfo)){a.splice(0,0,{title:l.title,campaignName:l.title,isFree:true,startTime:l.startDate,endTime:l.endDate,promPlan:{detailMsg:[]}})}}t.append(r,n);e.use("malldetail/sku/shopPromotion",function(e,t){t.init({data:a,el:r,deviceType:i})})});var c=t.get(".tm-promo-panel",n);if(c){o.onLoad(["itemPrice","serverStartTime","currentPromotion","detailPageTips","currentWrtInfo","model"],function(a,i,n,r,l,s){if(!a){t.hide(c);return}if(a&&l&&l.status!=0){t.addClass(c,"tm-promo-panel-wrt");t.html(c,'<dt class="tb-metatit">\u9884\u552e\u4ef7</dt><dd></dd>');e.use("malldetail/sku/yushou",function(e,a){a.init({wanrentuanInfo:l,serverStartTime:i,linkBuy:t.get("#J_LinkBuy"),product:o})})}else{if(!t.get("dd",c)){t.html(c,'<dt class="tb-metatit">\u4fc3\u9500\u4ef7</dt><dd></dd>')}var d=s.doubleEleven2014;if(d&&d.step==2||r&&r.showDuo11Stage==2){var m=r.dou11PromPriceTitle;if(m){t.html(t.get(".tb-metatit",c),m)}t.css(t.get(".tb-metatit",c),{color:"#c40000",fontWeight:"bold"})}if(n&&n["promType"]=="tmallBrandMember"){t.html(c,'<dt class="tb-metatit">\u4e13\u4eab\u4ef7</dt><dd></dd>')}e.use("malldetail/sku/productPromotion",function(e,t){t.init({el:c,product:o,showZhe:g_config.pageType==="temai"})})}if(g_config.hiddenNonBuyprice&&!(d&&r&&(d.step==2||r.showDuo11Stage==2)&&r.dou11PromPriceTitle)){t.html(t.get(".tb-metatit",c),"\u4ef7\u683c")}})}var d=t.get(".tm-price-panel",n);if(d){o.onLoad(["detailPageTips","tagPrice","itemPrice","currentPromotion","config"],function(a,i,n,r,l){if(i&&a&&a.priceDisplayType==2){t.hide(d);return}if(i&&a&&a.priceDisplayType==3&&r){t.hide(d);return}if(!t.get("dd",d)){t.html(d,'<dt class="tb-metatit">\u4ef7\u683c</dt><dd>'+t.html(d)+"</dd>")}e.use("malldetail/sku/price",function(e,t){t.init({el:d,product:o})});if(n.duo11Stage==2||n.duo11Stage==1&&r){t.hide(d);return}});o.onChange(["detailPageTips","tagPrice","internationalComponent","itemPrice"],function(e,a,i,n){if(!(a&&a.str&&e&&(e.priceDisplayType===0||e.priceDisplayType==2||e.priceDisplayType==3))||g_config&&g_config.hiddenNonBuyprice){t.remove(t.get(".tm-tagPrice-panel"));return}var o=n.duo11Stage;var r="\u4e13\u67dc\u4ef7";if(o&&o>0&&i){if(o==1){r=""}else{r="\u4ef7\u683c"}}var l=t.get(".tm-tagPrice-panel");if(!l&&r){l=t.create('<dl class="tm-tagPrice-panel"><dt class="tb-metatit">'+r+"</dt><dd></dd></dl>")}_CTKeccb(33,"mod.tagPrice.init","trade.sku.focus");if(r)t.get("dd",l).innerHTML=a?' <em class="tm-yen">&yen;</em> <span class="tm-price">'+a.str+"</span>":"";if(a&&r){t.insertBefore(l,d)}})}if(c&&d){t.insertAfter(c,d)}var m=t.get("#J_Progressive");if(m){o.onLoad(["userInfo","itemDO","model","progressiveInfo"],function(a,i,n,r){if(!r){return}if(n.switcherDO&&n.switcherDO.progressiveDisable){t.hide(m)}else{e.use("malldetail/sku/progressive",function(e,t){t.init({el:m,product:o})})}})}o.onLoad(["internationalComponent","delivery"],function(e,i){var n=null;a.delegate("#J_DetailMeta","click",".j_dialogSize",function(t){t.preventDefault();if(!n){KISSY.use("mui/overlay/dialog",function(t,a){n=new a({width:560,height:441,skin:"gray",bodyContent:"<div class='wrapDialog'><img src='"+e.sizeCartUrl+"'/><span class='dialogAfter'></span></div>",align:{points:["cc","cc"]}});n.render();n.show()})}else{n.show()}});if(i&&i.extraInfo){t.insertAfter(t.create("<span>&nbsp;"+i.extraInfo+"</span>"),"#J_PostageToggleCont")}if(!e||!e.tariff||!e.tariff.value)return;var o="";var r=e.taxCoupon||{};if(r.link&&r.linkText&&r.text){o='<span class="deduction">('+r.text+' <a href="'+r.link+'" target="_blank">'+r.linkText+"</a>)</span>"}t.append(t.create("<dl class='tariff-rule'><dt class=\"tb-metatit\">"+e.tariff.name+"</dt><dd>"+e.tariff.value+o+"</dd></dl>"),"#J_DetailMeta .tm-fcs-panel");t.append(t.create("<a href='#' class='c_totalRule'>\u603b\u4ef7\u89c4\u5219</a>"),".tariff-rule dd");var l=null;if(!l){KISSY.use("malldetail/common/tip",function(e,a){var i=["\u5230\u624b\u4ef7\uff1d\u5546\u54c1\u6210\u4ea4\u4ef7\u683c+\u7a0e\u8d39+\u8fd0\u8d39","\u4e2d\u56fd\u6d77\u5173\u89c4\u5b9a\u8fdb\u53e3\u5546\u54c1\u9700\u8981\u7f34\u7eb3\u8fdb\u53e3\u7a0e\uff0c\u6bcf\u4e2a\u5546\u54c1\u56e0\u7c7b\u76ee\u4e0d\u540c\uff0c\u6709\u4e0d\u540c\u7684\u7a0e\u7387\u3002","\u7a0e\u8d39\uff1d\u5546\u54c1\u6210\u4ea4\u4ef7\xd7\u7a0e\u7387"];l=new a(t.get(".c_totalRule"),i.join("<br/>"),{triggerType:"mouse",align:{points:["br","tr"],offset:[1,0]},arrow:true,arrowDir:"top-right"})})}else{l.show()}});o.onLoad(["detailPageTips"],function(e){if(e&&e.coupon&&e.coupon.logo&&e.coupon.txt&&e.coupon.linkText){var a=e.coupon;var i="<div class='tm-coupon-panel'><img height='16' src='"+a.logo+"' />"+a.txt+" <a id='J_guaGuaKaPc' target='_blank'>"+a.linkText+"</a></div>";t.insertBefore(t.create(i),t.get(".tm-fcs-panel").children[0]);if(a.displayType==2){KISSY.use("mui/zebra-guaguaka-detail-pc/index-pc,event",function(e,t,a){var i=null;a.on("#J_guaGuaKaPc","click",function(e){e.halt();i=new t({dom:document.body})})})}else{t.attr(t.get("#J_guaGuaKaPc"),"href",a.url)}}})})}}},{requires:["dom","event","malldetail/sku/productPromotion","malldetail/sku/price"]});KISSY.add("malldetail/sku/indices",function(e,t,a,i){return{initSellCount:function(e){var n=e.el,o=e.config,r=e.product;_CTKeccb(33,"mod.sellCount.init","mod.indices.init");r.onChange(["currentPriceInfo","sellCount","bucketId"],function(e,a,r){if(!a||typeof a.sellCount!="number"&&typeof a.orderPersons!="number"||i.bucketStat(r,g_config["monthlySalesBucketTestIdArray"])){t.hide(n)}else{var l=a.sellCountLabel||"\u6708\u9500\u91cf";var s=o.detail.isCyclePurchase?a.orderPersons:a.sellCount;if(a.sellCountLabel){s=a.levelCount}var c=['<div class="tm-indcon">','<span class="tm-label">'+l+"</span>",'<span class="tm-count">'+s+"</span>","</div>"];n.innerHTML=c.join("");if(e&&e.monthlyAvgPrice){t.addClass(n,"tm-line3")}else{t.removeClass(n,"tm-line3")}t.show(n);_CTKeccb(33,"mod.sellCount.show","mod.sellCount.init")}});if(e.onClick){t.addClass(n,"canClick");a.on(n,"click",function(t){t.preventDefault();e.onClick();_CTKeccb(33,"mod.sellCount.click","mod.sellCount.show")})}},initReviewCount:function(e){var i=e.el,n=e.product;_CTKeccb(33,"mod.reviewCount.init","mod.indices.init");n.onChange("reviewCount",function(e){var a=e&&e.gradeAvg;if(!a){t.hide(i)}else{var n=['<div class="tm-indcon">'+'<span class="tm-label">\u7d2f\u8ba1\u8bc4\u4ef7</span>','<span class="tm-count">'+e.rateTotal+"</span>","</div>"];i.innerHTML=n.join("");t.addClass(i,"tm-line3");_CTKeccb(33,"info.review.level","mod.reviewCount.init")}});if(e.onClick){t.addClass(i,"canClick");a.on(i,"click",function(t){t.preventDefault();e.onClick();TShop.sendAtpanel("tmalldetail.12.1");_CTKeccb(33,"info.review.trigger","mod.reviewCount.init")})}},initEmPoint:function(e){var a=e.el,i=e.config,n=e.product;_CTKeccb(33,"mod.emPoint.init","mod.indices.init");n.onLoad(["memberRight","model","config"],function(e,i,o){var r=o.isTripUser;var l=e&&!e.pricePointExt&&e.activeName?e.activeName:"";var s=e&&e.time>0?e.time:parseFloat(o.valPointTimes);var c=e&&e.value>0?e.value:parseFloat(o.valPointRate);n.onChange(["buyPrice","currentCycle"],function(e,n){if(!e){return}var o=0;if(!(i.switcherDO&&i.switcherDO.pointDisable)){if(n){for(var d=0,u=n.priceStep.length;d<u;d++){o+=Math.floor(n.priceStep[d]*n.amount*c/100);if(n.payType==1)break}}else{if(r)c=.5;o+=Math.floor(e.min*c)}if(e.min!=e.max){o+="<span>\u8d77</span>"}if(s>1&&r!==true){o="<span>\u9001"+s+'\u500d</span><span class="gong">\u5171</span>'+o}}var m=['<div class="tm-indcon">','<a href="//vip.tmall.com/vip/index.htm" target="_blank">','<span class="tm-label">'+(r?"\u7d2f\u79ef\u65c5\u7a0b":"\u9001\u5929\u732b\u79ef\u5206")+"</span>",'<span class="tm-count">'+o+"</span>",l?'<span class="tm-active"><em>'+l+"</em></span>":"","</a>","</div>"];t.html(a,m.join(""));_CTKeccb(33,"mod.emPoint.show","mod.emPoint.init");l?t.addClass(a,"tm-line3"):t.removeClass(a,"tm-line3")})})},init:function(e){_CTKeccb(33,"mod.indices.init","trade.main.init");var a=this,i=e.el,n=e.config,o=e.product;var r=t.get(".tm-ind-sellCount",i);if(!r&&e.autoFill){r=t.create('<li class="tm-ind-item tm-ind-sellCount"></li>');t.append(r,i)}r&&a.initSellCount({el:r,config:n,onClick:e.onSellCountClick,product:o});var l=t.get(".tm-ind-reviewCount",i);if(!l&&e.autoFill){l=t.create('<li class="tm-ind-item tm-ind-reviewCount"></li>');t.append(l,i)}l&&!n.itemDO.isHotItem&&a.initReviewCount({el:l,config:n,onClick:e.onReviewClick,product:o});var s=t.get(".tm-ind-emPointCount",i);if(!s&&e.autoFill){s=t.create('<li class="tm-ind-item tm-ind-emPointCount"></li>');t.append(s,i)}s&&!n.itemDO.isHotItem&&a.initEmPoint({el:s,product:o,config:n})}}},{requires:["dom","event","malldetail/common/util"]});KISSY.add("malldetail/sku/freight",function(e,t,a,i,n){var o="",r,l=false;return{init:function(a){var i=a.el,s,c=a.product,d=t.get(".tb-postAge",i);_CTKeccb(33,"mod.freight.init","view.meta.init");c.onChange("buyerLoc",function(e){if(e>=81e4&&e<=820999){TShop.sendAcAtpanel("tmalldetail.100.1")}});c.onLoad(["config","model"],function(a,s){if(s.switcherDO&&s.switcherDO.deliveryDisable){t.hide("#J_PostageToggleCont")}else if(window.g_config.pageType!=="auction"){c.onChange(["currentDelivery","delivery"],function(a,s){if(!a){t.addClass(i,"tb-hidden");return}var c="",d=[];var m=a[0]?a[0]["type"]:a["type"];if(m===1){if(!l){TShop.sendAcAtpanel("tmalldetail.921921.*");l=true}}e.each(a,function(e){if(e.type==2){TShop.sendAcAtpanel("tmalldetail.100.2")}e.name=e.name||"";c+=n(e);o=e.tips||"";d+=e.signText||"";t.removeClass(i,"tm-delivery-highLight");if(e.warning){t.addClass(i,"tm-delivery-highLight")}else{if(s&&s.timeliness&&s.timeliness.icon){if(s.timeliness.link){d='<a href="'+s.timeliness.link+'" target="_blank"><img src="'+s.timeliness.icon+'" class="tm-posticon"/></a>'+d}else{d='<img src="'+s.timeliness.icon+'" class="tm-posticon"/>'+d}}}});t.html(t.get("#J_PostageToggleCont",i),c);t.removeClass(i,"tb-hidden");if(d){if(!r){r=t.create('<div class="signText"></div>');t.append(r,t.get("dd",i))}t.html(r,d);t.show(r)}else{r&&t.hide(r)}_CTKeccb(33,"mod.freight.show","mod.freight.init")})}});c.onLoad("config",function(e){if(!e.isAreaSell){return}_CTKeccb(33,"feature.deliveryHighlight.init","mod.freight.init");var a=t.get("#friInfo",d);if(!a){a=t.create('<div id="friInfo">\u786e\u8ba4\u6536\u8d27\u5730\uff0c\u4ee5\u786e\u4fdd\u5728\u5546\u5bb6\u9500\u552e\u533a\u57df</div>');t.append(a,d)}});var m=t.get("#J_AddrSelectTrigger",i);if(m){c.onChange(["delivery","currentDelivery"],function(a,n){if(!a||!a.deliveryAddress){return}var o=t.get("#J_deliveryAdd",i);if(!o){o=t.create("<span></span>",{"class":"tb-deliveryAdd",id:"J_deliveryAdd"});t.prepend(o,d);t.insertAfter(t.create("\u81f3"),o)}if(!n){t.text(o,a.deliveryAddress)}else{e.each(n,function(e){if(e.skuDeliveryAddress){t.text(o,e.skuDeliveryAddress)}else{t.text(o,a.deliveryAddress)}})}if(a&&a.transfername){var r=t.get("#J_interRegion");if(!r){t.insertAfter(t.create("<span id='J_interRegion'>&nbsp;\u81f3&nbsp;"+a.transfername+"&nbsp;</span>"),"#J_deliveryAdd")}}_CTKeccb(33,"feature.deliveryAddress.show","mod.freight.init")});e.use("malldetail/sku/address",function(e,t){t.init({el:m,product:c})})}}}},{requires:["dom","event","io","malldetail/sku/freight.tpl"]});KISSY.add("malldetail/sku/freight.tpl",function(){return function(e,t){var a={escapehash:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},escapereplace:function(e){return a.escapehash[e]},escaping:function(e){return typeof e!=="string"?e:e.replace(/[&<>"]/gim,this.escapereplace)},detection:function(e){return typeof e==="undefined"?"":e}};var i=function(e){if(typeof console!=="undefined"){if(console.warn){console.warn(e);return}if(console.log){console.log(e);return}}throw e};t=t||{};t.__escapehtml=a;t.__throw=i;"use strict";var e=e||{};var l="";l+="";try{l+="";var r=e.name;var n=e.money;var o=e.postage;var s=e.serviceLinkUrl;var c=e.serviceLinkText;var d=e.warning;var m=e.p;var u=e.em;var p=e.yen;var v=e.span;var f=e.error;var h=e.a;l+="<p>     ";if(r){l+="";l+=t.__escapehtml.detection(r);l+=""}l+="     ";if(n){l+='<em class="tm-yen">&yen;';l+=t.__escapehtml.detection(n);l+="</em>"}l+="     ";if(o){l+="<span ";if(d){l+=' class="tm-error"'}l+=">";l+=t.__escapehtml.detection(o);l+="</span>"}l+="     ";if(c&&s){l+=' <a href="';l+=t.__escapehtml.detection(s);l+='" target="_blank">';l+=t.__escapehtml.detection(c);l+="</a>"}l+=" </p>"}catch(g){t.__throw("Juicer Render Exception: "+g.message)}l+="";return l}});KISSY.add("malldetail/sku/metaLeft",function(e,t,a,i,n,o){var r;return{addIcon:function(e){var a=t.get(".tb-meta-icons",".tb-gallery");if(!a){a=t.create('<ul class="tb-meta-icons"></ul>');t.append(a,".tb-gallery")}var i;i=t.create("<li></li>",e);if(e.href){var n=t.create("<a></a>",{href:e.href,title:e.title,target:"_blank",css:{width:40,height:42,display:"block",position:"absolute",top:0,left:0}});t.append(n,i)}t.append(i,a)},init:function(r){_CTKeccb(33,"view.metaLeft.init","view.main.init");var l=this,s=r.product;var c=i.createLoader(function(a){s.onLoad(["config"],function(i){if(i.detail.show9sVideo==false){return}var o=i&&i.itemDO&&i.itemDO.imgVedioPic;var r=i&&i.itemDO&&i.itemDO.imgVedioUrl;if(o&&r){e.use("malldetail/sku/focusVideo",function(e,i){i.init({videoPic:o,videoUrl:r,onPlay:function(){n.hideZoomer()},el:t.get(".tb-booth","#J_DetailMeta")});a(i)})}})});n.init({onSwitch:function(){c(function(e){e.stopVideo()},2)},product:s});TShop.afterWinLoad(function(){s.onLoad(["config"],function(e){if(e.detail.show9sVideo==false){return}var t=e&&e.itemDO&&e.itemDO.imgVedioPic;var a=e&&e.itemDO&&e.itemDO.imgVedioUrl;if(t&&a){c()}})});var d=t.get("#J_DetailMeta .tb-img");if(d){s.onChange(["selectedSkuProp"],function(a){var i=t.query("li",d);e.each(i,function(e){var i=t.attr(e,"data-value"),o=i.split(":");if(a[o[0]]==o[1]){var r=t.get("a",e);var l=t.css(r,"backgroundImage");if(-1!==l.indexOf("url(")){var s=l.match(/url\("?([^\)^"]*)/)[1];s=s.substring(0,s.lastIndexOf("_"));n.show(s)}return false}})})}var u=t.get("#J_CollectCount");if(u){_CTKeccb(33,"mod.collectCount.init","view.metaLeft.init");s.onLoad(["shopDynamicRating","config"],function(e,a){if(a&&e){var i=parseInt(e["ICCP_1_"+a.itemDO.itemId],10);if(i>0&&i<1e6){u.innerHTML="\uff08"+i+"\u4eba\u6c14\uff09";_CTKeccb(33,"mod.collectCount.show","view.metaLeft.init");return}}t.hide(u)})}s.onLoad(["config","detailPageTips"],function(t,a){var i=[];if(a){i=a.primaryPicIcons||i;i=e.map(i,function(e){return{title:e.title,tagImage:e.url,tagLink:e.link}})}var n=t.serviceIconList||[];n=n.concat(i);e.each(n,function(t){l.addIcon({title:t.description,href:t.tagLink,css:{width:40,height:42,background:"url("+t.tagImage+") no-repeat",marginLeft:5,position:"relative",top:20,display:e.UA.ie==6?"inline":"block",zoom:1,"float":"left"}})})});s.onLoad(["detailPageTips"],function(e){if(e&&e.showDou12CornerIcon){l.addIcon({"class":"tm-meta-iconDouble11"});_CTKeccb(33,"meta.icon.double11","view.metaLeft.init")}});o.init({product:s});t.html(t.get("i","#J_AddFavorite"),"&#xe609;");a.on("#J_AddFavorite","click",function(t){TShop.sendAtpanel("tmalldetail.13.4");t.preventDefault();e.use("malldetail/action/addfav",function(e,a){TShop.onLogin(function(){s.onLoad(["itemDO","token"],function(e,i){a.run({itemId:e.itemId,sellerId:e.userId,categoryId:e.categoryId,event:t,token:i})})})})});s.onLoad("config",function(i){var n=t.get("#J_IShare");if(i.isTwView||i.isWorldView){e.use("malldetail/action/copyLink",function(e,t){t.init()});t.html(t.get("i",n),"&#xe60e;");var o="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(location.href)+"&t="+encodeURIComponent(document.title);a.on(n,"click",function(t){t.preventDefault();var a=800;var i=e.one(window).width();window.open(o,"newwindow","height=400,width="+a+",top=100,left="+(i-a)/2+",toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no")})}else{t.html(t.get("i",n),"&#xe607;");a.on("#J_IShare","click",function(t){t.preventDefault();_CTKeccb(33,"external.iShare.init","view.metaLeft.init");e.use("mui/share",function(e,t){_CTKeccb(33,"external.iShare.run","external.iShare.init");var a=window.g_config;var i={style:"none",id:1,container:"#J_IShare",type:"item",showRecTip:false,key:a.itemId};new t(i).popup();TShop.sendAtpanel("tmalldetail.13.11");_CTKeccb(33,"external.iShare.runSuccess","external.iShare.run")})})}})}}},{requires:["dom","event","malldetail/common/util","malldetail/sku/thumbViewer","malldetail/sku/editEntry"]});KISSY.add("malldetail/sku/paymethods",function(e,t,a){var i,n="pay-credit-hover",o,r;return{init:function(e){this.el=e.el;_CTKeccb(33,"mod.paymethods.init","trade.main.init");var a=this;i=e.el;o=e.promiseDisable;r=e.payDisable;a._payCod(e.delivery,e.pageType);t.html(t.get("#J_Toggler",i),"&#xe62b;");t.show(t.get("#J_Toggler",i));a._bindEvents()},_toggleHandler:function(e){e&&e.preventDefault();TShop.refreshLazy();t[t.hasClass(i,n)?"removeClass":"addClass"](i,n);t.html(t.get("#J_Toggler",i),t.hasClass(i,n)?"&#xe62c;":"&#xe62b;");TShop.sendAtpanel("tmalldetail.4.6");_CTKeccb(33,"mod.paymethods.click","mod.paymethods.show")},_payCod:function(l,s){if(!l||!l.otherServiceList)return;var c=this,d=l.otherServiceList;var u=[];if(!o){if(s==="Miao"){t.text(".tm-ser .tb-metatit","\u55b5\u9c9c\u751f\u7279\u8272");var m=["\u6e90\u4ea7\u5730\u76f4\u4f9b","\u65b0\u9c9c\u5230\u5bb6","\u95ea\u7535\u8d54\u4ed8"];var f="";e.each(m,function(e){f+="<li>"+e+"</li>"});t.html(".tb-serPromise",f)}else{for(var p=0,v=d.length;p<v;p++){u.push('<a href="'+d[p]["url"]+'" target="_blank"><s style="background:url('+d[p]["imgUrl"]+') no-repeat center center"></s>'+d[p]["title"]+"</a>")}}}else{c._hideSerPromise()}if(!r){t.prepend(t.create(u.join("")),t.get(".J_Paylist",i));a.on(document,"click",function(e){if(t.hasClass(i,n)&&!t.contains(i,e.target)){c._toggleHandler()}})}else{c._hidePayMethod()}if(r&&o){t.hide(".tm-ser")}_CTKeccb(33,"mod.paymethods.show","mod.paymethods.init")},_insertSerPromise:function(e){var a=t.get(".tb-serPromise");if(a){t.append(t.create(e),a)}},_hideSerPromise:function(){t.hide(".tm-pledge3c-meta");t.hide(".tm-ser > .tm-clear")},_hidePayMethod:function(){t.hide(".tm-pay-box")},_bindEvents:function(){a.on("#J_Toggler","click",this._toggleHandler);a.on(t.get(".pay-title",this.el),"click",this._toggleHandler)}}},{requires:["dom","event"]});KISSY.add("malldetail/sku/promoBanner",function(e,t){function a(t,a,i){if(e.UA.ie===6){if(!i){return t?"<style>.logoPic_"+a+'{_background-image:none;_filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,sizingMethod=scale,src="'+t.logoUrl+'");}</style><div class="logoPic logoPic_'+a+'" title="'+(t.tips||"")+'"></div>':""}else{return t?"<style>.logoPic_"+a+'{_background-image:none;display:block;_filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,sizingMethod=scale,src="'+t.logoUrl+'");}</style><a class="logoPic logoPic_'+a+'" target="_blank" href="'+i+'" title="'+(t.tips||"")+'"></a>':""}}else{if(!i){return t?'<div class="logoPic logoPic_'+a+'" title="'+(t.tips||"")+'"><img src="'+t.logoUrl+'" height="28"/></div>':""}else{return t?'<a class="logoPic logoPic_'+a+'" target="_blank" href="'+i+'" title="'+(t.tips||"")+'"><img src="'+t.logoUrl+'" height="28"/></a>':""}}}function i(t){var a="//wwc.alicdn.com/avatar/getAvatar.do?userId={userId}&width=60&height=60&type=sns";return'<div class="tm-sm-wrap"><div class="tm-sm-userGraph"><img width="52" height="52" src="'+e.substitute(a,{userId:t.userId})+'" /></div>'+(t.activeStatus!=-1?'<div class="tm-sm-icon"><i class="tm-sm-iconc">&#xe61b;</i><span class="tm-sm-itext">T'+t.activeStatus+"</span></div></div>":"")}function n(e){var t,a=[];e=parseInt(e/1e3);if(e<=0){return a.join("")}t=e%60;a.unshift(t+"\u79d2");e=(e-t)/60;if(e<=0){return a.join("")}t=e%60;a.unshift(t+"\u5206");e=(e-t)/60;if(e<=0){return a.join("")}a.pop();t=e%24;a.unshift(t+"\u5c0f\u65f6");e=(e-t)/24;if(e<=0){return a.join("")}a.pop();a.unshift(e+"\u5929");return a.join("")}return{init:function(o){_CTKeccb(33,"mod.promoBanner.init","trade.main.init");var r=o.product,l=o.el;r.onChange(["config","currentPromotionList","itemPrice","currentSuggestivePromotionList","detailPageTips","misc","model","userInfo"],function(o,s,c,d,u,m,p,f){var v=[].concat(s||[]).concat(d||[]),h=e.filter(v,function(e){return e.promType=="keyJhs"||e.promType=="jhs"||e.promType=="jhs_warm"})[0],g=e.filter(v,function(e){return e.promType=="tmallBigMarkDown"})[0],b=e.filter(v,function(e){return e.promType=="tmallBrandMember"})[0],_=e.filter(v,function(e){return e.promType=="awp"})[0],y=t.get("dd",l),w=t.get("dt",l);var T;var k=p.minisiteDO&&p.minisiteDO.validMlhItem&&p.minisiteDO.itemStatus===0;var S=p.minisiteDO&&p.minisiteDO.validMlhItem&&p.minisiteDO.itemStatus===1;var C=p.minisiteDO&&p.minisiteDO.validMlhItem&&p.minisiteDO.itemStatus===4;var I=p.doubleEleven2014;if(I&&I.doubleElevenItem&&I.step>0){}var x=!!(g&&g.status==1&&u.warmingUpHintText);var D=!!(g&&u.campaignText);var P=function(){if(u.warmingUpHintText){var e=u.warmingUpHintText.replace(/\$\{(.+)\}/g,function(e,t){switch(t){case"hurriedPrice":var a=g&&g.promType=="tmallBigMarkDown"?g.price:"";return a?'<span class="tm-yen">&yen;</span><span class="tm-price">'+a+"</span>":""}return""});return e}else{return""}};function L(){var e="";var t=null;for(var a=0,i=v.length;a<i;a++){if(v[a].promType=="jhs_warm"){t=v[a];e="jhs_warm";break}}return{_promotion:t,jhsType:e}}t.show(t.get(".tm-focus-banner"));switch(true){case!!(_&&(u.crowdType==1||u.crowdType==2||u.crowdType==3)):t.hide(w);var M=u.crowdType;t.addClass(l,"tm-sm-prom");var A="";if(M&&M!==1){t.addClass(l,"tm-sm-promHasCrown");A=i(f)}var J="";var K=u.campaignText||"";var O=u.campaignUrl||"";var R="";if(K&&O){R='<a href="'+O+'" target="_blank">'+K+"</a>"}if(x){J=a(u.warmUpIcons&&u.warmUpIcons[0],0,T)}else{J=a(u.icons&&u.icons[0],0,T)}t.html(y,J+A+(R?R:K));break;case x:t.addClass(l,"green");t.hide(w);var E=P();var q=/[,^]3394[,$]/.test(o.tagsId)?'<div class="cornerIcon ju">&#xe601;</div>':"";var J=a(u.warmUpIcons&&u.warmUpIcons[0],0,T);if(u.double11BgIcon)t.css(l,{backgroundImage:"url("+u.double11BgIcon+")",backgroundSize:"100% 50px"});t.html(y,q+J+E);break;case D:t.hide(w);t.addClass(l,"golden");var q=/[,^]3394[,$]/.test(o.tagsId)?'<div class="cornerIcon ju">&#xe601;</div>':"";var J=a(u.icons&&u.icons[0],0,T);if(u.double11BgIcon)t.css(l,{backgroundImage:"url("+u.double11BgIcon+")",backgroundSize:"100% 50px"});t.html(y,q+J+(u.campaignText||""));break;case!!u.showDou11Style:t.hide(w);if(u.double11BgIcon){var B="<img src='"+u.double11BgIcon+"' />";t.css(l,{backgroundImage:"url("+u.double11BgIcon+")",backgroundSize:"100% 50px"})}var q=/[,^]3394[,$]/.test(o.tagsId)?'<div class="cornerIcon ju">&#xe601;</div>':"";var E=P()||u.campaignText;var J=a(u.warmUpIcons&&u.warmUpIcons[0],0,T)||a(u.icons&&u.icons[0],0,T);t.html(y,q+J+E);break;case!!(h&&h.status==1):t.addClass(l,"green-ju");t.addClass(l,"normalJhs");t.attr(y,{"data-spm":"1998059570"});var j=L();if(j._promotion){_promotion=j._promotion;var N=new Date(h.startTime);var U=N.getMonth()+1;if((U+"").length==1)U="0"+U;var H=N.getDate();if((H+"").length==1)H="0"+H;var z=N.getHours();if((z+"").length==1)z="0"+z;var Y=N.getMinutes();if((Y+"").length==1)Y="0"+Y;t.html(y,'<div class="logoIcon">&#xe600;</div>\u6b64\u5546\u54c1 <strong>'+U+"\u6708"+H+"\u65e5 "+z+":"+Y+"</strong>\u53c2\u52a0\u805a\u5212\u7b97  \u805a\u5212\u7b97\u4ef7\uff1a<strong>"+_promotion.price+'</strong>\u5143 <a class="linkJu" href="#">&#xe61a;</a>')}else{t.html(y,'<div class="logoIcon">&#xe600;</div>\u6b64\u5546\u54c1\u5373\u5c06\u53c2\u52a0\u805a\u5212\u7b97\uff0c'+(h.startTime?"<strong>"+n(h.startTime-m.systemTime)+"</strong>\u540e\u5f00\u59cb\uff0c":"")+'<a class="linkJu" href="#">\u53bb\u8bbe\u7f6e\u63d0\u9192</a>\uff01')}r.onLoad("trade",function(a){t.attr(t.get(".linkJu",y),"href",o.url.tgDetailDomain+"/home.htm?item_id="+o.itemDO.itemId+"&"+(a&&a.param&&e.param(a.param)||"")+"")});if(h.startTime&&j.jhsType!="jhs_warm"){e.use("malldetail/control/timer",function(e,a){new a({leftTime:(h.startTime-m.systemTime)/1e3,container:t.get("strong",y),tpl:"{date}"}).onStop(function(){location.reload()})})}break;case!!h:t.addClass(l,"red");t.addClass(l,"normalJhs");t.html(y,'<div class="logoIcon">&#xe600;</div>\u6b64\u5546\u54c1\u6b63\u5728\u53c2\u52a0\u805a\u5212\u7b97\uff0c'+(h.endTime?"<strong>"+n(h.endTime-m.systemTime)+"</strong>\u540e\u7ed3\u675f\uff0c":"")+"\u8bf7\u5c3d\u5feb\u8d2d\u4e70\uff01");if(h.endTime){e.use("malldetail/control/timer",function(e,a){new a({leftTime:(h.endTime-m.systemTime)/1e3,container:t.get("strong",y),tpl:"{date}"}).onStop(function(){location.reload()})})}break;case!!b:if(b["promText"]&&/\u767b\u5f55/.test(b["promText"])){t.hide(l)}else{t.addClass(l,"red");t.html(y,'<span class="tm-brandtitle">\u54c1\u724c\u4e13\u4eab\u7279\u6743</span>\u6b63\u5728\u53c2\u52a0\u54c1\u724c\u56de\u9988\u6d3b\u52a8\uff0c\u5e2e\u60a8\u7acb\u7701<span class="tm-viponly-price"></span>\u5143\uff0c\u8bf7\u5c3d\u5feb\u8d2d\u4e70');var F=t.get(".tm-viponly-price");r.onChange(["selectedSkuProp","currentPromotion","currentPriceInfo"],function(e,t,a){if(F&&t["promType"]=="tmallBrandMember"){F.innerHTML=parseInt(a.price)-parseInt(t.price)}})}break;case u.showDou11Style:t.hide(w);t.addClass(l,"golden");var q=/[,^]3394[,$]/.test(o.tagsId)?'<div class="cornerIcon ju">&#xe601;</div>':"";var J=a(u.icons&&u.icons[0],0,T);t.html(y,q+J+(u.campaignText||""));break;case!!k:t.addClass(l,"black");t.addClass(l,"normalJhs");t.html(y,'<div class="logoIcon">&#xe62a;</div>\u8ddd\u62a2\u8d2d\u5f00\u59cb\u8fd8\u5269: '+(p.minisiteDO.startTime?"<strong>"+n(p.minisiteDO.startTime-m.systemTime)+"</strong>":"")+"");if(p.minisiteDO.startTime){e.use("malldetail/control/timer",function(e,a){new a({leftTime:(p.minisiteDO.startTime-m.systemTime)/1e3,container:t.get("strong",y),tpl:"{date}"}).onStop(function(){location.reload()})})}break;case!!S:t.addClass(l,"black");t.addClass(l,"normalJhs");t.html(y,'<div class="logoIcon">&#xe62a;</div>\u8ddd\u62a2\u8d2d\u7ed3\u675f\u8fd8\u5269: '+(p.minisiteDO.endTime?"<strong>"+n(p.minisiteDO.endTime-m.systemTime)+"</strong>":"")+"");if(p.minisiteDO.endTime){e.use("malldetail/control/timer",function(e,a){new a({leftTime:(p.minisiteDO.endTime-m.systemTime)/1e3,container:t.get("strong",y),tpl:"{date}"}).onStop(function(){location.reload()})})}break;case!!C:t.addClass(l,"black");t.addClass(l,"normalJhs");t.html(y,'<div class="logoIcon">&#xe62a;</div>\u62a2\u8d2d\u5df2\u7ed3\u675f');break;default:t.hide(l);break}if(T){t.wrap(t.get("img",y),t.create('<a class="logoLink" target="_blank" href="'+T+'"></a>'))}})}}},{requires:["dom"]});KISSY.add("malldetail/sku/price",function(e,t){return{init:function(a){_CTKeccb(33,"mod.price.init","trade.sku.focus");var i=a.el,n=a.product,o=true,r=t.query(".tm-price-item",i);if(e.trim(t.html(t.get(".tm-price",i)))===""){n.onChange("config",function(e){t.remove(r);t.html(t.get("dd",i),'<em class="tm-yen">&yen;</em> <span class="tm-price">'+(e.detail.defaultItemPrice||"")+"</span>");t.append(r,t.get("dd",i))})}n.onChange(["config","misc","detailPageTips","tagPrice","originalPrice","buyPrice","currentPromotion","3rdExtraInfo","trade","interPrice","internationalComponent","interTagPrice","interOrignPrice","model","itemPrice","suggestivePromotionPrice","selectedSku"],function(a,l,s,c,d,u,m,f,p,v,h,g,b,_,y,w,k){if(p.tradeDisableTypeEnum===14){if(!t.get("#J_CarMarketTip")){var T=t.get(".tb-metatit",i);t.addClass(i,"tm-recommend-price");if(a.detail.isOnePriceCar){t.html(T,"\u4e00\u53e3\u4ef7")}else{t.html(T,"\u5b98\u65b9\u6307\u5bfc\u4ef7");var S=t.create('<dl id="J_CarMarketTip" style="color: #999;margin: 0 0 0 10px;">\u6ce8\uff1a\u5b9e\u9645\u6210\u4ea4\u4ef7\u8bf7\u548c 4S \u5e97\u8c08\u59a5\uff0c\u4e0d\u5f71\u54cd\u989d\u5ea6</dl>');t.insertAfter(S,i)}}}s=s||{};var C=!(m&&!(m.limitTime&&m.start===false))||a.emPointsBuy,I=m&&m.promText;t.remove(r);var x=f&&f.price;t.html(t.get("dd",i),'<em class="tm-yen">&yen;</em> <span class="tm-price">'+(x||(c&&s.priceDisplayType==1?c.str:d.str))+"</span>");t.append(r,t.get("dd",i));t.removeClass(i,"tm-price-cur");t.removeClass(i,"tm-price-uncertain");if(C){t.addClass(i,I?"tm-price-uncertain":"tm-price-cur");if(g_config&&g_config.hiddenNonBuyprice){t.show(i)}if(!I&&(a.isTwView||a.isWorldView)){e.use("malldetail/sku/priceExtra",function(e,t){t.render({product:n,el:i})})}}else{if(g_config&&g_config.hiddenNonBuyprice){t.hide(i)}}var D;if(!m&&(D=t.get("#J_PromoHintText"))){var L=t.create('<div class="staticPromoTip">');t.html(L,D.innerHTML);var P,M;if(P=t.get(".J_Track",L)){if(P.value)TShop.sendAcAtpanel(P.value)}if(M=t.get(".J_Spm",L)){t.attr(L,"data-spm",M.value)}t.append(L,t.get("dd",i))}if(o){o=false;_CTKeccb(33,"mod.price.show","mod.price.init")}var A=null;var K=null;if(h&&v&&h.foreignPriceName&&v.interTagPrice){var J=v.interOrignPrice;if(g){A=g.str}if(b){K=b.str}if(!A&&v.interTagPrice){A=v.interTagPrice.str}if(!K&&J){K=J.str||J.value}var R=t.get("#J_hkinterOriginPrice");if(J){if(R){R.innerHTML='<dt class="tb-metatit">'+J.name+'</dt><dd><em class="tm-yen">'+h.foreignPriceUnitSymbol+""+'</em><span class="tm-price">'+K+"</span></dd>"}else{t.insertBefore(t.create('<dl class="tm-price-panel" id="J_hkinterOriginPrice"><dt class="tb-metatit">'+J.name+'</dt><dd><em class="tm-yen">'+h.foreignPriceUnitSymbol+""+'</em><span class="tm-price">'+K+"</span></dd></dl>"),"#J_StrPriceModBox")}}}var O=t.get("#J_hkInterTagPrice");if(O&&A){O.innerHTML="&nbsp;&nbsp;"+h.foreignPriceName+"&nbsp;"+h.foreignPriceUnitSymbol+""+A}if(A){t.insertAfter(t.create("<span id='J_hkInterTagPrice'>&nbsp;&nbsp;"+h.foreignPriceName+"&nbsp;"+h.foreignPriceUnitSymbol+""+A+"</span>"),"#J_StrPriceModBox .tm-price")}if(y&&y.duo11Stage==1&&s.showDou11SugPromPrice&&w&&w.str){var E=t.get("#J_PromoPrice");var q=s.dou11PromPriceTitle;var B='<dt class="tb-metatit">'+q+'</dt><dd> <em class="tm-yen">\xa5</em> <span class="tm-price">'+w.str+"</span></dd>";var j=t.get(".tm-fcs-panel .tm-happy11-panel");if(j){t.html(j,B)}else{t.after(t.create("<dl class='tm-happy11-panel'>"+B+"</dl>"),E)}}else{t.remove(t.get(".tm-happy11-panel"))}if(k&&k.skuId&&_&&_.detailPageTipsDO&&_.detailPageTipsDO.skuSubscriptionMap&&_.detailPageTipsDO.skuSubscriptionMap[k.skuId]){t.insertAfter(t.create('<em id="J_depositTip" class="depositTip">\u8ba2\u91d1\u53ef\u62b5\u7528<em class="tm-yen">&yen;</em>'+_.detailPageTipsDO.skuSubscriptionMap[k.skuId]+"\u5143,\u5728\u95e8\u5e97\u786e\u8ba4\u5c3e\u6b3e\u540e\u53ef\u5206"+_.detailPageTipsDO.stage+"\u671f\u652f\u4ed8</em>"),"#J_StrPriceModBox .tm-price")}})}}},{requires:["dom","event"]});KISSY.add("malldetail/sku/productPromotion",function(e,t,a,i){function n(n){_CTKeccb(33,"mod.promoPrice.init","trade.sku.focus");var o=n.el,r,l=n.product;l.onChange(["currentPromotion","currentPriceInfo","currentSuggestivePromotion","originalPrice","buyPrice","promoPrice","detailPageTips","config","model"],function(s,c,d,u,m,p,f,v,h){if(!s){t.hide(o);return}t.show(o);var g="";if(n.showZhe&&m){var b=Number(m.min)*100,_=Number(m.max)*100;var y=Number(u.min)*100,w=Number(u.max)*100;var k=[Math.floor(b*100/y)/10];var T=Math.floor(_*100/w)/10;if(k[0]!=T){k.push(T)}g=k.sort().join("-");if(g=="10"){g=""}}var S=!f||f&&!f.hideIcons;var C=false;var I=false;if(s["promType"]=="tmallBrandMember"){if(s["promText"]&&/\u767b\u5f55/.test(s["promText"])){s["promText"]=s["promText"].replace("\u767b\u5f55",'<a class="J_loginCheckProm">\u767b\u5f55</a>');var x="\u4e13\u4eab";try{x='<em class="tm-promo-type tm-promo-type-red"><s></s>'+'<i class="tm-small-heart">&#xe60f;</i>'+s["promText"].match(/\{(.+)\}/)[1]+"</em>"}catch(D){}s["promText"]=s["promText"].replace(/\{.+\}/,x);S=false;I=false}else{C=true;I=true}}t.html(t.get("dd",o),i({currentPromotion:s,zheStr:g,buyPrice:m,originalPrice:u,promoPrice:p,showIcon:S,showHeartIcon:C,redBackground:I,priceIcons:f.priceIcons,isMeilihui:h&&h.minisiteDO&&h.minisiteDO.validMlhItem,priceOff:h&&h.minisiteDO&&h.minisiteDO.priceOff||0}));if(!(m==u&&(!s||!s.promText))){t.addClass(o,"tm-promo-cur");if(v.isTwView||v.isWorldView){e.use("malldetail/sku/priceExtra",function(e,t){t.render({product:l,el:o})})}}else{t.removeClass(o,"tm-promo-cur")}if(s.limitTimeUTC){e.use(["malldetail/control/timer"],function(e,a){l.onServerTime(function(e){r&&r.clear();var i=(parseInt(s.limitTimeUTC,10)-e)/1e3;r=new a({leftTime:i,container:t.get(".limitTime",o),tpl:"\u8be5\u4fc3\u9500{date}\u540e\u7ed3\u675f"}).onStop(function(){window.location.reload()});_CTKeccb(33,"mod.promoPrice.timer","mod.promoPrice.init")})})}var P=t.get(".J_loginCheckProm");t.css(P,{cursor:"pointer"});P&&a.on(P,"click",function(e){e.halt(true);TShop.onLogin(function(){window.location.reload()})})})}return{init:n}},{requires:["dom","event","malldetail/sku/productPromotion.tpl"]});KISSY.add("malldetail/sku/productPromotion.tpl",function(){return function(e,t){var a={escapehash:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},escapereplace:function(e){return a.escapehash[e]},escaping:function(e){return typeof e!=="string"?e:e.replace(/[&<>"]/gim,this.escapereplace)},detection:function(e){return typeof e==="undefined"?"":e}};var i=function(e){if(typeof console!=="undefined"){if(console.warn){console.warn(e);return}if(console.log){console.log(e);return}}throw e};t=t||{};t.__escapehtml=a;t.__throw=i;"use strict";var e=e||{};var n="";n+="";try{n+="";var r=e.priceIcons;var o=e.promoPrice;var l=e.currentPromotion;var s=e.item;var c=e.priceOff;var d=e.zheStr;var m=e.buyPrice;var u=e.showIcon;var p=e.isMeilihui;var v=e.redBackground;var f=e.showHeartIcon;var g=e.div;var h=e.promo;var b=e.price;var _=e.originalPrice;var y=e.em;var w=e.yen;var k=e.span;var x=e.a;var S=e.index;var C=e.img;var T=e.type;var I=e.s;var q=e.OFF;var D=e.red;var P=e.i;var L=e.small;var A=e.heart;var j=e.nbsp;var E=e.pointAdd;var K=e.zhe;var M=e.p;var J=e.strong;n+='<div class="tm-promo-price">     ';if(m!=_||o!=_){n+='         <em class="tm-yen">&yen;</em> <span class="tm-price">';n+=t.__escapehtml.detection(o.str);n+="</span>     "}n+="     ";if(l.promText){n+="         ";if(l.promText=="\u767b\u5f55\u540e\u786e\u8ba4\u662f\u5426\u4eab\u6709\u6b64\u4f18\u60e0"){n+='             <a class="J_loginCheckProm">\u767b\u5f55</a>\u540e\u786e\u8ba4\u662f\u5426\u4eab\u6709\u6b64\u4f18\u60e0         '}else{n+="             ";n+=t.__escapehtml.detection(l.promText);n+="         "}n+="     "}n+="  ";if(u){n+="         ";if(r&&r.length>0){n+="             ";~function(){for(var e in r){if(r.hasOwnProperty(e)){var a=r[e];var i=e;n+='                 <img src="';n+=t.__escapehtml.escaping(t.__escapehtml.detection(a.logoUrl));n+='" height="14" />             '}}}();n+="         "}else{n+="             ";if(p){n+="                 ";if(c>0){n+='                 <em class="tm-promo-type"><s></s>';n+=t.__escapehtml.escaping(t.__escapehtml.detection(c));n+="%OFF</em>                 "}n+="             "}else if(l.type&&(l.promText||m.str.indexOf("-")==-1)){n+='             <em class="tm-promo-type ';if(v){n+="tm-promo-type-red"}n+='"><s></s>';if(f){n+='<i class="tm-small-heart">&#xe60f;</i>'}n+="";n+=t.__escapehtml.detection(l.type);n+="</em>             "}n+="         "}n+="         &nbsp;&nbsp;         ";if(l.add){n+='<span class="tm-pointAdd">';n+=t.__escapehtml.detection(l.add);n+="</span>"}n+="         ";if(l.gift){n+="";n+=t.__escapehtml.detection(l.gift);n+=""}n+="         ";if(d){n+='<span class="tm-zhe">';n+=t.__escapehtml.detection(d);n+="\u6298</span>"}n+="     "}n+=" </div> <p> ";if(l.limitTime||l.limitTimeUTC){n+='     <span class="limitTime">';if(l.limitTime){n+="";n+=t.__escapehtml.detection(l.limitTime);n+=""}n+="</span> "}n+=" ";if((l.amountRestriction||l.orderAmountRestriction)&&l.promType!="keyJhs"&&l.promType!="jhs"&&l.promType!="wrt"){n+='     <span class="amountRestriction">         ';if(l.amountRestriction){n+="\u6b64\u4f18\u60e0\u9650<strong>";n+=t.__escapehtml.detection(l.amountRestriction);n+="</strong>\u4ef6"}n+="         ";if(l.orderAmountRestriction){n+="\u6bcf\u5355\u9650\u8d2d<strong>";n+=t.__escapehtml.detection(l.orderAmountRestriction);n+="</strong>\u4ef6"}n+="     </span> "}n+=" </p>"}catch(R){t.__throw("Juicer Render Exception: "+R.message)}n+="";return n}});KISSY.add("malldetail/sku/shopPromotion",function(e,t,a,i){function n(e){if(!e)return"";e=typeof e!="object"?new Date(parseInt(e,10)):e;var t=(e.getMonth()+1).toString(),a=e.getDate().toString();var i=e.getHours()+"";var n=e.getMinutes()+"";var o=e.getSeconds()+"";t=t.length==1?"0"+t:t;a=a.length==1?"0"+a:a;i=i.length==1?"0"+i:i;n=n.length==1?"0"+n:n;o=o.length==1?"0"+o:o;return e.getFullYear()+"-"+t+"-"+a+" "+i+":"+n+":"+o}var o,r,l,s,c,d,u,m,p;var f={boxOpen:false,elsUnfold:-1};return{init:function(e){var t=this;l=e.data;r=e.el;m=e.deviceType;if(!l||!l.length){return}c="\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d\u5341";_CTKeccb(33,"focus.shopPromotion.show","trade.sku.focus");t.render()},render:function(){var e=this;var a="";u=new Array(l.length);d=new Array(l.length);for(var o=0;o<l.length;o++){if(l.length==1){l[o].promotionIndex="";l[o].stitle="\u672c\u5e97\u6d3b\u52a8"}else{l[o].stitle="\u6d3b\u52a8";l[o].promotionIndex=c.charAt(o)}var s="tm-gold";if(l[o].houseHoldFor618){s="tm-3c-blue"}var f="",v='<a class="more">\u66f4\u591a'+(m=="pad"?"":"\u4f18\u60e0")+"<s>&#xe62b;</s></a>";if(l[o].isFree){f=l[o].title;v=""}var h=t.create('<div class="tm-shopPromotion-title '+s+'"><dt class="tb-metatit">'+l[o].stitle+l[o].promotionIndex+"</dt><dd>"+f+"</dd>"+v+"</div>");t.append(h,r);l[o].startTime=n(l[o].startTime);l[o].endTime=n(l[o].endTime);var g="";for(var b=0,_=l[o].promPlan.detailMsg.length;b<_;b++){var y=l[o].promPlan.detailMsg[b];if(y&&y.method&&y.method["logistics"]&&y.method["logistics"]["selected"]){if(!g&&y.method["logistics"]["exclusionName"]&&y.method["logistics"]["exclusionName"].length){g=y.method["logistics"]["exclusionName"].join(";")}}}l[o].info=g;l[o].host="detail.tmall.com";a+=i(l[o])}t.append(t.create('<div class="tm-floater-Box  hidden"></div>',{html:a}),r);d=t.query(".tm-shopPromotion-title",r);u=t.query(".floater",r);p=t.get(".tm-floater-Box",r);var w=function(e){var e=e||20;var a=function(t){var a="\u2026";t=t.replace(/\s/g,"");if(t.length<=e){return t}else{return t.substring(0,e)+a}};for(var i=0;i<l.length;i++){if(l[i].isFree){continue}var n=t.query(".noCoupon",u[i]);if(n.length<2&&n.length>0){t.html(t.get("dd",d[i]),a(t.text(t.get("p",n[0]))))}else{t.html(t.get("dd",d[i]),a(t.text(t.get("p",n[0]))+"\uff1b"+t.text(t.get("p",n[1]))))}}};w(30);e.bindEvent()},bindEvent:function(i){var n=function(e){if(e&&(e.target==p||t.contains(p,e.target))){return}t.addClass(p,"hidden");for(var i=0;i<u.length;i++){t.addClass(u[i],"fold")}f["boxOpen"]=false;a.remove(document,"click",n)};function o(i,o){if(!f["boxOpen"]){if(p){t.toggleClass(p,"hidden")}if(u[o]){t.toggleClass(u[o],"fold")}setTimeout(function(){a.on(document,"click",n);f["boxOpen"]=true},1)}else{if(u[o]){t.toggleClass(u[o],"fold")}var r=e.filter(t.query(".floater",p),function(e){return!t.hasClass(e,"fold")&&!t.equals(e,u[o])});if(r.length>0){for(var l=0;l<r.length;l++){t.addClass(r[l],"fold")}}else{if(p){t.toggleClass(p,"hidden")}setTimeout(function(){a.remove(document,"click",n);f["boxOpen"]=false},1)}}}for(var s=0;s<l.length;s++){if(l[s].isFree)continue;a.on(d[s],"click",function(e){o(undefined,this.index);e.preventDefault()},{index:s});a.delegate(u[s],"click",".hd",function(e){o(undefined,this.index);e.preventDefault()},{index:s})}a.delegate(r,"mouseenter mouseleave",".tm-gf-item",function(e){if(e.type=="mouseenter"){t.addClass(t.parent(e.target,"li"),".focus")}else{t.removeClass(t.parent(e.target,"li"),".focus")}})}}},{requires:["dom","event","malldetail/sku/shopPromotion.tpl"]});KISSY.add("malldetail/sku/shopPromotion.tpl",function(){return function(e,t){var a={escapehash:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},escapereplace:function(e){return a.escapehash[e]},escaping:function(e){return typeof e!=="string"?e:e.replace(/[&<>"]/gim,this.escapereplace)},detection:function(e){return typeof e==="undefined"?"":e}};var i=function(e){if(typeof console!=="undefined"){if(console.warn){console.warn(e);return}if(console.log){console.log(e);return}}throw e};t=t||{};t.__escapehtml=a;t.__throw=i;"use strict";var e=e||{};var n="";n+="";try{n+="";var o=e.promPlan;var r=e.plan;var l=e.stitle;var s=e.promotionIndex;var c=e.campaignName;var d=e.startTime;var m=e.endTime;var u=e.index;var p=e.host;var v=e.item;var f=e.info;var h=e.campaignUrl;var g=e.isFree;var _=e.warmUp;var b=e.houseHoldFor618;var y=e.div;var w=e.em;var k=e.a;var x=e.s;var C=e.ul;var S=e.li;var T=e.p;var I=e.music;var q=e.market;var P=e.vippacks;var D=e.id;var L=e.gflist;var A=e.gf;var E=e.img;var j=e.pic;var K=e.span;var M=e.title;n+='<div class="floater fold">     <div class="hd">         <em class ="title">';n+=t.__escapehtml.detection(l);n+="";n+=t.__escapehtml.detection(s);n+="</em>         ";n+=t.__escapehtml.detection(c);n+="         ";if(!g){n+="         ";if(_){n+="             \u4ece";n+=t.__escapehtml.detection(d);n+="\u5f00\u59cb         "}else{n+="             \u5230";n+=t.__escapehtml.detection(m);n+="\u7ed3\u675f         "}n+='         <a class="more unmore">\u6536\u8d77<s>&#xe62c;</s></a>         <a class="more">\u66f4\u591a\u4f18\u60e0<s>&#xe62b;</s></a>         '}n+='     </div>     <ul class="bd">         ';~function(){for(var e in o.detailMsg){if(o.detailMsg.hasOwnProperty(e)){var a=o.detailMsg[e];var i=e;n+='         <li class="';if(!a.method.coupon){n+="noCoupon"}n+='" data-index="';n+=t.__escapehtml.detection(i);n+='">             <p>                 ';if(b){n+="\u73b0\u5728\u4e0b\u5355"}n+="\u6ee1<em>";n+=t.__escapehtml.detection(a.method.man);n+="</em>";if(o.unit==1){n+="\u4ef6"}else if(o.unit==2){n+="\u5143"}n+="                 ";if(b&&a.method.discount&&a.method.discount.selected){n+="                 \uff0c\u5929\u732b\u5e2e\u4f60"}n+="";if(a.method.discount&&a.method.discount.selected){n+="";if(o.unit==2){n+="\u51cf"}n+="<em>";n+=t.__escapehtml.detection(a.method.discount.quota);n+="</em>";if(o.unit==1){n+="\u6298"}else if(o.unit==2){n+="\u5143"}n+=""}n+="                 ";if(a.infinite&&i==o.detailMsg.length-1){n+="                     ,\u4e0a\u4e0d\u5c01\u9876                 "}n+="                 ";if(a.method.logistics&&a.method.logistics.selected){n+="                     ,\u5305\u90ae                 "}n+="                 ";if(a.method.musicPack&&a.method.musicPack.selected){n+="                     ,\u9001<a href='//music.taobao.com/market/music/vippacks.php?id=";n+=t.__escapehtml.detection(a.method.musicPack.packId);n+="' target='_blank'>";n+=t.__escapehtml.detection(a.method.musicPack.packName);n+="</a>                 "}n+="                 ";if(a.method.shopCoupon&&a.method.shopCoupon.selected){n+="                     ,\u9001";n+=t.__escapehtml.detection(a.method.shopCoupon.price);n+="\u5143\u5e97\u94fa\u4f18\u60e0\u5238                 "}n+="                 ";if(a.method.selectFlowWallet&&a.method.flowWallet.selected){n+="                     ,\u9001";n+=t.__escapehtml.detection(a.method.flowWallet.flow);n+="M\u6d41\u91cf                 "}n+="                 ";if(a.method.gift&&a.method.gift.selected){n+='                     ,\u8d60:<a href="//';n+=t.__escapehtml.detection(p);n+="/item.htm?id=";n+=t.__escapehtml.detection(a.method.gift.id);n+='" target="_blank">                         ';if(a.method.gift.nameEscape){n+="";n+=t.__escapehtml.detection(a.method.gift.nameEscape);n+=""}else{n+="";n+=t.__escapehtml.detection(a.method.gift.name);n+=""}n+="                     </a>                 "}n+="                 ";if(a.method.ebook&&a.method.ebook.selected){n+='                     ,\u9001\u7535\u5b50\u4e66:\u300a<a href="//';n+=t.__escapehtml.detection(p);n+="/item.htm?id=";n+=t.__escapehtml.detection(a.method.ebook.ebookId);n+='" target="_blank" title="';n+=t.__escapehtml.detection(a.method.ebook.ebookName);n+='">';n+=t.__escapehtml.detection(a.method.ebook.ebookName);n+="</a>\u300b                 "}n+="                 ";if(a.method.giftPool&&a.method.giftPool.selected){n+="                     ,\u9001\u4efb\u610f";n+=t.__escapehtml.detection(a.method.giftPool.selectNum);n+="\u4ef6\u8d60\u54c1\uff08\u8d60\u5b8c\u5373\u6b62\uff09                 "}n+="                 ";if(a.method.telCharge&&a.method.telCharge.selected){n+="                     ,\u9001";n+=t.__escapehtml.detection(a.method.telCharge.count);n+="\u5143\u6dd8\u8bdd\u8d39                 "}n+="             </p>             ";if(a.method.giftPool&&a.method.giftPool.selected&&a.method.giftPool.giftList&&a.method.giftPool.giftList.length){n+='             <ul class="tm-gflist">                 ';~function(){for(var e in a.method.giftPool.giftList){if(a.method.giftPool.giftList.hasOwnProperty(e)){var i=a.method.giftPool.giftList[e];var o=e;n+='                 <li>                     <a class="tm-gf-item" target="_blank" href="//';n+=t.__escapehtml.detection(p);n+="/item.htm?id=";n+=t.__escapehtml.detection(i.id);n+='">                         <img class="tm-gf-pic" src="';n+=t.__escapehtml.detection(i.picUrl);n+='_60x60.jpg" alt="';n+=t.__escapehtml.detection(i.name);n+='"/>                         <span class="tm-gf-title">';n+=t.__escapehtml.detection(i.name);n+="</span>                     </a>                 </li>                 "}}}();n+="             </ul>             "}n+="         </li>         "}}}();n+='     </ul>     <div class="ft">         ';if(f){n+='<span class="title">\u4e0d\u5305\u90ae\u5730\u533a\uff1a</span>';n+=t.__escapehtml.detection(f);n+=""}n+='         <a class="all" target="_blank" href="';n+=t.__escapehtml.detection(h);n+='">\u6240\u6709\u6d3b\u52a8\u5546\u54c1</a>     </div> </div>'}catch(J){t.__throw("Juicer Render Exception: "+J.message)}n+="";return n}});KISSY.add("malldetail/sku/meta",function(e,t){return{init:function(a){_CTKeccb(33,"view.meta.init","trade.main.init");var i=a.el,n=a.product;var o=t.get("#J_RSPostageCont");if(o){n.onLoad(["isDownShelf","config","itemDO"],function(a,i,r){if(a){t.remove(o);return}if(!t.get("dd",o)){t.html(o,'<dt class="tb-metatit">\u8fd0\u8d39</dt><dd>'+t.html(o)+"</dd>")}if(i.isTwView){e.use("malldetail/sku/freightTw",function(e,t){t.init(n)})}else{e.use("malldetail/sku/freight",function(e,t){t.init({el:o,product:n})})}})}}}},{requires:["dom"]});KISSY.add("malldetail/sku/propertyHandler",function(e,t,a){var i=e.UA,n=document,o=window,r=o.g_config,l;var s=function(i,o){var r=t.query("li",o);var l=t.attr(r,"data-value").split(":")[0];var s=t.query("span",o);var c=n.createElement("i");c.appendChild(n.createTextNode("\u5df2\u9009\u4e2d"));i.onLoad(["config","skuProp","userInfo"],function(a,n,o){function s(e){if(!o||!o.nicker||!a.isShowSizeRecommend){return e(null)}i.onLoad("recommendSku",e)}s(function(a){var i;if(!!a&&a.model){i=a.model.pid+":"+a.model.vid;TShop.sendAtpanel("tmalldetail.37.1",{uid:o.userId,pidvid:i})}e.each(r,function(o){var r=t.attr(o,"data-value");var s=r.split(":")[1];var c="",d="";if(!!a&&i&&r==i){c="<p>"+"\u60a8\u53ef\u80fd\u9002\u5408\uff1a"+a.model.recommendSize+"</p>";var u=t.get("a",o);t.addClass(u,"tm-recommend-size");t.prepend(t.create('<div class="tm-recommend-icon"></div>'),u)}if(n&&n[l]&&n[l][s]&&n[l][s].tip){d=n[l][s].tip}if(!!c||!!d){e.use("malldetail/common/tip",function(e,t){new t(o,c+d,{triggerType:"mouse",align:{points:["bl","tl"],offset:[0,8]},arrow:!(e.UA.ie&&e.UA.ie<8),arrowDir:"top left"})})}})})});var d=t.hasClass(o,"tb-carmodel");i.onLoad("config",function(r){var l=d&&r.carCascade===true;if(!l){var s=t.query("li",o);var c=t.attr(s,"data-value").split(":")[0];var u=t.query("span",o);var m=n.createElement("i");m.appendChild(n.createTextNode("\u5df2\u9009\u4e2d"));e.each(u,function(e){var n=e.parentNode,o=t.parent(e,function(e){return!!e.getAttribute("data-value")}),r=o.getAttribute("data-value");n.hideFocus=true;if(!l){i.onChange("thirdPartyInventory",function(){i.canSelectSkuProp(r,"",function(e){if(e<0){_CTKeccb(33,"trade.sku.propHide","trade.sku.init");t.hide(o)}else{t.show(o)}},{ignoreSelection:true})})}if(1===u.length&&n.style.background===""){i.selectSkuProp(o.getAttribute("data-value"),"")}a.on(n,"click",function(e){e.preventDefault();TShop.sendAtpanel("tmalldetail.13.1",1e4);var a=t.parent(e.target,function(e){return!!e.getAttribute("data-value")}),n=r.split(":");if(t.hasClass(a,"tb-out-of-stock")){return}i.onLoad("selectedSkuProp",function(e){if(e[n[0]]==n[1]){i.deselectSkuProp(n[0],n[1])}else{i.selectSkuProp(n[0],n[1])}})})});i.onChange(["tradeResult","selectedSkuProp"],function(e,a){if(e&&e.level>0&&e.name=="sku"&&!a[c]){t.addClass(t.get(".tb-metatit",t.parent(o,".tb-prop")),"tb-h")}else{t.removeClass(t.get(".tb-metatit",t.parent(o,".tb-prop")),"tb-h")}});i.onChange(["selectedSkuProp","skuPropSelectivity","thirdPartyInventory"],function(a){e.each(u,function(e){var n=t.parent(e,function(e){return!!e.getAttribute("data-value")}),o=n.getAttribute("data-value"),r=o.split(":");if(a[r[0]]==r[1]){t.addClass(n,"tb-selected");n.appendChild(m)}else{t.removeClass(n,"tb-selected");i.canSelectSkuProp(o,"",function(e){if(e<=0){t.addClass(n,"tb-out-of-stock")}else{t.removeClass(n,"tb-out-of-stock")}})}})})}})};return{init:function(i){if(!(l=i.config))return;var n=i.elmProps,o=i.product,r=l.itemDO,c=this,d;var u=l.carCascade===true;_CTKeccb(33,"decision.carCascade.init","app.init");if(l.detail&&l.detail.isCarCascade){_CTKeccb(33,"decision.carCascade.isCar","decision.carCascade.init");var m=t.create('<div class="tb-car-cascade"><div class="tb-cascade-icon">&#xe628;</div><div class="tb-cascade-info"><p id="J_CascadeInfo" class="j_CascadeInfo"></p><span class="tb-cascade-modify j_CascadeInfo">&#xe629;</span><div class="tb-cascade-ww" title="\u54a8\u8be2\u5546\u5bb6">\u54a8\u8be2\u5546\u5bb6<span class="slogo-ww J_WangWang" data-nick="'+l.itemDO.sellerNickName+'" data-tnick="'+l.itemDO.sellerNickName+'" data-encode="true" data-display="inline" data-icon="static"></span></div></div></div>');t.prepend(m,t.get(".tb-sku","#detail"));function p(a,i,n){var r="\u5df2\u5339\u914d\uff0c\u8bf7\u8d2d\u4e70";var l="";if(a===524||a===305||i===""){r="";l="tb-cascade-error";i="\u8bf7\u586b\u5199\u8f66\u578b\u4e3a\u60a8\u7cbe\u786e\u5339\u914d"}else if(a===525){r="\u4e0d\u5339\u914d\uff0c\u4e0d\u5efa\u8bae\u8d2d\u4e70"}else if(a===526){r="\u8f66\u578b\u4fe1\u606f\u4e0d\u5b8c\u6574"}t.html("#J_CascadeInfo",'<span class="tb-cascade-tips">'+r+'</span><a class="tb-cascade-carinfo '+l+'" href="javascript:" title="'+i+'" data-car="'+n+'">'+i+"</a>");if(n){if(u){o.set("selectedCarProp",n)}else{d&&e.each(n.split(","),function(e){o.deselectSkuProp(e.split(":")[0],"")});e.each(n.split(","),function(e){o.selectSkuProp(e,"",true)});d=n}}}e.use("ajax",function(e,t){t({url:"//server-jia.tmall.com/car/checkItemAndManCar.do",data:{itemid:r.itemId,sellerid:r.userId},dataType:"jsonp",jsonpCallback:"jsonpCheckItemAndManCar",cache:true,success:function(t){if(t){if(t.errorCode===305){return p(t.errorCode,"","")}_CTKeccb(33,"decision.carCascade.checkItemUserCar.true","decision.carCascade.isCar");var a="";var i=[];e.each(["brand","car","cotyYear","model"],function(e){if(t.object&&t.object[e+"PropertyId"]&&t.object[e+"PropertyValue"]){i.push(t.object[e+"PropertyId"]+":"+t.object[e+"PropertyValue"]);a+=t.object[e+"Name"]+" "}});var n=i.join(";");p(t.errorCode,a,n)}else{_CTKeccb(33,"decision.carCascade.checkItemUserCar.false","decision.carCascade.isCar")}},timeout:10,error:function(){_CTKeccb(33,"decision.carCascade.checkItemUserCar.error","decision.carCascade.isCar")}})});a.on(".j_CascadeInfo","click",function(){TShop.onLogin(function(){if(c.carSelector){c.carSelector.show();_CTKeccb(33,"decision.carCascade.userClick.repeat","decision.carCascade.userClick")}else{_CTKeccb(33,"decision.carCascade.userClick.once","decision.carCascade.userClick");e.use(["mui/kissy-polyfill/","mui/car-selector/index-pc"],function(e,t,a){o.onLoad("token",function(t){c.carSelector=new a({isSave:true,token:t});c.carSelector.show();c.carSelector.on("done",function(t){var a=[];var i="";e.each(["brand","type","year","model"],function(e){if(t&&t.values&&t.values[e]&&t.values[e]["propertyId"]&&t.values[e]["valueId"]){a.push(t.values[e]["propertyId"]+":"+t.values[e]["valueId"]);i+=t.values[e]["name"]+" "}else{a.push("")}});var n=a.join(";");_CTKeccb(33,"decision.carCascade.userClick.save","decision.carCascade.userClick");e.use("ajax",function(e,t){t({url:"//server-jia.tmall.com/car/checkItemAndManCar.do",data:{itemid:l.itemDO.itemId,sellerid:l.itemDO.userId,pvs:n},dataType:"jsonp",jsonpCallback:"jsonpCheckItemAndManCar",cache:true,success:function(e){if(e){if(e.errorCode===305){TShop.login()}p(e.errorCode,i,n);_CTKeccb(33,"decision.carCascade.userClick.true","decision.carCascade.userClick.save")}else{_CTKeccb(33,"decision.carCascade.userClick.false","decision.carCascade.userClick.save")}},timeout:10,error:function(){_CTKeccb(33,"decision.carCascade.userClick.error","decision.carCascade.userClick.save")}})})}).on("error",function(e){_CTKeccb(33,"decision.carCascade.userClick.selectError","decision.carCascade.userClick")})})})}})})}e.each(n,function(e){s(o,e)});_CTKeccb(33,"trade.sku.init","trade.main.init")}}},{requires:["dom","event"]});KISSY.add("malldetail/sku/main",function(S,DOM,NODE,Event,Action,PromoBanner,Focus,Meta,Indices,util,Amount,PropertyHandler,PadAdapte){var $=NODE.all;var hasMsg;var timer=null;function showMsg(e,t,a){hasMsg=true;S.use("malldetail/sku/skuMsg",function(i,n){n.show(e,t,a)})}function hideMsg(e){if(!hasMsg){return}S.use("malldetail/sku/skuMsg",function(t,a){a.hide(e)})}return{init:function(cfg){_CTKeccb(33,"trade.main.init","view.main.init");setTimeout(function(){_CTKeccb(33,"trade.buylink.none","trade.main.init",{reject:["trade.buylink.init","trade.bid.init","trade.main.down"]});_CTKeccb(33,"trade.cartlink.none","trade.main.init",{reject:["trade.cartlink.init","trade.bid.init","trade.main.down"]})},4096);var win=window,doc=document;var g_config=win.g_config;var config=cfg.config,product=cfg.product;var el=DOM.get(".tb-wrap",DOM.get(".tb-property","#detail"));product.onLoad(["model"],function(e){if(config&&config.detail&&config.detail.isNewAttraction){var t=$(".tb-detail-hd p");S.each(t,function(e){var t=$(e);if(!t.hasClass("hitp")){t.addClass(".newp")}})}if(e&&e.detailPageTipsDO&&e.detailPageTipsDO.prime){S.use("malldetail/sku/mtHead",function(e,t){t.init(config)})}});product.onLoad(["internationalComponent"],function(e){if(e){var t=e.nationalIcon;var a=e.fromName;if(t&&a){DOM.before(DOM.create("<div class='fromName'><img src='"+t+"' width='20' height='20' />&nbsp;"+a+"</div>"),DOM.get(".tb-detail-hd h1"))}}});product.onChange(["servicePromise"],function(e){if(e&&e.show){var t=e.servicePromiseList;var a=e.titleInformation;var i=[];for(var n=0,o=t.length;n<o;n++){var r=t[n];var l="";if(r.rank>0){l="<s>T"+r.rank+"</s>"}i.push("<li>"+l+"<a href='"+r.link+"' title='"+r.description+"' target='_blank' >"+r.displayText+"</a></li>")}DOM.html(".tb-serPromise",i.join(""));var s="",c="";if(a&&a.length&&(c=a[0].icon)){s='<a target="_blank" href="'+a[0].link+'"><img class="ylxb-img" src="'+c+'" height="18" /></a>'}else if(a&&a.length){s=a[0].displayText+'<a class="tm-help" title="'+a[0].description+'" target="_blank" href="'+a[0].link+'">?</a>'}var d=DOM.get(".tb-detail-sellpoint");if(d){DOM.html(d,s)}else{var u="<div class='tb-detail-sellpoint'>"+s+"</div>";DOM.append(DOM.create(u),".tb-detail-hd")}}});var titlePreEl;product.onChange("detailPageTips",function(e){if(!e||!e.itemTitle){titlePreEl&&DOM.html(titlePreEl,"");return}if(!titlePreEl){DOM.insertBefore(titlePreEl=DOM.create('<h3 class="tm-titlePre"></h3>'),DOM.get("h3",".tb-detail-hd"))}_CTKeccb(33,"trade.main.titlePre","trade.main.init");DOM.html(titlePreEl,e.itemTitle)});product.onChange("canBuyStatus",function(){product.canBuy({level:4},function(e){hideMsg("canBuy");if(e.level&&e.message){showMsg(e.message,null,"canBuy")}})});var actionEl=DOM.get(".tb-action","div.tb-sku");if(actionEl){Action.init({el:actionEl,showMsg:function(e,t){return showMsg(e,t)},hideMsg:function(){return hideMsg()},product:product});product.onLoad("trade",function(e){if(e.tradeDisableTypeEnum===14){var t=DOM.get("#J_CarFinance");if(!t){t=DOM.create('<dl id="J_CarFinance"><dt class="tb-metatit">\u7533\u8bf7\u5206\u671f</dt><dd>\u6700\u9ad8\u5206\u671f\u989d\u5ea6 <span class="price" style="font-family: arial"></span></dd></dl>')}var a=DOM.get(".price",t);product.onChange("buyPrice",function(e){var t=null;var i=.8;if(e.min!==e.max){t=(e.min*100*i/100).toFixed(2)+"-";t+=(e.max*100*i/100).toFixed(2)}else{t=(e.str*100*i/100).toFixed(2)}DOM.html(a,"&yen;"+t)});DOM.insertBefore(t,actionEl)}})}var focusEl=DOM.get(".tm-fcs-panel",el);if(focusEl){product.onChange(["currentSuggestivePromotionList","currentPromotionList","model"],function(e,t,a){if(DOM.get(".tm-focus-banner")!=null)return;if(a.minisiteDO&&a.minisiteDO.validMlhItem||a.detailPageTipsDO&&a.detailPageTipsDO.showDou11Style||S.filter([].concat(e||[]).concat(t||[]),function(e){return e.promType=="keyJhs"||e.promType=="jhs"||e.promType=="jhs_warm"||e.promType=="tmallBigMarkDown"||e.promType=="tmallBrandMember"||e.promType=="awp"||e.promType=="wrt"})[0]){var i=DOM.create('<dl class="tm-focus-banner"><dt class="tb-metatit"></dt><dd></dd></dl>');DOM.insertBefore(i,focusEl);S.use("malldetail/sku/promoBanner",function(e,t){t.init({el:i,product:product})})}});Focus.init({el:focusEl,product:product})}var hotItemEl=DOM.get("#J_HotItem");if(config.itemDO.isHotItem){if(!hotItemEl){hotItemEl=DOM.create('<div id="J_HotItem" class="tm-clear"></div>');DOM.insertBefore(hotItemEl,actionEl)}S.use("malldetail/sku/hotitem",function(e,t){t.init({actionEl:actionEl,hotItemEl:hotItemEl,product:product})})}var metaEl=DOM.get(".tb-meta",el);{if(DOM.get("#J_RSPostageCont",focusEl)){DOM.prepend(DOM.get("#J_RSPostageCont",focusEl),DOM.get(".tb-meta",el))}Meta.init({el:metaEl,product:product})}var stepRate=config.itemDO.stepPaymentFirstStepPriceRate;if(stepRate&&DOM.get(".tm-step-panel")){product.onChange(["currentPromotion"],function(e){if(e&&!(e.limitTime&&e.start===false)){DOM.html(".J_stepPriceTitle","\u4fc3\u9500\u4ef7x")}});product.onChange(["buyPrice"],function(e){var t,a="<s>\xa5</s><span>"+(e.min*stepRate).toFixed(2)+"</span>";if(e.min!=e.max){a+=" - <span>"+(e.max*stepRate).toFixed(2)+"</span>"}t="\u9996\u6b21\u4ec5\u652f\u4ed8"+a+"\uff0c\u5269\u4f59\u91d1\u989d\u5206\u9636\u6bb5\u4ed8\u6b3e";DOM.html(".tm-step-first",t);DOM.addClass(DOM.parent(".tm-step-first"),"tm-step-action")});Event.on(".J_stepRule","mouseover touchstart",function(){DOM.show(".tm-step-rule")});Event.on(".J_stepRule","mouseout touchend",function(){DOM.hide(".tm-step-rule")})}var indicesEl=DOM.get(".tm-ind-panel",el);if(!indicesEl&&cfg.autoFill){indicesEl=DOM.create('<ul class="tm-ind-panel"></ul>');DOM.append(indicesEl,el)}indicesEl&&Indices.init({autoFill:cfg.autoFill,onReviewClick:cfg.onReviewClick,onSellCountClick:cfg.onSellCountClick,el:indicesEl,product:product,config:config});product.onChange(["currentAmountRestrict","amount","amountMultiple","config","currentInventory","selectedSku","currentPromotion","buyPrice"],function(e,t,a,i,n,o,r){hideMsg("promotionlimited");if(r&&(r.amountRestriction||r.buyerAmountRestriction)&&r.promType!="keyJhs"&&r.promType!="jhs"&&r.promType!="wrt"){if(r&&r.amountRestriction&&t*a>r.amountRestriction){showMsg("\u8be5\u4f18\u60e0\u9650\u8d2d"+r.amountRestriction+"\u4ef6\uff0c\u8d85\u8fc7"+r.amountRestriction+"\u4ef6\u540e\u5c06\u4e0d\u4eab\u53d7\u6b64\u4f18\u60e0\u4ef7",null,"promotionlimited")}else if(r.buyerAmountRestriction&&t*a>r.buyerAmountRestriction){showMsg("\u8be5\u4f18\u60e0\u6bcf\u4eba\u9650\u8d2d"+r.buyerAmountRestriction+"\u4ef6\uff0c\u8d85\u8fc7"+r.buyerAmountRestriction+"\u4ef6\u540e\u5c06\u4e0d\u4eab\u53d7\u6b64\u4f18\u60e0\u4ef7",null,"promotionlimited")}}});var amountEl=S.get("#J_Amount");if(amountEl){var emStock=DOM.get("#J_EmStock");var initStockAndRestrict=function(e){if(!DOM.hasClass(amountEl,"tm-hideAmount")){S.use("malldetail/sku/stock",function(t,a){a.init({el:emStock,hideStock:e,product:product})})}else{DOM.remove(emStock)}};if(emStock){initStockAndRestrict()}else{product.onLoad("currentAmountRestrict",function(e){if(e){initStockAndRestrict(true)}})}Amount.init({el:amountEl,product:product})}product.onLoad("skuMap",function(e){if(!e){return}for(var t in e){if(e[t]["shipTime"]){S.use("malldetail/sku/shiptime",function(e,t){t.init({parentEl:DOM.parent("#J_Amount"),product:product})});break}}});var tbidEl=DOM.get("#tbid-container");if(tbidEl){var bidEl=DOM.get("#J_BidRecord");if(bidEl&&config.detail.goNewAuctionFlow&&window.TAOBAO_PAIMAI_BIDSAU){_CTKeccb(33,"mod.bidRecord.init","trade.main.init");try{var data=window.JSON?window.JSON.parse(window.TAOBAO_PAIMAI_BIDSAU.data):eval("("+window.TAOBAO_PAIMAI_BIDSAU.data+")");DOM.html(bidEl,data.totalCnt);_CTKeccb(33,"mod.bidRecord.show","mod.bidRecord.init")}catch(e){}}_CTKeccb(33,"trade.bid.init","trade.main.init");S.use("malldetail/css/auction.css",function(e,t){_CTKeccb(33,"trade.bid.run","trade.bid.init");t.init({appName:"malldetail",container:tbidEl});_CTKeccb(33,"trade.bid.runSuccess","trade.bid.run")})}var elTbkey=DOM.get(".tb-key","#detail");var inited=false;product.onChange("tradeResult",function(e){var t=DOM.get("#J_sellerCspu");if(e&&e.level>0&&e.name=="sku"){DOM.addClass(elTbkey,"tb-attention");DOM.css(t,"display","none");if(!inited){inited=true;DOM.insertBefore(DOM.create('<p class="tb-note-title">\u8bf7\u9009\u62e9\u60a8\u8981\u7684\u5546\u54c1\u4fe1\u606f<b class="J_PanelCloser">x</b></p>'),DOM.get("div.tb-skin",elTbkey).firstChild);Event.on(DOM.get("b.J_PanelCloser",elTbkey),"click",function(){product.set("tradeResult","null")});_CTKeccb(33,"trade.sku.attention","trade.main.init")}}else{DOM.removeClass(elTbkey,"tb-attention");DOM.css(t,"display","block")}});var regionSellerServer=DOM.get("#J_regionSellServer");var supService=function(e,t){product.onLoad("model",function(a){if(a.switcherDO&&a.switcherDO.otherserviceDisable){DOM.hide(regionSellerServer)}else{if(e&&e.list&&e.list.length){supService=function(e,t){if(!regionSellerServer){regionSellerServer=DOM.create('<dl id="J_regionSellServer" class="tm-clear tb-hidden tb-prop" data-spm="1000987"></dl>');DOM.insertAfter(regionSellerServer,".tb-amount")}S.use("malldetail/sku/service",function(a,i){i.render({data:e,selectedService:t,title:config.detail&&config.detail.isShowEcityBasicSign?"\u589e\u503c\u670d\u52a1":"",container:regionSellerServer,product:product})});DOM.show(regionSellerServer)};return supService(e,t)}else{DOM.hide(regionSellerServer)}}})};product.onChange(["currentService","service"],function(e,t){product.onLoad("selectedService",function(a){e=e||t;if(e&&e.list&&e.list.length){supService(e,a)}else{DOM.hide(regionSellerServer)}})});product.onLoad("detailPageTips",function(e){if(e){var t=e.serviceIcons;var a="";S.each(t,function(e){a+='<li><a href="'+e.link+'" target="_blank">'+e.title+"</a></li>"});if(a){var i=DOM.get(".tb-serPromise");DOM.prepend(DOM.create(a),i)}}});product.onLoad(["itemDO","model","progressiveInfo"],function(e,t,a){if(!a||!a.tryBeforeBuy){return}if(t.switcherDO&&t.switcherDO.exclusiveServiceDisable){return}var i=DOM.create('<dl class="tm-exclusiveService tb-prop"></dl>');S.use("malldetail/sku/exclusiveService",function(e,t){t.init({product:product,el:i});DOM.insertAfter(i,".tb-amount")})});var ladeEl=DOM.get("#J_TladeMode");if(ladeEl){S.use("malldetail/sku/skuLade",function(e,t){t.init({el:ladeEl,product:product})})}product.onLoad("userInfo",function(e){_CTKeccb(33,"cps.init","trade.main.init");S.getScript("//g.alicdn.com/mm/cps/trace.js?t=20130926_"+g_config.t,function(){var t=e&&e.juKeBuyerLogin?4:2;try{_CTKeccb(33,"cps.run","cps.init",{group:t});window.CPS.trace({type:1,subtype:t,itemid:config.itemDO.itemId,sellerid:config.itemDO.userId});_CTKeccb(33,"cps.init","cps.run",{group:t})}catch(a){}})});var elmProps=DOM.query(".J_TSaleProp","#detail");if(elmProps.length||config.detail.isCarCascade){PropertyHandler.init({product:product,elmProps:elmProps,config:config})}product.onLoad("pickupPoints",function(e){if(e){var t=DOM.get("#J_PickupArea");S.use(["malldetail/sku/pickupPoint","malldetail/common/select","malldetail/common/select.css"],function(a,i){_CTKeccb(33,"mod.pickupPlace.init","trade.main.init");i.init({el:DOM.get("dd",t),product:product,pickupPoints:e})})}});var skuEl=DOM.get(".tb-sku","#detail");product.onLoad(["config","itemDO","userInfo","deviceType","internationalComponent"],function(e,t,a,i,n){var o=elmProps&&elmProps.length>0&&elmProps[0];if(n&&n.sizeCartUrl&&o){DOM.append(DOM.create('<div class="tm-interSizeHelper j_dialogSize">\u56fd\u9645\u5c3a\u7801\u52a9\u624b</div>'),o)}if(!e.isShowSizeHelper||!e.sizeHelperEnable||!o){return}TShop.sendAtpanel("tmalldetail.33.1");_CTKeccb(33,"mod.sizeHelper.init","trade.main.init");var r;var l=false;var s;if(i==="pad"){r=DOM.create('<div class="tm-sizeHelper-btn"> <i>&nbsp;</i>\u5c3a\u7801\u8868 </div>');DOM.prepend(r,skuEl)}else{r=DOM.create('<div class="tm-sizeHelper">\u5c3a\u7801\u52a9\u624b</div>');DOM.append(r,o)}Event.on(r,"click tap",function(){TShop.sendAtpanel("tmalldetail.37.2",{uid:a&&a.userId||null});if(l){s&&s.show();return}product.onLoad(["itemDO","token"],function(e,t){S.use("fushi/sizehelper-pc/sizehelper-pc",function(a,i){s=new i({typeId:e.categoryId,itemId:e.itemId,_tb_token_:t});l=true;s.show()})})})});product.onLoad("deviceType",function(e){if(e==="pad"){PadAdapte.init({el:skuEl,cfg:config,product:product})}});if(skuEl){S.use("malldetail/other/limitedPurchase",function(e,t){t.init({el:skuEl,product:product})})}var togglerEl=DOM.get("#J_Toggler");if(togglerEl){S.use("malldetail/sku/paymethods",function(e,t){product.onLoad(["delivery","bucketId","model"],function(e,a,i){t.init({product:product,delivery:e,el:DOM.parent(togglerEl),bucketId:a,promiseDisable:i.switcherDO&&i.switcherDO.promiseDisable,payDisable:i.switcherDO&&i.switcherDO.payDisable,pageType:config&&config.detail&&config.detail.pageType})})})}var lastPropsElm=elmProps&&elmProps[elmProps.length-1];if(lastPropsElm){product.onLoad(["skuMap","itemDO","config","bucketId"],function(e,t,a,i){if(util.bucketStat(i,window.g_config["cspuBucketTestIdArray"])){S.use(["malldetail/sku/cspu","malldetail/sku/cspu.tpl","detail-model/cspu","malldetail/sku/cspu.css"],function(i,n){n.init({ellast:lastPropsElm,product:product,skuMap:e,spuId:t["spuId"],cspuCategorySwitch:t["cspuCategorySwitch"],apiUrl:a["initCspuExtraApi"]})})}})}if(DOM.get("#J_ExSelect")){S.use("malldetail/sku/codeexchange",function(e,t){t.init()})}product.onLoad(["config"],function(e){var t=e.detail;if(t&&t.isPrescriptionDrug){var a=DOM.get("#J_LinkBasket");DOM.hide(a);var i=DOM.get("#J_DetailMeta .tb-wrap");DOM.append(DOM.create('<div class="cfy-wrap"><dl><dt></dt><dd>\u8be5\u836f\u4e3a\u5904\u65b9\u836f\u3001\u5efa\u8bae\u4f60\u53bb\u533b\u9662\u5c31\u8bca\u6216\u51ed\u533b\u751f\u7684\u5904\u65b9\u5230\u5c31\u8fd1\u7684\u836f\u623f\u9009\u8d2d\u3002</dd></dl></div>'),i)}});product.onChange("relatedAuctions",function(e){if(e&&e.relatedAuctions&&e.relatedAuctions.length){var t=win.g_config.bizTag,a,i;if(t&4096&&e.version){S.use("malldetail/other/relateGroup, malldetail/other/relateGroup.css",function(t,n){switch(e.version){case 1:a=DOM.create('<div class="tm-bd-nav"></div>');DOM.insertBefore(a,"#detail");i="top";break;case 2:a=DOM.create('<dl class="tm-relate-wrapper tm-clear" id="J_relateGroup"></dl>');DOM.prepend(a,"div.tb-sku");i="right";break;default:break}DOM.data(a,"dir",i);n.init(a,e)})}}});if(cfg.showDownShelf!==false){product.onChange("isDownShelf",function(e){if(!e){return}_CTKeccb(33,"trade.main.down","trade.main.init");var t;if(!DOM.get("#J_Sold-out-recommend")){var a='<ul class="tb-meta"><li class="sold-out-recommend" id="J_Sold-out-recommend">								<div class="sold-out-info"><div class="sold-out-left"><strong class="sold-out-tit">\u6b64\u5546\u54c1\u5df2\u4e0b\u67b6</strong>\uff08<a class="sold-out-help" target="_blank" href="//service.taobao.com/support/knowledge-1102683.htm">?</a>\uff09</div><div class="sold-out-right"></div></div>								<div id="J_FE_soldout"></div>							</li></ul>';var i=DOM.get(".tm-fcs-panel","#detail");if(i){var n;while(n=DOM.next(i)){DOM.remove(n)}DOM.insertAfter(DOM.create(a),i);t=DOM.create('<div class="ald"></div>');DOM.append(t,"#J_FE_soldout")}}if(config.detail.showDownShelfRecommend!==false){if(!t){t=DOM.get(".ald",DOM.get("#J_Sold-out-recommend"))}DOM.addClass(t,"ald-03037");S.use("malldetail/recommend/downShelf",function(e,a){a.init({el:t,product:product})})}})}var showErrorTip=function(){DOM.show(".sold-out-error");clearTimeout(timer);timer=setTimeout(function(){DOM.hide(".sold-out-error")},3e3)};var preSellState=function(e){var t="";if(e&&e.sellOutStatus){_CTKeccb(33,"trade.main.hasPreSell","trade.main.sellout");if(e.reserved){_CTKeccb(33,"trade.main.preSellDone","trade.main.hasPreSell");t='<div class="sold-out-success">';if(e.sellOutStatus===2){_CTKeccb(33,"trade.main.preSellNotDone.hasUrl","trade.main.preSellDone");t+='<p><span>&#xe60d;</span>\u5df2\u5f00\u542f\u63d0\u9192</p><a href="'+e.jumpUrl+'" target="_blank" title="\u53bb\u9886\u5956">\u53bb\u9886\u5956</a>'}else{t+='<p class="sold-out-success1"><span>&#xe60d;</span>\u5df2\u5f00\u542f\u63d0\u9192</p>';_CTKeccb(33,"trade.main.preSellNotDone.noUrl","trade.main.preSellDone")}t+='</div><div class="sold-out-appinfo"><p>\u5f00\u542f\u6210\u529f\u540e\uff0c\u5f53\u6709\u8d27\u65f6\uff0c\u6211\u4eec\u5c06\u7528<span>\u624b\u673a\u5929\u732b</span>\u7684\u6d88\u606f\u901a\u77e5\u60a8\u3002\u626b\u63cf\u53f3\u4fa7\u4e8c\u7ef4\u7801\u7acb\u5373\u4e0b\u8f7d\u624b\u673a\u5929\u732b\uff0c\u5e76\u6253\u5f00\u7cfb\u7edf\u901a\u77e5\u54e6~</p><img src="//img-tmdetail.alicdn.com/tfscom/TB1sNAiLXXXXXc0XFXXwu0bFXXX.png" alt="\u626b\u7801\u4e0b\u8f7d\u732b\u5ba2" /></div>';DOM.html(".sold-out-right",t)}else{_CTKeccb(33,"trade.main.preSellNotDone","trade.main.hasPreSell");if(e.sellOutStatus===1){_CTKeccb(33,"trade.main.preSellNotDone.noUrl","trade.main.preSellNotDone");t='<a class="sold-out-remind" data-activityId="'+e.activityId+'" data-reservedModuleId="'+e.reservedModuleId+'" href="javacript:" title="\u5f00\u542f\u6709\u8d27\u63d0\u9192">\u5f00\u542f\u6709\u8d27\u63d0\u9192</a><p class="sold-out-error">\u5f00\u542f\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01</p>'}else if(e.sellOutStatus===2){_CTKeccb(33,"trade.main.preSellNotDone.hasUrl","trade.main.preSellNotDone");t='<a class="sold-out-remind sold-out-url" data-activityId="'+e.activityId+'" data-reservedModuleId="'+e.reservedModuleId+'" href="javacript:" title="\u5f00\u542f\u6709\u8d27\u63d0\u9192(\u7acb\u5373\u5f00\u542f\u6709\u597d\u793c)">\u5f00\u542f\u6709\u8d27\u63d0\u9192<span>(\u7acb\u5373\u5f00\u542f\u6709\u597d\u793c)</span></a><p class="sold-out-error">\u5f00\u542f\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01</p>'}DOM.html(".sold-out-right",t);Event.on(".sold-out-remind","click",function(t){var a=this;_CTKeccb(33,"trade.main.preSellNotDone.click","trade.main.preSellNotDone");TShop.onLogin(function(){product.onLoad(["token"],function(t){S.use("ajax",function(i,n){n({url:"//xinshoufa.tmall.com/activity/act/reserve.jsonp",data:{activityId:DOM.attr(a,"data-activityId"),reserveId:DOM.attr(a,"data-reservedModuleId"),source:TShop.detector.deviceType=="pad"?"pad":"pc",from:"detail",token:t},dataType:"jsonp",jsonpCallback:"jsonpXinShouFa",cache:true,success:function(t){if(t&&t.success){_CTKeccb(33,"trade.main.preSellNotDone.click.true","trade.main.preSellNotDone");e.reserved=true;preSellState(e)}else{if(t.errorCode===118){_CTKeccb(33,"trade.main.preSellNotDone.click.false.preSellDone","trade.main.preSellNotDone");e.reserved=true;preSellState(e)}else{_CTKeccb(33,"trade.main.preSellNotDone.click.false","trade.main.preSellNotDone");showErrorTip()}}},timeout:10,error:function(){_CTKeccb(33,"trade.main.preSellNotDone.click.error","trade.main.preSellNotDone");showErrorTip()}})})})})})}}else{DOM.css(".sold-out-left",{width:"auto"})}};product.onLoad("model",function(e){_CTKeccb(33,"trade.main.sellout","trade.main.init");preSellState(e.sellOutDO)})}}},{requires:["dom","node","event","malldetail/sku/action","malldetail/sku/promoBanner","malldetail/sku/focus","malldetail/sku/meta","malldetail/sku/indices","malldetail/common/util","malldetail/sku/skuAmount","malldetail/sku/propertyHandler","malldetail/sku/padadapte"]});KISSY.add("malldetail/sku/shiptime",function(e,t){return{init:function(e){var a,i,n=e.parentEl,o=e.product;_CTKeccb(33,"mod.shiptime.init","trade.main.init");o.onChange("selectedSku",function(e){if(e&&e["shipTime"]){if(!i){a=t.create('<div class="tb-prop tm-clear tb-hidden"><span class="tb-metatit">\u53d1\u8d27\u65f6\u95f4</span><span id="J_ShipTime"></span></div>');t.insertBefore(a,n);i=t.get("#J_ShipTime",a);_CTKeccb(33,"mod.shiptime.show","mod.shiptime.init")}t.removeClass(a,"tb-hidden");i.innerHTML=e["shipTime"]}else{t.addClass(a,"tb-hidden")}})}}},{requires:["dom"]});KISSY.add("mui/amount",function(e,t,a,i,n){var o="mui-amount-";var r=o+"wrap",l=o+"increase",s=o+"decrease",c=o+"input";function d(t){d.superclass.constructor.call(this,t);e.mix(t,{defVal:1,step:1},false,null,false);this.cfg=t;this._init()}e.extend(d,i);e.augment(d,e.EventTarget);e.augment(d,{_init:function(){var e=this;var i=this.cfg.product;i.onLoad("deviceType",function(i){e.widgetEl=a.get("."+r,e.cfg.container);if(!e.widgetEl){e.widgetEl=a.create('<span class="'+r+'"></span>');e.inputEl=a.create('<input type="text" class="tb-text '+c+'" value="'+e.cfg.defVal+'" maxlength="8" title="\u8bf7\u8f93\u5165\u8d2d\u4e70\u91cf"/>');e.increaseEl=a.create('<span class="'+l+'"></span>');e.decreaseEl=a.create('<span class="'+s+'"></span>');a.append(e.inputEl,e.widgetEl);a.append(e.increaseEl,e.widgetEl);a.append(e.decreaseEl,e.widgetEl)}else{e.inputEl=a.get("."+c,e.cfg.container);e.increaseEl=a.get("."+l,e.cfg.container);e.decreaseEl=a.get("."+s,e.cfg.container)}a.prepend(e.widgetEl,e.cfg.container);e.set("amount",e.cfg.defVal);if(i=="pad"){e.incresePadEl=a.create('<span class="'+l+'">&#xe627;</span>');e.decreasePadEl=a.create('<span class="'+s+'">&#xe616;</span>');a.insertBefore(e.incresePadEl,e.inputEl);a.insertAfter(e.decreasePadEl,e.inputEl)}t.on(e.cfg.container,"click",function(t){var i=t.target;var n=e.get("amount");if(a.hasClass(i,s)){e.setValue(n-e.cfg.step)}else if(a.hasClass(i,l)){e.setValue(n+e.cfg.step)}});t.on(e.inputEl,"keyup",function(){e.inputEl.value&&e.setValue(e.inputEl.value)});t.on(e.inputEl,"change",function(){e.setValue(e.inputEl.value)})})},setValue:function(e){var e=(!isNaN(e=parseInt(e,10))&&e)>0?e:1;this.set("amount",e);if(this.inputEl.value!=e){this.inputEl.value=e}},onValueChange:function(t){if(e.isFunction(t)){this.on("afterAmountChange",t)}},focus:function(){this.inputEl.focus()},hide:function(){a.hide(this.widgetEl)}});return d},{requires:["event","dom","base","malldetail/common/template"]});KISSY.add("malldetail/sku/skuAmount",function(e,t,a){function i(e,i,n){var o="<select>",r=n.detail.quantityList;for(var l=0;l<r.length;l++){o+='<option value="'+r[l]+'">'+r[l]+"</option>"}o+="</select>";o=t.create(o);t.prepend(o,e);i.onChange("amount",function(e){var t=o.options,a=t.length;if(o.selectedIndex>=0&&t[o.selectedIndex].value==e){return}for(var i=0;i<a;i++){if(t[i].value==e){o.selectedIndex=i;return}}});a.on(o,"change",function(e){if(o.selectedIndex<0){return}i.set("amount",o.options[o.selectedIndex].value)});_CTKeccb(33,"trade.amountSelect.show","trade.amountInput.show")}return{init:function(a){var n=a.el;var o=a.product;_CTKeccb(33,"trade.skuAmount.init","trade.main.init");e.use("mui/amount",function(e,a){var r=new a({container:n,product:o});r.onValueChange(function(e){o.onLoad("amount",function(t){o.set("amount",e.newVal)})});o.onChange(["amount","currentAmountRestrict"],function(e,t){r.setValue(e)});o.onChange(["amountMultiple"],function(e){if(e>1){t.insertBefore(t.create('<span class="tm-amount-times"><s class="s1">X</s>&nbsp;<s class="s2">'+e+"</s>&nbsp;\u4ef6</span>"),t.get("#J_EmStock"))}});_CTKeccb(33,"trade.amountInput.show","trade.skuAmount.init");o.onLoad(["itemPrice","config"],function(e,t){if(e&&!e.promType&&t.detail.quantityList&&t.detail.quantityList.length>0){r.hide();i(n,o,t)}})})}}},{requires:["dom","event"]});KISSY.add("malldetail/sku/stock",function(e,t){function a(e,a,i,n,o){var r=typeof e,l=[];if(i&&i.restrictAmount){if(r==="number"&&e<=i.amountCanBuy)return;if(i.restrictAmount==i.amountCanBuy||r=="undefined"){l.push("\u6bcf\u4eba\u9650\u8d2d"+i.restrictAmount+"\u4ef6");_CTKeccb(33,"mod.amountRestrict.show.2","mod.stock.init")}else if(i.amountCanBuy>0){l.push("\u6bcf\u4eba\u9650\u8d2d"+i.restrictAmount+"\u4ef6\uff0c\u60a8\u8fd8\u53ef\u8d2d\u4e70"+i.amountCanBuy+"\u4ef6");_CTKeccb(33,"mod.amountRestrict.show.1","mod.stock.init")}else{l.push("\u6bcf\u4eba\u9650\u8d2d"+i.restrictAmount+"\u4ef6\uff0c\u60a8\u5df2\u8d85\u8fc7\u9650\u8d2d\u6570");_CTKeccb(33,"mod.amountRestrict.show.0","mod.stock.init")}}if(a&&a.buyerAmountRestriction&&(!i||!i.restrictAmount||a.buyerAmountRestriction<i.restrictAmount)){l.push("\u8be5\u4f18\u60e0\u6bcf\u4eba\u9650\u8d2d"+a.buyerAmountRestriction+"\u4ef6");_CTKeccb(33,"mod.amountRestrict.show.4","mod.stock.init")}if(l.length){t.html(n,"\uff08"+l.join(" ")+"\uff09")}if(i&&!i.restrictAmount&&i.moneyCanBuy){t.html(n,"\uff08\u6bcf\u4eba\u9650\u8d2d"+i.moneyCanBuy+"\u5143\uff09");_CTKeccb(33,"mod.amountRestrict.show.3","mod.stock.init")}}return{init:function i(e){_CTKeccb(33,"mod.stock.init","trade.main.init");var i=e.product;var n=t.get("#J_StockTips");var o=e.hideStock;var r=e.el;i.onChange(["currentInventory","soldArea","currentPromotion","itemPrice","currentAmountRestrict","isAreaRestricted","model"],function(e,t,l,s,c,d,u){if(d){r.innerHTML="";return}var m=t&&t.cityData?t.cityData.allAreaSold:true;if(!o)r.innerHTML=e.type==2&&!m?"\u5e93\u5b58\u5145\u8db3":u&&u.minisiteDO&&u.minisiteDO.validMlhItem&&e.quantity<6?'\u4ec5\u5269<span class="stock-only">'+e.quantity+"</span>\u4ef6":"\u5e93\u5b58"+e.quantity+"\u4ef6";_CTKeccb(33,"mod.stock.show","mod.stock.init",{group:e.type+(e.quantity?"1":"0")});i.onLoad("model",function(t){if(!(t.switcherDO&&t.switcherDO.amountRestrictDisable)){a(e.quantity,l,c,n,o)}})});i.onChange(["isAreaRestricted","tradeResult","currentInventory"],function(e,a,i){if(a&&a.name=="stock"||e||!i.quantity){t.hide(r)}else{t.show(r)}})}}},{requires:["dom","event"]});